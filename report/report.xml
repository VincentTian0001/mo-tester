<?xml version="1.0" encoding="UTF-8"?>

<testsuite name="test" errors="14" failures="0" tests="14" time="23.862001">
    <testcase name="cases/dtype/bigint.test" time="3.403">
        <failure type="0002" message="The actual result is not in accordance with the expectation.More,See the detail."><![CDATA[select 0,256,00000000000000065536,2147483647,-2147483648,2147483648,+4294967296;

[EXPECT RESULT]:
0	256	00000000000000065536	2147483647	-2147483648	2147483648	4294967296
0	256	65536	2147483647	-2147483648	2147483648	4294967296
[ACTUAL RESULT]:
0	256	00000000000000065536	2147483647	-2147483648	2147483648	+4294967296
0	256	65536	2147483647	-2147483648	2147483648	4294967296

select +9999999999999999999,-9999999999999999999;

[EXPECT RESULT]:
9999999999999999999	-9999999999999999999
9999999999999999999	-9999999999999999999
[ACTUAL RESULT]:
+9999999999999999999	-9999999999999999999
-8446744073709551617	8446744073709551617

select cast(9223372036854775808 as unsigned)+1;

[EXPECT RESULT]:
cast(9223372036854775808 as unsigned)+1
9223372036854775809
[ACTUAL RESULT]:
cast(9223372036854775808 as unsigned unsigned) + 1
9.223372036854776E18

select 9223372036854775808+1;

[EXPECT RESULT]:
9223372036854775808+1
9223372036854775809
[ACTUAL RESULT]:
9223372036854775808 + 1
-9223372036854775807

select -(0-3),round(-(0-3)), round(9999999999999999999);

[EXPECT RESULT]:
-(0-3)	round(-(0-3))	round(9999999999999999999)
3	3	9999999999999999999
[ACTUAL RESULT]:
-(0 - 3)	round(-(0 - 3))	round(9999999999999999999)
3	3	-8446744073709551617

select 1,11,101,1001,10001,100001,1000001,10000001,100000001,1000000001,10000000001,100000000001,1000000000001,10000000000001,100000000000001,1000000000000001,10000000000000001,100000000000000001,1000000000000000001,10000000000000000001;

[EXPECT RESULT]:
1	11	101	1001	10001	100001	1000001	10000001	100000001	1000000001	10000000001	100000000001	1000000000001	10000000000001	100000000000001	1000000000000001	10000000000000001	100000000000000001	1000000000000000001	10000000000000000001
1	11	101	1001	10001	100001	1000001	10000001	100000001	1000000001	10000000001	100000000001	1000000000001	10000000000001	100000000000001	1000000000000001	10000000000000001	100000000000000001	1000000000000000001	10000000000000000001
[ACTUAL RESULT]:
1	11	101	1001	10001	100001	1000001	10000001	100000001	1000000001	10000000001	100000000001	1000000000001	10000000000001	100000000000001	1000000000000001	10000000000000001	100000000000000001	1000000000000000001	10000000000000000001
1	11	101	1001	10001	100001	1000001	10000001	100000001	1000000001	10000000001	100000000001	1000000000001	10000000000001	100000000000001	1000000000000001	10000000000000001	100000000000000001	1000000000000000001	-8446744073709551615

select -1,-11,-101,-1001,-10001,-100001,-1000001,-10000001,-100000001,-1000000001,-10000000001,-100000000001,-1000000000001,-10000000000001,-100000000000001,-1000000000000001,-10000000000000001,-100000000000000001,-1000000000000000001,-10000000000000000001;

[EXPECT RESULT]:
-1	-11	-101	-1001	-10001	-100001	-1000001	-10000001	-100000001	-1000000001	-10000000001	-100000000001	-1000000000001	-10000000000001	-100000000000001	-1000000000000001	-10000000000000001	-100000000000000001	-1000000000000000001	-10000000000000000001
-1	-11	-101	-1001	-10001	-100001	-1000001	-10000001	-100000001	-1000000001	-10000000001	-100000000001	-1000000000001	-10000000000001	-100000000000001	-1000000000000001	-10000000000000001	-100000000000000001	-1000000000000000001	-10000000000000000001
[ACTUAL RESULT]:
-1	-11	-101	-1001	-10001	-100001	-1000001	-10000001	-100000001	-1000000001	-10000000001	-100000000001	-1000000000001	-10000000000001	-100000000000001	-1000000000000001	-10000000000000001	-100000000000000001	-1000000000000000001	-10000000000000000001
-1	-11	-101	-1001	-10001	-100001	-1000001	-10000001	-100000001	-1000000001	-10000000001	-100000000001	-1000000000001	-10000000000001	-100000000000001	-1000000000000001	-10000000000000001	-100000000000000001	-1000000000000000001	8446744073709551615

select * from t1 where a=18446744073709551615;

[EXPECT RESULT]:
a
18446744073709551615
[ACTUAL RESULT]:
a

insert into t1 (big) values (-1),(12345678901234567),(9223372036854775807);

[EXPECT RESULT]:

[ACTUAL RESULT]:
unknown error:[42611]Field 'a' doesn't have a default value

select * from t1;

[EXPECT RESULT]:
a	big
1	-1
1	12345678901234567
1	9223372036854775807
[ACTUAL RESULT]:
a	big

select min(big),max(big),max(big)-1 from t1;

[EXPECT RESULT]:
min(big)        max(big)        max(big) - 1
-1	9223372036854775807	9223372036854775806
[ACTUAL RESULT]:
min(big)	max(big)	max(big) - 1
null	null	null

select min(big),max(big),max(big)-1 from t1 group by a;

[EXPECT RESULT]:
min(big)        max(big)        max(big) - 1
-1	9223372036854775807	9223372036854775806
[ACTUAL RESULT]:
min(big)	max(big)	max(big) - 1

insert into t1 (big) values (0),(18446744073709551615), (0xFFFFFFFFFFFFFFFE), (18446744073709551613), (18446744073709551612);

[EXPECT RESULT]:

[ACTUAL RESULT]:
unknown error:[42611]Field 'a' doesn't have a default value

select * from t1;

[EXPECT RESULT]:
a       big
1       0
1       18446744073709551615
1       18446744073709551614
1       18446744073709551613
1       18446744073709551612
[ACTUAL RESULT]:
a	big

select * from t1 order by big limit 1,3;

[EXPECT RESULT]:
a	big
1	18446744073709551612
1	18446744073709551613
1	18446744073709551614
[ACTUAL RESULT]:
a	big

select * from t1 order by big limit 3 offset 1;

[EXPECT RESULT]:
a	big
1	18446744073709551612
1	18446744073709551613
1	18446744073709551614
[ACTUAL RESULT]:
a	big

select min(big),max(big),max(big)-1 from t1;

[EXPECT RESULT]:
min(big)        max(big)        max(big) - 1
0	18446744073709551615	18446744073709551614
[ACTUAL RESULT]:
min(big)	max(big)	max(big) - 1
null	null	null

select min(big),max(big),max(big)-1 from t1 group by a;

[EXPECT RESULT]:
min(big)        max(big)        max(big) - 1
0	18446744073709551615	18446744073709551614
[ACTUAL RESULT]:
min(big)	max(big)	max(big) - 1

select * from t1;

[EXPECT RESULT]:
value64	value32
17156792991891826145    1
9223372036854775807     2
[ACTUAL RESULT]:
value64	value32
17156792991891826145	1
9223372036854775807	2

select * from t2;

[EXPECT RESULT]:
value64 value32
17156792991891826145    3
9223372036854775807     4
[ACTUAL RESULT]:
value64	value32
17156792991891826145	3
9223372036854775807	4

select * from t1 join t2 on t1.value64=t2.value64 where t1.value64=17156792991891826145;

[EXPECT RESULT]:
t1.value64      t1.value32      t2.value64      t2.value32
17156792991891826145    1       17156792991891826145    3
[ACTUAL RESULT]:
value64	value32	value64	value32

select * from t1 where bigint_col=17666000000000000000;

[EXPECT RESULT]:
bigint_col
17666000000000000000
[ACTUAL RESULT]:
bigint_col

select * from t1 where bigint_col='17666000000000000000';

[EXPECT RESULT]:
bigint_col
17666000000000000000
[ACTUAL RESULT]:
unknown error:[42883]undefined function =[BIGINT UNSIGNED VARCHAR]

select cast(10000002383263201056 as unsigned) mod 50 as result;

[EXPECT RESULT]:
result
6
[ACTUAL RESULT]:
result
0.0

select cast(19999999999999999999 as signed);

[EXPECT RESULT]:
cast(19999999999999999999 as signed)
9223372036854775807
[ACTUAL RESULT]:
syntax error at position 33 near '19999999999999999999'; You have an error in your SQL syntax; check the manual that corresponds to your MatrixOne server version for the right syntax to use

select cast(-19999999999999999999 as signed);

[EXPECT RESULT]:
cast(-19999999999999999999 as signed)
-9223372036854775808
[ACTUAL RESULT]:
syntax error at position 34 near '19999999999999999999'; You have an error in your SQL syntax; check the manual that corresponds to your MatrixOne server version for the right syntax to use

INSERT INTO t1 (id,a) VALUES
(1,0),
(2,CAST(0x7FFFFFFFFFFFFFFF AS UNSIGNED)),
(3,CAST(0x8000000000000000 AS UNSIGNED)),
(4,CAST(0xFFFFFFFFFFFFFFFF AS UNSIGNED));

[EXPECT RESULT]:

[ACTUAL RESULT]:
unknown error:[42611]Field 'b' doesn't have a default value

SELECT id, id >= 1.1 FROM t_bigint;

[EXPECT RESULT]:
id	id >= 1.1
1	false	
2	true
[ACTUAL RESULT]:
id	id >= 1.1
1	false
2	true

SELECT id, 1.1 <= id FROM t_bigint;

[EXPECT RESULT]:
id	1.1 <= id
1	false	
2	true
[ACTUAL RESULT]:
id	1.1 <= id
1	false
2	true

SELECT id, id = 1.1 FROM t_bigint;

[EXPECT RESULT]:
id	id = 1.1
1	false	
2	false
[ACTUAL RESULT]:
id	id = 1.1
1	false
2	false

SELECT id, 1.1 = id FROM t_bigint;

[EXPECT RESULT]:
id	1.1 = id
1	false	
2	false
[ACTUAL RESULT]:
id	1.1 = id
1	false
2	false

SELECT * from t_bigint WHERE id = '1.1';

[EXPECT RESULT]:
id
[ACTUAL RESULT]:
unknown error:[42883]undefined function =[BIGINT VARCHAR]

SELECT * from t_bigint WHERE id = '1.1e0';

[EXPECT RESULT]:
id
[ACTUAL RESULT]:
unknown error:[42883]undefined function =[BIGINT VARCHAR]

SELECT * from t_bigint WHERE id IN ('1.1', '2.2');

[EXPECT RESULT]:
id
[ACTUAL RESULT]:
unknown error:[42883]undefined function =[BIGINT VARCHAR]

SELECT * from t_bigint WHERE id IN ('1.1e0', '2.2e0');

[EXPECT RESULT]:
id
[ACTUAL RESULT]:
unknown error:[42883]undefined function =[BIGINT VARCHAR]

SELECT * from t_bigint WHERE id BETWEEN '1.1' AND '1.9';

[EXPECT RESULT]:
id
[ACTUAL RESULT]:
unknown error:[42883]undefined function >=[BIGINT VARCHAR]

SELECT * from t_bigint WHERE id BETWEEN '1.1e0' AND '1.9e0';

[EXPECT RESULT]:
id
[ACTUAL RESULT]:
unknown error:[42883]undefined function >=[BIGINT VARCHAR]

SELECT * FROM t1 WHERE coalesce(a) BETWEEN 0 and 0.9;

[EXPECT RESULT]:
a
[ACTUAL RESULT]:
unknown error:[42883]function 'coalesce' doesn't register, get id failed

SELECT * FROM t1 WHERE coalesce(a)=0.9;

[EXPECT RESULT]:
a
[ACTUAL RESULT]:
unknown error:[42883]function 'coalesce' doesn't register, get id failed

SELECT * FROM t1 WHERE coalesce(a) in (0.8,0.9);

[EXPECT RESULT]:
a
[ACTUAL RESULT]:
unknown error:[42883]function 'coalesce' doesn't register, get id failed

select count(*) from t
where id>=8894754949779693574 and id =17790886498483827171 order by 1 asc;

[EXPECT RESULT]:
select count(*) from t
where id>=8894754949779693574 and id <=17790886498483827171 order by 1 asc;
count(*)
3
[ACTUAL RESULT]:
unknown error:[42P10]column 'id' does not exist

select count(*) from t
where id between 8894754949779693574 and 17790886498483827171;

[EXPECT RESULT]:
count(*)
3
[ACTUAL RESULT]:
count(id)
0

SELECT (184467440737095 BETWEEN 0 AND 18446744073709551500);

[EXPECT RESULT]:
(184467440737095 BETWEEN 0 AND 18446744073709551500)
false
[ACTUAL RESULT]:
(184467440737095 between 0 and 18446744073709551500)
true

SELECT CAST(100 AS UNSIGNED) BETWEEN 1 AND -1;

[EXPECT RESULT]:
CAST(100 AS UNSIGNED) BETWEEN 1 AND -1
false
[ACTUAL RESULT]:
cast(100 as unsigned unsigned) between 1 and -1
true

SELECT CAST(100 AS UNSIGNED) NOT BETWEEN 1 AND -1;

[EXPECT RESULT]:
CAST(100 AS UNSIGNED) NOT BETWEEN 1 AND -1
true
[ACTUAL RESULT]:
cast(100 as unsigned unsigned) not between 1 and -1
true

SELECT CAST(0 AS UNSIGNED) BETWEEN 0 AND -1;

[EXPECT RESULT]:
CAST(0 AS UNSIGNED) BETWEEN 0 AND -1
false
[ACTUAL RESULT]:
cast(0 as unsigned unsigned) between 0 and -1
true

SELECT CAST(0 AS UNSIGNED) NOT BETWEEN 0 AND -1;

[EXPECT RESULT]:
CAST(0 AS UNSIGNED) NOT BETWEEN 0 AND -1
true
[ACTUAL RESULT]:
cast(0 as unsigned unsigned) not between 0 and -1
true

SELECT ( 9223372036854775808 BETWEEN 9223372036854775808 AND 9223372036854775808 );

[EXPECT RESULT]:
( 9223372036854775808 BETWEEN 9223372036854775808 AND 9223372036854775808 )
true
[ACTUAL RESULT]:
(9223372036854775808 between 9223372036854775808 and 9223372036854775808)
true

SELECT ( 9223372036854775807 BETWEEN 9223372036854775808 AND 1 );

[EXPECT RESULT]:
( 9223372036854775807 BETWEEN 9223372036854775808 AND 1 )
false
[ACTUAL RESULT]:
(9223372036854775807 between 9223372036854775808 and 1)
true

SELECT ( -1 BETWEEN 9223372036854775808 AND 1 );

[EXPECT RESULT]:
( -1 BETWEEN 9223372036854775808 AND 1 )
false
[ACTUAL RESULT]:
(-1 between 9223372036854775808 and 1)
false

SELECT ( 0 BETWEEN 9223372036854775808 AND 1 );

[EXPECT RESULT]:
( 0 BETWEEN 9223372036854775808 AND 1 )
false
[ACTUAL RESULT]:
(0 between 9223372036854775808 and 1)
false

SELECT ( 1 BETWEEN 9223372036854775808 AND 1 );

[EXPECT RESULT]:
( 1 BETWEEN 9223372036854775808 AND 1 )
false
[ACTUAL RESULT]:
(1 between 9223372036854775808 and 1)
true

insert into t1 (a) values (2),(4),(6),(8),(10),(12),(14),(16),(18),(20),(22),(24),(26),(23);

[EXPECT RESULT]:

[ACTUAL RESULT]:
unknown error:[42611]Field 'b' doesn't have a default value

insert into t1 (b) values ('apple'), ('apple');

[EXPECT RESULT]:

[ACTUAL RESULT]:
unknown error:[42611]Field 'a' doesn't have a default value

select * from t1;

[EXPECT RESULT]:
a	b
1	apple
2	apple
[ACTUAL RESULT]:
a	b

select * from t11;

[EXPECT RESULT]:
a	b
2	12
10	10
12	11
[ACTUAL RESULT]:
a	b
0	10
1	11
2	12

select max(id) from t1;

[EXPECT RESULT]:
max(id)
34
[ACTUAL RESULT]:
max(id)
4

select * from t1;

[EXPECT RESULT]:
a
0
[ACTUAL RESULT]:
a
2

insert into t1 (a) values (2),(4),(6),(8),(10),(12),(14),(16),(18),(20),(22),(24),(26),(23);

[EXPECT RESULT]:

[ACTUAL RESULT]:
unknown error:[42611]Field 'b' doesn't have a default value

insert into t1 (b) values ('apple'), ('apple');

[EXPECT RESULT]:

[ACTUAL RESULT]:
unknown error:[42611]Field 'a' doesn't have a default value

select * from t1;

[EXPECT RESULT]:
a	b
1	apple
2	apple
[ACTUAL RESULT]:
a	b

]]></failure>
    </testcase>
    <testcase name="cases/dtype/bool.test" time="1.272">
        <failure type="0002" message="The actual result is not in accordance with the expectation.More,See the detail."><![CDATA[select * from t1;

[EXPECT RESULT]:
a	b
false	true
true	false
true	true
false	false
false    true
null	null
[ACTUAL RESULT]:
a	b
false	true
true	false
true	true
false	false
null	null

SELECT * FROM t1 WHERE IF(a AND 1, 0, 1);

[EXPECT RESULT]:
a	b
false	true
false	false
null	null
[ACTUAL RESULT]:
unknown error:[42601]only support logic expression to be filter condition

SELECT * FROM t1 WHERE IF(1 AND a, 0, 1);

[EXPECT RESULT]:
a	b
false	true
false	false
null	null
[ACTUAL RESULT]:
unknown error:[42601]only support logic expression to be filter condition

SELECT * FROM t1 where NOT(a AND 1);

[EXPECT RESULT]:
a	b
false	true
false	false
[ACTUAL RESULT]:
a	b
false	true
false	false
null	null

SELECT * FROM t1 where NOT(1 AND a);

[EXPECT RESULT]:
a	b
false	true
false	false
[ACTUAL RESULT]:
a	b
false	true
false	false
null	null

SELECT * FROM t1 where (a AND 1)=0;

[EXPECT RESULT]:
a	b
false	true
false	false
[ACTUAL RESULT]:
a	b
false	true
false	false
null	null

SELECT * FROM t1 where (1 AND a)=0;

[EXPECT RESULT]:
a	b
false	true
false	false
[ACTUAL RESULT]:
a	b
false	true
false	false
null	null

SELECT * FROM t1 where (1 AND a) IS NULL;

[EXPECT RESULT]:
a	b
null	null
[ACTUAL RESULT]:
unknown error:[42883]function 'ifnull' doesn't register, get id failed

select a<2 from t2;

[EXPECT RESULT]:
a<2
true
false
[ACTUAL RESULT]:
a < 2
true
false

select a<2 and b<3 from t2;

[EXPECT RESULT]:
a<2 and b<3
true
false
[ACTUAL RESULT]:
a < 2 and b < 3
true
false

select a=1 or b=3 from t2;

[EXPECT RESULT]:
a=1 or b=3
false
true
[ACTUAL RESULT]:
a = 1 or b = 3
true
false

select max(b)<min(a) from t1;

[EXPECT RESULT]:
max(b)<min(a)
false
[ACTUAL RESULT]:
max(b) < min(a)
false

select * from t1 where a IS NULL;

[EXPECT RESULT]:
a	b
null	null
[ACTUAL RESULT]:
unknown error:[42883]function 'ifnull' doesn't register, get id failed

select * from t1 where b is NOT NULL;

[EXPECT RESULT]:
a	b
false	true
true	false
true	true
false	false
[ACTUAL RESULT]:
unknown error:[42883]function 'ifnull' doesn't register, get id failed

select * from t1 where a IS NULL and b is NOT NULL;

[EXPECT RESULT]:
a	b
[ACTUAL RESULT]:
unknown error:[42883]function 'ifnull' doesn't register, get id failed

select * from t2 where a<1 AND NOT b order by b desc;

[EXPECT RESULT]:
a	b
[ACTUAL RESULT]:
unknown error:[42883]undefined function not[INT]

select b,max(b) from t1 where b is not NULL group by b order by b;

[EXPECT RESULT]:
b	max(b)
false	false
true	true
[ACTUAL RESULT]:
unknown error:[42883]function 'ifnull' doesn't register, get id failed

select * from t1 where a<=b and a is not NULL;

[EXPECT RESULT]:
a	b
false	true
true	true
false	false
[ACTUAL RESULT]:
unknown error:[42883]function 'ifnull' doesn't register, get id failed

select t1.a,t2.b from t1 join t2 on t1.a=t2.a order by t1.a desc;

[EXPECT RESULT]:
a	b
true	2
true	2
[ACTUAL RESULT]:
unknown error:[42883]undefined function =[BOOL INT]

select a,any_value(b) from t1 group by a order by a asc;

[EXPECT RESULT]:
a	any_value(b)
null	null
false	true
true	false
[ACTUAL RESULT]:
unknown error:[42883]function 'any_value' doesn't register, get id failed

select a,b from t1 where a in (0,1);

[EXPECT RESULT]:
a	b
false	true
true	false
true	true
false	false
[ACTUAL RESULT]:
a	b
false	true
true	false
true	true
false	false
null	null

select a,b from t1 where a not in (0,2);

[EXPECT RESULT]:
a	b
true	false
true	true
[ACTUAL RESULT]:
unknown error:[]the params type is not right

select distinct t.a from (select * from t1) t where a not in (2) order by t.a asc;

[EXPECT RESULT]:
a
false
true
[ACTUAL RESULT]:
unknown error:[]the params type is not right

select a and b from t1 where exists (select a from t1 where a is null) order by a desc;

[EXPECT RESULT]:
a and b
false
true
false
false
null
[ACTUAL RESULT]:
unknown error:[42883]function 'ifnull' doesn't register, get id failed

]]></failure>
    </testcase>
    <testcase name="cases/dtype/char.test" time="2.128">
        <failure type="0002" message="The actual result is not in accordance with the expectation.More,See the detail."><![CDATA[select 'aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa';

[EXPECT RESULT]:
aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa
aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa
[ACTUAL RESULT]:
aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa
aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa

SELECT CONCAT_WS(2,' test');

[EXPECT RESULT]:
CONCAT_WS(2,' test')
2 test
[ACTUAL RESULT]:
unknown error:[42883]function 'concat_ws' doesn't register, get id failed

SELECT '9223372036854775807' = 9223372036854775807;

[EXPECT RESULT]:
'9223372036854775807' = 9223372036854775807
1
[ACTUAL RESULT]:
unknown error:[42883]undefined function =[VARCHAR BIGINT]

SELECT '9223372036854775807' = "9223372036854775807";

[EXPECT RESULT]:
'9223372036854775807' = "9223372036854775807"
1
[ACTUAL RESULT]:
9223372036854775807 = 9223372036854775807
true

SELECT CAST('9223372036854775807' AS UNSIGNED) = 9223372036854775806;

[EXPECT RESULT]:
CAST('9223372036854775807' AS UNSIGNED) = 9223372036854775806
0
[ACTUAL RESULT]:
cast(9223372036854775807 as unsigned unsigned) = 9223372036854775806
true

SELECT CAST("2017-08-29" AS DATE);

[EXPECT RESULT]:
CAST("2017-08-29" AS DATE)
2017-08-29
[ACTUAL RESULT]:
cast(2017-08-29 as date)
2017-08-29

SELECT CAST(5-10 AS CHAR);

[EXPECT RESULT]:
CAST(5-10 AS CHAR)
-5
[ACTUAL RESULT]:
cast(5 - 10 as char)
-5

SELECT CONCAT_WS('My', 'S', 'QL');

[EXPECT RESULT]:
CONCAT_WS('My', 'S', 'QL')
MySQL
[ACTUAL RESULT]:
unknown error:[42883]function 'concat_ws' doesn't register, get id failed

SELECT CONCAT_WS('My', NULL, 'QL');

[EXPECT RESULT]:
CONCAT_WS('My', NULL, 'QL')
null
[ACTUAL RESULT]:
unknown error:[42883]function 'concat_ws' doesn't register, get id failed

SELECT CONCAT_WS(14,'.3');

[EXPECT RESULT]:
CONCAT_WS(14,'.3')
14.3
[ACTUAL RESULT]:
unknown error:[42883]function 'concat_ws' doesn't register, get id failed

select * from t1 where a like 'ab\_def';

[EXPECT RESULT]:
a
ab_def
[ACTUAL RESULT]:
a
abcdef
ab_def

select * from t1 where a like "\__cdef";

[EXPECT RESULT]:
a
_bcdef
[ACTUAL RESULT]:
a
abcdef
_bcdef
a_cdef

select * from t1 where a not like "%d_\_";

[EXPECT RESULT]:
a
abcdef
_bcdef
a_cdef
ab_def
abc_ef
abcd_f
[ACTUAL RESULT]:
a
abc_ef

SELECT * FROM Demochar;

[EXPECT RESULT]:
LastName	FirstName	Gender	DepartmentName	Age
Gilbert	Kevin	M	Tool Design	33
Johnson	David	M	Engineering	66
Martin	Kelly	F	Information Services	54
Poland	Carole	F	Production Control	29
Rapier	Abigail	F	Human Resources	38
Sharma	Bradley	M	Production	27
Tamburello	Andrea	F	Marketing	45
select concat_ws(LastName,FirstName) from Demochar where Age > 40;
concat_ws(LastName,FirstName)
JohnsonDavid
MartinKelly
TamburelloAndrea
select concat_ws(LastName,FirstName) as fullname from Demochar where Age > 40 order by fullname desc;
fullname
TamburelloAndrea
MartinKelly
JohnsonDavid
select concat_ws(LastName,FirstName),Gender,Age from Demochar where Gender='F' order by Age asc;
concat_ws(LastName,FirstName)	Gender	Age
PolandCarole	F	29
RapierAbigail	F	38
TamburelloAndrea	F	45
MartinKelly	F	54
select cast(Age as char) as cAge from Demochar where cast(Age as char) like '2_';
cAge
29
27
select cast(Age as char) and Age as cAge from Demochar where Age>=50;
cAge
1
1
CREATE TABLE employees (
employeeNumber int(11) NOT NULL,
lastName char(50) NOT NULL,
firstName char(50) NOT NULL,
extension char(10) NOT NULL,
email char(100) NOT NULL,
officeCode char(10) NOT NULL,
reportsTo int(11) DEFAULT NULL,
jobTitle char(50) NOT NULL,
PRIMARY KEY (employeeNumber)
);
insert  into employees(employeeNumber,lastName,firstName,extension,email,officeCode,reportsTo,jobTitle) values
(1002,'Murphy','Diane','x5800','dmurphy@classicmodelcars.com','1',NULL,'President'),
(1056,'Patterson','Mary','x4611','mpatterso@classicmodelcars.com','1',1002,'VP Sales'),
(1076,'Firrelli','Jeff','x9273','jfirrelli@classicmodelcars.com','1',1002,'VP Marketing'),
(1088,'Patterson','William','x4871','wpatterson@classicmodelcars.com','6',1056,'Sales Manager (APAC)'),
(1102,'Bondur','Gerard','x5408','gbondur@classicmodelcars.com','4',1056,'Sale Manager (EMEA)'),
(1143,'Bow','Anthony','x5428','abow@classicmodelcars.com','1',1056,'Sales Manager (NA)'),
(1165,'Jennings','Leslie','x3291','ljennings@classicmodelcars.com','1',1143,'Sales Rep'),
(1166,'Thompson','Leslie','x4065','lthompson@classicmodelcars.com','1',1143,'Sales Rep'),
(1188,'Firrelli','Julie','x2173','jfirrelli@classicmodelcars.com','2',1143,'Sales Rep'),
(1216,'Patterson','Steve','x4334','spatterson@classicmodelcars.com','2',1143,'Sales Rep'),
(1286,'Tseng','Foon Yue','x2248','ftseng@classicmodelcars.com','3',1143,'Sales Rep'),
(1323,'Vanauf','George','x4102','gvanauf@classicmodelcars.com','3',1143,'Sales Rep'),
(1337,'Bondur','Loui','x6493','lbondur@classicmodelcars.com','4',1102,'Sales Rep'),
(1370,'Hernandez','Gerard','x2028','ghernande@classicmodelcars.com','4',1102,'Sales Rep'),
(1401,'Castillo','Pamela','x2759','pcastillo@classicmodelcars.com','4',1102,'Sales Rep'),
(1501,'Bott','Larry','x2311','lbott@classicmodelcars.com','7',1102,'Sales Rep'),
(1504,'Jones','Barry','x102','bjones@classicmodelcars.com','7',1102,'Sales Rep'),
(1611,'Fixter','Andy','x101','afixter@classicmodelcars.com','6',1088,'Sales Rep');
select officeCode,count(officeCode) from employees group by officeCode having count(officeCode)>2;
officeCode      count(officeCode)
1       6
4       4
select lastName,firstName from employees where cast(officeCode as unsigned)>5 limit 2 offset 1;
lastName        firstName
Bott    Larry
Jones   Barry
select max(lastName),min(lastName) from employees;
max(lastName)   min(lastName)
Vanauf  Bondur
select max(lastName),min(lastName),JobTitle from employees group by JobTitle;
max(lastName)   min(lastName)   JobTitle
Murphy  Murphy  President
Patterson       Patterson       VP Sales
Firrelli        Firrelli        VP Marketing
Patterson       Patterson       Sales Manager (APAC)
Bondur  Bondur  Sale Manager (EMEA)
Bow     Bow     Sales Manager (NA)
Vanauf  Bondur  Sales Rep
select lastName,firstName from employees where lastName>=firstName;
lastName        firstName
Murphy  Diane
Patterson       Mary
Bow     Anthony
Thompson        Leslie
Tseng   Foon Yue
Vanauf  George
Hernandez       Gerard
Jones   Barry
Fixter  Andy
select lastName,firstName from employees where lastName between firstName and JobTitle;
lastName        firstName
Murphy  Diane
Patterson       Mary
Bow     Anthony
Hernandez       Gerard
Jones   Barry
Fixter  Andy
select * from employees where officeCode in ('2','3','4') order by 1 asc,3 desc limit 1,2;
employeeNumber  lastName        firstName       extension       email   officeCode      reportsTo       jobTitle
1188    Firrelli        Julie   x2173   jfirrelli@classicmodelcars.com  2       1143    Sales Rep
1216    Patterson       Steve   x4334   spatterson@classicmodelcars.com 2       1143    Sales Rep
select * from employees where officeCode not in ('5','7','1');
employeeNumber  lastName        firstName       extension       email   officeCode      reportsTo       jobTitle
1088    Patterson       William x4871   wpatterson@classicmodelcars.com 6       1056    Sales Manager (APAC)
1102    Bondur  Gerard  x5408   gbondur@classicmodelcars.com    4       1056    Sale Manager (EMEA)
1188    Firrelli        Julie   x2173   jfirrelli@classicmodelcars.com  2       1143    Sales Rep
1216    Patterson       Steve   x4334   spatterson@classicmodelcars.com 2       1143    Sales Rep
1286    Tseng   Foon Yue        x2248   ftseng@classicmodelcars.com     3       1143    Sales Rep
1323    Vanauf  George  x4102   gvanauf@classicmodelcars.com    3       1143    Sales Rep
1337    Bondur  Loui    x6493   lbondur@classicmodelcars.com    4       1102    Sales Rep
1370    Hernandez       Gerard  x2028   ghernande@classicmodelcars.com  4       1102    Sales Rep
1401    Castillo        Pamela  x2759   pcastillo@classicmodelcars.com  4       1102    Sales Rep
1611    Fixter  Andy    x101    afixter@classicmodelcars.com    6       1088    Sales Rep
select avg(officeCode) from employees where jobTitle like 'Sales%' group by jobTitle;
avg(officeCode)
6
1
3.6666666666666665
select officeCode,sum(cast(officeCode as unsigned)) from employees group by officeCode;
officeCode      sum(cast(officeCode as unsigned))
1       6
6       12
4       16
2       4
3       6
7       14
select employeeNumber,officeCode,reportsTo from employees where employeeNumber>1400 and reportsTo is not null order by officeCode+1,employeeNumber;
employeeNumber  officeCode      reportsTo
1401    4       1102
1611    6       1088
1501    7       1102
1504    7       1102
create table job(
jobid int primary key,
jobTitle char(50)
);
insert into job values
(1,'President'),
(2,'VP Sales'),
(3,'VP Marketing'),
(4,'Sales Manager (APAC)'),
(5,'Sale Manager (EMEA)'),
(6,'Sales Manager (NA)'),
(7,'Sales Rep'),
(8,'Marketing');
select employeeNumber,e.jobTitle,j.jobid from employees e join job j on e.jobTitle=j.jobTitle;
employeeNumber  jobTitle        jobid
1002    President       1
1056    VP Sales        2
1076    VP Marketing    3
1088    Sales Manager (APAC)    4
1102    Sale Manager (EMEA)     5
1143    Sales Manager (NA)      6
1165    Sales Rep       7
1166    Sales Rep       7
1188    Sales Rep       7
1216    Sales Rep       7
1286    Sales Rep       7
1323    Sales Rep       7
1337    Sales Rep       7
1370    Sales Rep       7
1401    Sales Rep       7
1501    Sales Rep       7
1504    Sales Rep       7
1611    Sales Rep       7
select distinct e.jobTitle,j.jobid from employees e join job j on e.jobTitle=j.jobTitle;
jobTitle        jobid
President       1
VP Sales        2
VP Marketing    3
Sales Manager (APAC)    4
Sale Manager (EMEA)     5
Sales Manager (NA)      6
Sales Rep       7
select e.jobTitle,sum(jobid) from employees e join job j on e.jobTitle=j.jobTitle group by jobTitle having sum(jobid)>5;
jobTitle        sum(jobid)
Sales Manager (NA)      6
Sales Rep       84
select e.jobTitle,sum(jobid) from employees e join job j on e.jobTitle=j.jobTitle group by jobTitle having sum(jobid)>5 order by 2 desc;
jobTitle        sum(jobid)
Sales Rep       84
Sales Manager (NA)      6
drop table if exists t1;
drop table if exists t2;
drop table if exists t3;
drop table if exists t11;
drop table if exists t12;
CREATE TABLE t1 (a char(3), b int primary key);
INSERT INTO t1 VALUES ('1',1),('1',2);
update t1 set a=2 where a='1' limit 1;
select * from t1;
a	b
2	1
1	2
INSERT INTO t1 VALUES ('1',3);
update t1 set a='a' where a='1';
select * from t1;
a	b
2	1
a	2
a	3
drop table t1;
create table t1 (
a char(10) not null,
b char(10) not null default '0',
c char(10) not null default '0',
d char(10) not null default '0',
e char(10) not null default '0',
f char(10) not null default '0',
g char(10) not null default '0',
h char(10) not null default '0',
i char(10) not null default '0',
j char(10) not null default '0',
primary key (a));
insert into t1 (a) values ('2'),('4'),('6'),('8'),('10'),('12'),('14'),('16'),('18'),('20'),('22'),('24'),('26'),('23');
update t1 set a=a+'101';
select a,b from t1;
a	b
103	0
105	0
107	0
109	0
111	0
113	0
115	0
117	0
119	0
121	0
123	0
124	0
125	0
127	0
update t1 set a='127' where a='25';
select a,b from t1;
a	b
103	0
105	0
107	0
109	0
111	0
113	0
115	0
117	0
119	0
121	0
123	0
124	0
125	0
127	0
update t1 set a=a+'a' where 1 > 2;
select a,b from t1;
a	b
103	0
105	0
107	0
109	0
111	0
113	0
115	0
117	0
119	0
121	0
123	0
124	0
125	0
127	0
update t1 set a=a+a where 3 > 2;
select a,b from t1;
a	b
206	0
210	0
214	0
218	0
222	0
226	0
230	0
234	0
238	0
242	0
246	0
248	0
250	0
254	0
drop table t1;
create table t1 (a char(10) primary key, b char(32));
insert into t1 values ('abc','apple'), ('ab','apple');
select * from t1;
a	b
ab	apple
abc	apple
update t1, t1 as t2 set t1.a= COALESCE(t1.a,t2.b) where t1.b = t2.b;
select * from t1;
a	b
ab	apple
abc	apple
drop table t1;
create table t11 (a char(10) NOT NULL, b int, primary key (a));
create table t12 (a char(10) NOT NULL, b int, primary key (a));
create table t2 (a char(10) NOT NULL, b int, primary key (a));
insert into t11 values ('0', 10),('1', 11),('2', 12);
insert into t12 values ('33', 10),('0', 11),('2', 12);
insert into t2 values ('0', 21),('1', 12),('3', 23);
update t12 join t11 on t11.a = t12.a set t11.a=t12.a where t11.b <> (select b from t2 where t11.a = t2.a);
select * from t11;
a	b
0	10
1	11
2	12
select * from t12;
a	b
0	11
2	12
33	10
update t11,t12 set t11.a=t11.a+t11.b where t11.b <> (select b from t2 where t11.a = t2.a);
select * from t11;
a	b
10	10
12	11
2	12
drop table if exists t1;
drop table if exists t2;
CREATE TABLE t1(a char(10) PRIMARY KEY);
INSERT INTO t1 VALUES('10'),('20');
CREATE TABLE t2(b char(3));
INSERT INTO t2 VALUES('10'),('20');
update t1 JOIN t2 on t1.a=t2.b set t1.a='5' WHERE t1.a = '10';
select * from t1;
a
20
5
select * from t2;
b
10
20
drop table t1;
CREATE TABLE t1 ( a char(10) PRIMARY KEY );
INSERT INTO t1 VALUES ('0'),('1'),('2');
update t1 set a=a*10%3 WHERE t1.a > 0 ORDER BY t1.a LIMIT 1;
SELECT * FROM t1;
a
0
1
2
drop table if exists t1;
drop table if exists t2;
drop table if exists t3;
CREATE TABLE t1 (a char(10) not null,b char(10) not null, primary key (a));
CREATE TABLE t2 (a char(10) not null,b char(10) not null, primary key (a));
CREATE TABLE t3 (a char(10) not null,b char(10) not null, primary key (a));
insert into t1 values ('1','1'),('2','1'),('4','3');
insert into t2 values ('1','1'),('2','2'),('3','3');
insert into t3 values ('1','1'),('2','1'),('4','3');
update t1 join t2 on t1.a=t2.a join t3 on t1.b=t3.b set t1.a=((t3.a*5) DIV 5) where t1.a=t2.a AND t2.b=t3.a and t1.b=t3.b;
select * from t1;
a	b
1	1
2	1
4	3
drop table if exists t1;
drop table if exists t2;
CREATE TABLE t1 (
a char(3)
);
CREATE TABLE t2 (
a char(3)
);
insert into t1 values('1'),('2'),('3'),('4'),('5');
insert into t2 values('1'),('3'),('5'),('7'),('9');
update t1 join t2 alias on t1.a=alias.a set alias.a=t1.a*3 WHERE t1.a = alias.a;
drop table if exists t1;
drop table if exists t2;
create table t1 (id char(20),dd date,dt datetime);
insert into t1 values('subquery','2022-04-28','2022-04-28 22:40:11');
insert into t1 values('bye','2022-04-28','2022-04-28 22:40:11');
insert into t1 values('hi','2022-04-28','2022-04-28 22:40:11');
insert into t1 values('good morning','2022-04-28','2022-04-28 22:40:11');
insert into t1 values('byebye','2022-04-28','2022-04-28 22:40:11');
update t1 sub set sub.id=dd where id > 'bye';
select count(*) from t1 where id>4;
count(*)
4
drop table if exists t1;
drop table if exists t2;
create table t1 (id char(20),dd date,dt datetime);
insert into t1 values('subquery','2022-04-28','2022-04-28 22:40:11');
insert into t1 values('bye','2022-04-28','2022-04-28 22:40:11');
insert into t1 values('hi','2022-04-28','2022-04-28 22:40:11');
insert into t1 values('good morning','2022-04-28','2022-04-28 22:40:11');
insert into t1 values('byebye','2022-04-28','2022-04-28 22:40:11');
update t1 sub set sub.id=dt where id > 'bye' || id < 'hi' ;
select * from t1;
id	dd	dt
2022-04-28 22:40:11	2022-04-28	2022-04-28 22:40:11
2022-04-28 22:40:11	2022-04-28	2022-04-28 22:40:11
2022-04-28 22:40:11	2022-04-28	2022-04-28 22:40:11
2022-04-28 22:40:11	2022-04-28	2022-04-28 22:40:11
2022-04-28 22:40:11	2022-04-28	2022-04-28 22:40:11
drop table if exists t1;
drop table if exists t2;
drop table if exists t3;
drop table if exists t4;
create table t1 (a char(3));
create table t2 (a char(3), b int);
create table t3 (a char(3));
create table t4 (a char(10) not null, b int not null);
insert into t1 values ('2');
insert into t2 values ('1',7),('2',7);
insert into t4 values ('4',8),('3',8),('5',9);
insert into t3 values ('100'),('8');
update t3,t2,t1 set t1.a=0 and t2.a=t2.a+t3.a where t3.a in (select b from t4 where b > 7);
select * from t1;
a
0
select * from t2;
a	b
1	7
2	7
drop table if exists t1;
drop table if exists t2;
drop table if exists t3;
drop table if exists t11;
drop table if exists t12;
CREATE TABLE t1 (a char(3), b char(5) primary key);
INSERT INTO t1 VALUES ('1','1'),('1','2');
delete from t1 where a=1 limit 1;
select * from t1;
a	b
1	2
INSERT INTO t1 VALUES (1,3);
delete from t1 where a=1;
select * from t1;
a	b
drop table t1;
create table t1 (
a char(10) not null,
b char(10) not null default '0',
c char(10) not null default '0',
d char(10) not null default '0',
e char(10) not null default '0',
f char(10) not null default '0',
g char(10) not null default '0',
h char(10) not null default '0',
i char(10) not null default '0',
j char(10) not null default '0',
primary key (a));
insert into t1 (a) values ('2'),('4'),('6'),('8'),('10'),('12'),('14'),('16'),('18'),('20'),('22'),('24'),('26'),('23');
delete from t1 where a=2+2;
select a,b from t1;
a	b
10	0
12	0
14	0
16	0
18	0
2	0
20	0
22	0
23	0
24	0
26	0
6	0
8	0
delete from t1 where  a=24;
select a,b from t1;
a	b
10	0
12	0
14	0
16	0
18	0
2	0
20	0
22	0
23	0
26	0
6	0
8	0
delete from t1 where  3 < 2;
select a,b from t1;
a	b
10	0
12	0
14	0
16	0
18	0
2	0
20	0
22	0
23	0
26	0
6	0
8	0
delete from t1 where  1 < 2;
select a,b from t1;
a	b
drop table t1;
create table t1 (a char(10) primary key, b char(32));
insert into t1 values ('abc','apple'), ('ab','apple');
select * from t1;
a	b
ab	apple
abc	apple
delete t1 from t1,t1 as t2 where t1.b = t2.b and t1.a > t2.a;
select * from t1;
a	b
ab	apple
drop table t1;
create table t11 (a char(10) NOT NULL, b int, primary key (a));
create table t12 (a char(10) NOT NULL, b int, primary key (a));
create table t2 (a char(10) NOT NULL, b int, primary key (a));
insert into t11 values ('0', 10),('1', 11),('2', 12);
insert into t12 values ('33', 10),('0', 11),('2', 12);
insert into t2 values ('0', 21),('1', 12),('3', 23);
delete from t11 where t11.b <> (select b from t2 where t11.a = t2.a);
select * from t11;
a	b
2	12
delete t11,t12 from t11,t12 where t11.b <> (select b from t2 where t11.a = t2.a) or t12.a>1;
select * from t11;
a	b
select * from t12;
a	b
0	11
drop table if exists t1;
drop table if exists t2;
CREATE TABLE t1(a char(10) PRIMARY KEY);
INSERT INTO t1 VALUES('10'),('20');
CREATE TABLE t2(b char(3));
INSERT INTO t2 VALUES('10'),('20');
delete t1,t2 from t1 JOIN t2 on t1.a=t2.b WHERE t1.a = 10;
select * from t1;
a
20
select * from t2;
b
20
drop table if exists t1;
drop table if exists t2;
drop table if exists t3;
CREATE TABLE t1 (a char(10) not null,b char(10) not null, primary key (a));
CREATE TABLE t2 (a char(10) not null,b char(10) not null, primary key (a));
CREATE TABLE t3 (a char(10) not null,b char(10) not null, primary key (a));
insert into t1 values ('1','1'),('2','1'),('4','3');
insert into t2 values ('1','1'),('2','2'),('3','3');
insert into t3 values ('1','1'),('2','1'),('4','3');
delete t1,t2,t3 from t1 join t2 on t1.a=t2.a join t3 on t1.b=t3.b where t1.a=t2.a AND t2.b=t3.a and t1.b=t3.b;
select * from t1;
a	b
4	3
drop table t1;
create table t1(a char(10) not null);
insert into t1 values (0);
delete t1 from t1 where a is null;
select * from t1;
a
0
drop table if exists t1;
drop table if exists t2;
CREATE TABLE t1 (
a char(1)
);
CREATE TABLE t2 (
a char(1)
);
insert into t1 values('1'),('2'),('3'),('4'),('5');
insert into t2 values('1'),('3'),('5'),('7'),('9');
delete alias from t1 join t2 alias on t1.a=alias.a+1 WHERE t1.a = alias.a;
select * from t2;
a
1
3
5
7
9
drop table if exists t1;
drop table if exists t2;
create table t1 (id char(20),dd date,dt datetime);
insert into t1 values('subquery','2022-04-28','2022-04-28 22:40:11');
insert into t1 values('bye','2022-04-28','2022-04-28 22:40:11');
insert into t1 values('hi','2022-04-28','2022-04-28 22:40:11');
insert into t1 values('good morning','2022-04-28','2022-04-28 22:40:11');
insert into t1 values('byebye','2022-04-28','2022-04-28 22:40:11');
delete from t1 where length(id) < 3 || length(id) > 5;
select * from t1;
id	dd	dt
bye	2022-04-28	2022-04-28 22:40:11
[ACTUAL RESULT]:
lastname	firstname	gender	departmentname	age
Gilbert	Kevin	M	Tool Design	33
Tamburello	Andrea	F	Marketing	45
Johnson	David	M	Engineering	66
Sharma	Bradley	M	Production	27
Rapier	Abigail	F	Human Resources	38
Martin	Kelly	F	Information Services	54
Poland	Carole	F	Production Control	29

select concat_ws(LastName,FirstName) from Demochar where Age > 40 order by 1 asc;

[EXPECT RESULT]:

[ACTUAL RESULT]:
unknown error:[42883]function 'concat_ws' doesn't register, get id failed

select concat_ws(LastName,FirstName) as fullname from Demochar where Age > 40 order by fullname desc;

[EXPECT RESULT]:

[ACTUAL RESULT]:
unknown error:[42883]function 'concat_ws' doesn't register, get id failed

select concat_ws(LastName,FirstName),Gender,Age from Demochar where Gender='F' order by Age asc;

[EXPECT RESULT]:

[ACTUAL RESULT]:
unknown error:[42883]function 'concat_ws' doesn't register, get id failed

select cast(Age as char) as cAge from Demochar where cast(Age as char) like '2_';

[EXPECT RESULT]:

[ACTUAL RESULT]:
cage

select cast(Age as char) and Age as cAge from Demochar where Age>=50 order by cAge;

[EXPECT RESULT]:

[ACTUAL RESULT]:
unknown error:[42883]undefined function and[CHAR INT]

select officeCode,count(officeCode) from employees group by officeCode having count(officeCode)>2;

[EXPECT RESULT]:

[ACTUAL RESULT]:
officecode	count(officecode)
1	6
4	4

select lastName,firstName from employees where cast(officeCode as unsigned)>5 limit 2;

[EXPECT RESULT]:

[ACTUAL RESULT]:
lastname	firstname
Patterson	William
Bott	Larry

select max(lastName),min(lastName) from employees;

[EXPECT RESULT]:

[ACTUAL RESULT]:
max(lastname)	min(lastname)
Vanauf	Bondur

select max(lastName),min(lastName),JobTitle from employees group by JobTitle;

[EXPECT RESULT]:

[ACTUAL RESULT]:
max(lastname)	min(lastname)	jobtitle
Murphy	Murphy	President
Patterson	Patterson	VP Sales
Firrelli	Firrelli	VP Marketing
Patterson	Patterson	Sales Manager (APAC)
Bondur	Bondur	Sale Manager (EMEA)
Bow	Bow	Sales Manager (NA)
Vanauf	Bondur	Sales Rep

select lastName,firstName from employees where lastName>=firstName;

[EXPECT RESULT]:

[ACTUAL RESULT]:
lastname	firstname
Murphy	Diane
Patterson	Mary
Bow	Anthony
Thompson	Leslie
Tseng	Foon Yue
Vanauf	George
Hernandez	Gerard
Jones	Barry
Fixter	Andy

select lastName,firstName from employees where lastName between firstName and JobTitle;

[EXPECT RESULT]:

[ACTUAL RESULT]:
lastname	firstname
Murphy	Diane
Patterson	Mary
Bow	Anthony
Hernandez	Gerard
Jones	Barry
Fixter	Andy

select * from employees where officeCode in ('2','3','4') order by 1 limit 1,2;

[EXPECT RESULT]:

[ACTUAL RESULT]:
unknown error:Internal error: panic runtime error: index out of range [6] with length 1: goroutine 490408 [running]:
runtime/debug.Stack()
	/usr/lib/golang/src/runtime/debug/stack.go:24 +0x65
github.com/matrixorigin/matrixone/pkg/common/moerr.NewPanicError({0x2d6da80?, 0xc0807bc948})
	/data/zhangxiao/matrixone/pkg/common/moerr/error.go:77 +0x53
github.com/matrixorigin/matrixone/pkg/vm/overload.Run.func1()
	/data/zhangxiao/matrixone/pkg/vm/overload/run.go:50 +0x31
panic({0x2d6da80, 0xc0807bc948})
	/usr/lib/golang/src/runtime/panic.go:838 +0x207
github.com/matrixorigin/matrixone/pkg/sort/asc/int64s.quickSort({0xc1e4b30008?, 0x1, 0x1}, {0xc0530a14c0?, 0x8, 0x8}, 0x2c3f220?, 0x1?, 0xc001b09bf0?)
	/data/zhangxiao/matrixone/pkg/sort/asc/int64s/sort.go:49 +0x2a7
github.com/matrixorigin/matrixone/pkg/sort/asc/int64s.Sort({0xc1e4b30008?, 0x7f67788815b8?, 0x40?}, {0xc0530a14c0?, 0xc0530a14c0?, 0x0?})
	/data/zhangxiao/matrixone/pkg/sort/asc/int64s/sort.go:14 +0x45
github.com/matrixorigin/matrixone/pkg/sort.Sort(0xb0?, {0xc0530a14c0?, 0xc0c26fc4b0?, 0x8?}, 0x7?)
	/data/zhangxiao/matrixone/pkg/sort/sort.go:89 +0x2e8
github.com/matrixorigin/matrixone/pkg/sql/colexec2/order.(*Container).process(0xc00a15c9c0, 0xc2c739fe40?, 0xc0c26fc4b0, 0xc269954790)
	/data/zhangxiao/matrixone/pkg/sql/colexec2/order/order.go:98 +0x154
github.com/matrixorigin/matrixone/pkg/sql/colexec2/order.Call(0xc269954790?, {0x2aaf860?, 0xc17dcc4c20?})
	/data/zhangxiao/matrixone/pkg/sql/colexec2/order/order.go:62 +0x53
github.com/matrixorigin/matrixone/pkg/vm/overload.Run({0xc06e62ed20?, 0x4, 0x8?}, 0x8?)
	/data/zhangxiao/matrixone/pkg/vm/overload/run.go:55 +0xee
github.com/matrixorigin/matrixone/pkg/vm/pipeline2.(*Pipeline).Run(0xc001b09f20, {0x3210e40, 0xc0bc5c7d50}, 0xc269954790)
	/data/zhangxiao/matrixone/pkg/vm/pipeline2/pipeline.go:75 +0x22d
github.com/matrixorigin/matrixone/pkg/sql/compile2.(*Scope).Run(0xc0610c00a0?, {0x322c400?, 0xc000010028?})
	/data/zhangxiao/matrixone/pkg/sql/compile2/scope.go:259 +0xc5
github.com/matrixorigin/matrixone/pkg/sql/compile2.(*Scope).MergeRun.func1(0x13?)
	/data/zhangxiao/matrixone/pkg/sql/compile2/scope.go:277 +0x79
created by github.com/matrixorigin/matrixone/pkg/sql/compile2.(*Scope).MergeRun
	/data/zhangxiao/matrixone/pkg/sql/compile2/scope.go:272 +0x1ad


select * from employees where officeCode not in ('5','7','1');

[EXPECT RESULT]:

[ACTUAL RESULT]:
employeenumber	lastname	firstname	extension	email	officecode	reportsto	jobtitle
1088	Patterson	William	x4871	wpatterson@classicmodelcars.com	6	1056	Sales Manager (APAC)
1102	Bondur	Gerard	x5408	gbondur@classicmodelcars.com	4	1056	Sale Manager (EMEA)
1188	Firrelli	Julie	x2173	jfirrelli@classicmodelcars.com	2	1143	Sales Rep
1216	Patterson	Steve	x4334	spatterson@classicmodelcars.com	2	1143	Sales Rep
1286	Tseng	Foon Yue	x2248	ftseng@classicmodelcars.com	3	1143	Sales Rep
1323	Vanauf	George	x4102	gvanauf@classicmodelcars.com	3	1143	Sales Rep
1337	Bondur	Loui	x6493	lbondur@classicmodelcars.com	4	1102	Sales Rep
1370	Hernandez	Gerard	x2028	ghernande@classicmodelcars.com	4	1102	Sales Rep
1401	Castillo	Pamela	x2759	pcastillo@classicmodelcars.com	4	1102	Sales Rep
1611	Fixter	Andy	x101	afixter@classicmodelcars.com	6	1088	Sales Rep

select avg(officeCode) from employees where jobTitle like 'Sales%' group by jobTitle order by 1;

[EXPECT RESULT]:

[ACTUAL RESULT]:
unknown error:[42883]undefined function avg[VARCHAR]

select officeCode,sum(cast(officeCode as unsigned)) from employees group by officeCode;

[EXPECT RESULT]:

[ACTUAL RESULT]:
officecode	sum(cast(officecode as unsigned unsigned))
1	6608
6	2699
4	5210
2	2404
3	2609
7	3005

select employeeNumber,officeCode,reportsTo from employees where employeeNumber>1400 and reportsTo is not null order by officeCode+1,employeeNumber;

[EXPECT RESULT]:

[ACTUAL RESULT]:
unknown error:[42883]function 'ifnull' doesn't register, get id failed

select employeeNumber,e.jobTitle,j.jobid from employees e join job j on e.jobTitle=j.jobTitle;

[EXPECT RESULT]:

[ACTUAL RESULT]:
employeenumber	e.jobtitle	j.jobid
1002	President	1
1056	VP Sales	2
1076	VP Marketing	3
1088	Sales Manager (APAC)	4
1102	Sale Manager (EMEA)	5
1143	Sales Manager (NA)	6
1165	Sales Rep	7
1166	Sales Rep	7
1188	Sales Rep	7
1216	Sales Rep	7
1286	Sales Rep	7
1323	Sales Rep	7
1337	Sales Rep	7
1370	Sales Rep	7
1401	Sales Rep	7
1501	Sales Rep	7
1504	Sales Rep	7
1611	Sales Rep	7

select distinct e.jobTitle,j.jobid from employees e join job j on e.jobTitle=j.jobTitle;

[EXPECT RESULT]:

[ACTUAL RESULT]:
unknown error:Internal error: panic runtime error: index out of range [7] with length 2: goroutine 490760 [running]:
runtime/debug.Stack()
	/usr/lib/golang/src/runtime/debug/stack.go:24 +0x65
github.com/matrixorigin/matrixone/pkg/common/moerr.NewPanicError({0x2d6da80?, 0xc1eaeae708})
	/data/zhangxiao/matrixone/pkg/common/moerr/error.go:77 +0x53
github.com/matrixorigin/matrixone/pkg/vm/overload.Run.func1()
	/data/zhangxiao/matrixone/pkg/vm/overload/run.go:50 +0x31
panic({0x2d6da80, 0xc1eaeae708})
	/usr/lib/golang/src/runtime/panic.go:838 +0x207
github.com/matrixorigin/matrixone/pkg/sql/colexec2.EvalExpr(0xc01ba12c30, 0xc2ab09b6b0?, 0xc2e0405a40?)
	/data/zhangxiao/matrixone/pkg/sql/colexec2/expr_eval.go:80 +0xa50
github.com/matrixorigin/matrixone/pkg/sql/colexec2/projection.Call(0xc2ab09b6b0, {0x2aaf9a0?, 0xc0baadc408})
	/data/zhangxiao/matrixone/pkg/sql/colexec2/projection/projection.go:52 +0x176
github.com/matrixorigin/matrixone/pkg/vm/overload.Run({0xc04d2ab8c0?, 0x3, 0x7f6748512e40?}, 0x10?)
	/data/zhangxiao/matrixone/pkg/vm/overload/run.go:55 +0xee
github.com/matrixorigin/matrixone/pkg/vm/pipeline2.(*Pipeline).MergeRun(0xc0cfd7af20, 0xc2ab09b6b0)
	/data/zhangxiao/matrixone/pkg/vm/pipeline2/pipeline.go:130 +0x1af
github.com/matrixorigin/matrixone/pkg/sql/compile2.(*Scope).MergeRun(0xc21a4dc280, {0x322c400?, 0xc000010028})
	/data/zhangxiao/matrixone/pkg/sql/compile2/scope.go:306 +0x574
github.com/matrixorigin/matrixone/pkg/sql/compile2.(*Scope).MergeRun.func2(0x1c?)
	/data/zhangxiao/matrixone/pkg/sql/compile2/scope.go:285 +0x79
created by github.com/matrixorigin/matrixone/pkg/sql/compile2.(*Scope).MergeRun
	/data/zhangxiao/matrixone/pkg/sql/compile2/scope.go:280 +0x2b8


select e.jobTitle,sum(jobid) from employees e join job j on e.jobTitle=j.jobTitle group by jobTitle having sum(jobid)>5;

[EXPECT RESULT]:

[ACTUAL RESULT]:
unknown error:[42702]column reference 'jobtitle' is ambiguous

select e.jobTitle,sum(jobid) from employees e join job j on e.jobTitle=j.jobTitle group by jobTitle having sum(jobid)>5 order by 2 desc;

[EXPECT RESULT]:

[ACTUAL RESULT]:
unknown error:[42702]column reference 'jobtitle' is ambiguous

insert into t1 (a) values ('2'),('4'),('6'),('8'),('10'),('12'),('14'),('16'),('18'),('20'),('22'),('24'),('26'),('23');

[EXPECT RESULT]:

[ACTUAL RESULT]:
unknown error:[42611]Field 'b' doesn't have a default value

select * from t1;

[EXPECT RESULT]:

[ACTUAL RESULT]:
a	b
abc	apple
ab	apple

insert into t1 (a) values ('2'),('4'),('6'),('8'),('10'),('12'),('14'),('16'),('18'),('20'),('22'),('24'),('26'),('23');

[EXPECT RESULT]:

[ACTUAL RESULT]:
unknown error:[42611]Field 'b' doesn't have a default value

]]></failure>
    </testcase>
    <testcase name="cases/dtype/datatype.test" time="0.456">
        <failure type="0002" message="The actual result is not in accordance with the expectation.More,See the detail."><![CDATA[select * from t4 where b>'20211213';

[EXPECT RESULT]:
a	b	c
2	2021-12-14	2021-12-13 00:00:00
3	2021-12-14	2021-12-14 00:00:00
4	2021-12-15	2021-12-14 00:00:00
[ACTUAL RESULT]:
unknown error:[42883]undefined function >[DATE VARCHAR]

select * from t4 where c>'20211213';

[EXPECT RESULT]:
a	b	c
1	2021-12-13	2021-12-13 13:00:00
3	2021-12-14	2021-12-14 00:00:00
4	2021-12-15	2021-12-14 00:00:00
[ACTUAL RESULT]:
unknown error:[42883]undefined function >[DATETIME VARCHAR]

select * from t4 where b>'2021-12-13';

[EXPECT RESULT]:
a	b	c
2	2021-12-14	2021-12-13 00:00:00
3	2021-12-14	2021-12-14 00:00:00
4	2021-12-15	2021-12-14 00:00:00
[ACTUAL RESULT]:
unknown error:[42883]undefined function >[DATE VARCHAR]

select * from t4 where c>'2021-12-13';

[EXPECT RESULT]:
a	b	c
1	2021-12-13	2021-12-13 13:00:00
3	2021-12-14	2021-12-14 00:00:00
4	2021-12-15	2021-12-14 00:00:00
[ACTUAL RESULT]:
unknown error:[42883]undefined function >[DATETIME VARCHAR]

select * from t4 where b between '2021-12-13' and '2021-12-14';

[EXPECT RESULT]:
a	b	c
1	2021-12-13	2021-12-13 13:00:00
2	2021-12-14	2021-12-13 00:00:00
3	2021-12-14	2021-12-14 00:00:00
[ACTUAL RESULT]:
unknown error:[42883]undefined function >=[DATE VARCHAR]

select * from t4 where b not between '2021-12-13' and '2021-12-14';

[EXPECT RESULT]:
a	b	c
4	2021-12-15	2021-12-14 00:00:00
[ACTUAL RESULT]:
unknown error:[42883]undefined function <[DATE VARCHAR]

]]></failure>
    </testcase>
    <testcase name="cases/dtype/date.test" time="0.746">
        <failure type="0002" message="The actual result is not in accordance with the expectation.More,See the detail."><![CDATA[select cast('0000-01-01' as date),cast('0000-01-01' as date)-1;

[EXPECT RESULT]:
cast('0000-01-01' as date)	cast('0000-01-01' as date)-1
0000-01-01	100
[ACTUAL RESULT]:
unknown error:[42883]undefined function -[DATE BIGINT]

select cast('2000-1-1' as date);

[EXPECT RESULT]:
cast('2000-1-1' as date)
2000-01-01
[ACTUAL RESULT]:
unknown error:[22000]Incorrect date value

select cast('200-01-1' as date);

[EXPECT RESULT]:
cast('200-01-1' as date)
0200-01-01
[ACTUAL RESULT]:
unknown error:[22000]Incorrect date value

select cast('2021-02-29' as date);

[EXPECT RESULT]:
cast('2021-02-29' as date)
NULL
[ACTUAL RESULT]:
unknown error:[22000]Incorrect date value

select cast('2022-02-01' as date)-cast('2022-01-01' as date);

[EXPECT RESULT]:
cast('2022-02-01' as date)-cast('2022-01-01' as date)
100
[ACTUAL RESULT]:
unknown error:[42883]undefined function -[DATE DATE]

select cast('2020-02-01' as date)+NULL;

[EXPECT RESULT]:
cast('2020-02-01' as date)+NULL
NULL
[ACTUAL RESULT]:
unknown error:[42725]function doesn't implement its eval method

select cast('0000-00-00' as date);

[EXPECT RESULT]:
cast('0000-00-00' as date)
NULL
[ACTUAL RESULT]:
unknown error:[22000]Incorrect date value

select cast(cast(0x13488c5 as signed) as date);

[EXPECT RESULT]:
cast(cast(0x13488c5 as signed) as date)
2022-01-01
[ACTUAL RESULT]:
unknown error:[42883]undefined function cast[BIGINT DATE]

SELECT DATE_ADD("2017-06-15", INTERVAL 10 DAY);

[EXPECT RESULT]:
DATE_ADD("2017-06-15", INTERVAL 10 DAY)
2017-06-25
[ACTUAL RESULT]:
date_add(2017-06-15, interval(10 day))
2017-06-25

SELECT DATE_ADD("2017-06-15", INTERVAL -10 MONTH);

[EXPECT RESULT]:
DATE_ADD("2017-06-15", INTERVAL -10 MONTH)
2016-08-15
[ACTUAL RESULT]:
syntax error at position 41; You have an error in your SQL syntax; check the manual that corresponds to your MatrixOne server version for the right syntax to use

SELECT DATE_ADD("2017-06-15", INTERVAL -2018 YEAR);

[EXPECT RESULT]:
DATE_ADD("2017-06-15", INTERVAL -2018 YEAR)
NULL
[ACTUAL RESULT]:
syntax error at position 41; You have an error in your SQL syntax; check the manual that corresponds to your MatrixOne server version for the right syntax to use

SELECT DATE_ADD(20200215, INTERVAL 14 DAY);

[EXPECT RESULT]:
DATE_ADD(20200215, INTERVAL 14 DAY)
2020-02-29
[ACTUAL RESULT]:
unknown error:[42883]undefined function date_add[BIGINT BIGINT BIGINT]

select * from t1 where a='2022-01-01';

[EXPECT RESULT]:
a
2022-01-01
[ACTUAL RESULT]:
unknown error:[42883]undefined function =[DATE VARCHAR]

insert into t1 (big) values ('2000-01-01'),('2001-01-01'),('2002-01-01');

[EXPECT RESULT]:

[ACTUAL RESULT]:
unknown error:[42611]Field 'a' doesn't have a default value

select * from t1;

[EXPECT RESULT]:
a	big
1	2000-01-01
1	2001-01-01
1	2002-01-01
[ACTUAL RESULT]:
a	big

select * from t1 order by big limit 1,2;

[EXPECT RESULT]:
a	big
1	2001-01-01
1	2002-01-01
[ACTUAL RESULT]:
a	big

select * from t1 order by big limit 2 offset 1;

[EXPECT RESULT]:
a	big
1	2001-01-01
1	2002-01-01
[ACTUAL RESULT]:
a	big

select distinct big from t1 where big=20000101;

[EXPECT RESULT]:
big
2000-01-01
[ACTUAL RESULT]:
unknown error:[42883]undefined function =[DATE BIGINT]

select min(big),max(big),max(big)-1 from t1;

[EXPECT RESULT]:
min(big)	max(big)	max(big)-1
2000-01-01	2002-01-01	20020100
[ACTUAL RESULT]:
unknown error:[42883]undefined function -[DATE BIGINT]

select min(big),avg(big),count(big)+1 from t1 group by big;

[EXPECT RESULT]:
min(big)	avg(big)	count(big)+1
2000-01-01	20000101.0000	2
2001-01-01	20010101.0000	2
2002-01-01	20020101.0000	2
[ACTUAL RESULT]:
unknown error:[42883]undefined function avg[DATE]

insert into t1(a) values (1);

[EXPECT RESULT]:

[ACTUAL RESULT]:
unknown error:[42611]Field 'id' doesn't have a default value

select * from t1;

[EXPECT RESULT]:
id	a
2022-01-31	1
[ACTUAL RESULT]:
id	a

select * from t1 join t2 on t1.dvalue=t2.dvalue order by 1 desc,t2.value32 asc;

[EXPECT RESULT]:
dvalue	value32	dvalue	value32
2022-01-02	2	2022-01-02	4
2022-01-01	1	2022-01-01	5
[ACTUAL RESULT]:
unknown error:Internal error: panic runtime error: index out of range [1] with length 1: goroutine 491772 [running]:
runtime/debug.Stack()
	/usr/lib/golang/src/runtime/debug/stack.go:24 +0x65
github.com/matrixorigin/matrixone/pkg/common/moerr.NewPanicError({0x2d6da80?, 0xc149ba9e60})
	/data/zhangxiao/matrixone/pkg/common/moerr/error.go:77 +0x53
github.com/matrixorigin/matrixone/pkg/vm/overload.Run.func1()
	/data/zhangxiao/matrixone/pkg/vm/overload/run.go:50 +0x31
panic({0x2d6da80, 0xc149ba9e60})
	/usr/lib/golang/src/runtime/panic.go:838 +0x207
github.com/matrixorigin/matrixone/pkg/sort/desc/int64s.insertionSort(...)
	/data/zhangxiao/matrixone/pkg/sort/desc/int64s/sort.go:60
github.com/matrixorigin/matrixone/pkg/sort/desc/int64s.quickSort({0xc1f8c79690?, 0x1, 0x1}, {0xc1f8c796a0?, 0x2, 0x2}, 0x0?, 0x0?, 0x0?)
	/data/zhangxiao/matrixone/pkg/sort/desc/int64s/sort.go:53 +0x27b
github.com/matrixorigin/matrixone/pkg/sort/desc/int64s.Sort({0xc1f8c79690?, 0x7f67788831d8?, 0x10?}, {0xc1f8c796a0?, 0xc1f8c796a0?, 0x0?})
	/data/zhangxiao/matrixone/pkg/sort/desc/int64s/sort.go:14 +0x45
github.com/matrixorigin/matrixone/pkg/sort.Sort(0x10?, {0xc1f8c796a0?, 0xc0c56bce10?, 0x1?}, 0x231f90f?)
	/data/zhangxiao/matrixone/pkg/sort/sort.go:87 +0x2a8
github.com/matrixorigin/matrixone/pkg/sql/colexec2/order.(*Container).process(0xc2761a6960, 0xc406bddb20?, 0xc0c56bce10, 0xc0ae5b09a0)
	/data/zhangxiao/matrixone/pkg/sql/colexec2/order/order.go:98 +0x154
github.com/matrixorigin/matrixone/pkg/sql/colexec2/order.Call(0xc0ae5b09a0?, {0x2aaf860?, 0xc1ade76f80?})
	/data/zhangxiao/matrixone/pkg/sql/colexec2/order/order.go:62 +0x53
github.com/matrixorigin/matrixone/pkg/vm/overload.Run({0xc174ee2360?, 0x4, 0x7f6748757340?}, 0x420?)
	/data/zhangxiao/matrixone/pkg/vm/overload/run.go:55 +0xee
github.com/matrixorigin/matrixone/pkg/vm/pipeline2.(*Pipeline).MergeRun(0xc3809d3c30, 0xc0ae5b09a0)
	/data/zhangxiao/matrixone/pkg/vm/pipeline2/pipeline.go:130 +0x1af
github.com/matrixorigin/matrixone/pkg/sql/compile2.(*Scope).MergeRun(0xc0b29ed5e0, {0x322c400?, 0xc000010028})
	/data/zhangxiao/matrixone/pkg/sql/compile2/scope.go:306 +0x574
github.com/matrixorigin/matrixone/pkg/sql/compile2.(*Scope).DispatchRun(0xc0b29ed5e0, {0x322c400, 0xc000010028})
	/data/zhangxiao/matrixone/pkg/sql/compile2/scope.go:368 +0x8d4
github.com/matrixorigin/matrixone/pkg/sql/compile2.(*Scope).ParallelRun(0x2?, {0x322c400?, 0xc000010028?})
	/data/zhangxiao/matrixone/pkg/sql/compile2/scope.go:381 +0x1af
github.com/matrixorigin/matrixone/pkg/sql/compile2.(*Scope).RemoteRun(0xc21a4dd400?, {0x322c400?, 0xc000010028?})
	/data/zhangxiao/matrixone/pkg/sql/compile2/scope.go:373 +0x25
github.com/matrixorigin/matrixone/pkg/sql/compile2.(*Scope).MergeRun.func3(0x13?)
	/data/zhangxiao/matrixone/pkg/sql/compile2/scope.go:293 +0x79
created by github.com/matrixorigin/matrixone/pkg/sql/compile2.(*Scope).MergeRun
	/data/zhangxiao/matrixone/pkg/sql/compile2/scope.go:288 +0x4ed


select * from t1 join t2 on t1.dvalue=t2.dvalue where t1.dvalue>='2022-01-01' group by t1.dvalue order by t2.dvalue;

[EXPECT RESULT]:
dvalue	value32	dvalue	value32
2022-01-01	1	2022-01-01	5
2022-01-02	2	2022-01-02	4
[ACTUAL RESULT]:
unknown error:[42883]undefined function >=[DATE VARCHAR]

SELECT id, id >= 20200102 FROM t_date;

[EXPECT RESULT]:
id	id >= 20200102
2020-01-01	false	
2022-01-02	true
[ACTUAL RESULT]:
unknown error:[42883]undefined function >=[DATE BIGINT]

SELECT id, 1.1 <= '2020-01-01' FROM t_date;

[EXPECT RESULT]:
id	1.1 <= '2020-01-01'
2020-01-01	true	
2022-01-02	true
[ACTUAL RESULT]:
unknown error:[42883]undefined function <=[DOUBLE VARCHAR]

SELECT id, id = 202020101 FROM t_date;

[EXPECT RESULT]:
id	id = 202020101
2020-01-01	false	
2022-01-02	false
[ACTUAL RESULT]:
unknown error:[42883]undefined function =[DATE BIGINT]

SELECT id, 20200101 = id FROM t_date;

[EXPECT RESULT]:
id	20200101 = id
2020-01-01	true	
2022-01-02	false
[ACTUAL RESULT]:
unknown error:[42883]undefined function =[BIGINT DATE]

SELECT * from t_date WHERE id = 20200101;

[EXPECT RESULT]:
id
2020-01-01
[ACTUAL RESULT]:
unknown error:[42883]undefined function =[DATE BIGINT]

SELECT * from t_date WHERE id = 2.0200101e7;

[EXPECT RESULT]:
id
2020-01-01
[ACTUAL RESULT]:
unknown error:[42883]undefined function =[DATE DOUBLE]

SELECT * from t_date WHERE id = '20200101';

[EXPECT RESULT]:
id
2020-01-01
[ACTUAL RESULT]:
unknown error:[42883]undefined function =[DATE VARCHAR]

SELECT * from t_date WHERE id IN ('2020-01-01','2022-01-03');

[EXPECT RESULT]:
id
2020-01-01
[ACTUAL RESULT]:
unknown error:[42883]undefined function =[DATE VARCHAR]

SELECT * from t_date WHERE id IN (2.0200101e7,2.0200103e7 );

[EXPECT RESULT]:
id
2020-01-01
[ACTUAL RESULT]:
unknown error:[42883]undefined function =[DATE DOUBLE]

SELECT * from t_date WHERE id IN (20220101, 20220103);

[EXPECT RESULT]:
id
[ACTUAL RESULT]:
unknown error:[42883]undefined function =[DATE BIGINT]

SELECT * from t_date WHERE id IN ('2.0200101e7','2.0200103e7');

[EXPECT RESULT]:
id
[ACTUAL RESULT]:
unknown error:[42883]undefined function =[DATE VARCHAR]

SELECT * from t_date WHERE id BETWEEN 20191231 AND 20200101;

[EXPECT RESULT]:
id
2020-01-01
[ACTUAL RESULT]:
unknown error:[42883]undefined function >=[DATE BIGINT]

SELECT * from t_date WHERE id BETWEEN 2.0200101e7 and 2.0200103e7;

[EXPECT RESULT]:
id
2020-01-01
[ACTUAL RESULT]:
unknown error:[42883]undefined function >=[DATE DOUBLE]

SELECT * from t_date WHERE id BETWEEN '2020-01-02' AND '2020-01-03';

[EXPECT RESULT]:
id
[ACTUAL RESULT]:
unknown error:[42883]undefined function >=[DATE VARCHAR]

SELECT * from t_date WHERE id BETWEEN '2.0200101e7' and '2.0200103e7';

[EXPECT RESULT]:
id
[ACTUAL RESULT]:
unknown error:[42883]undefined function >=[DATE VARCHAR]

SELECT * FROM t1 WHERE coalesce(a) BETWEEN '2022-02-28' and '2022-03-01';

[EXPECT RESULT]:
a
2022-03-01
[ACTUAL RESULT]:
unknown error:[42883]function 'coalesce' doesn't register, get id failed

SELECT * FROM t1 WHERE coalesce(a)=20220301;

[EXPECT RESULT]:
a
2022-03-01
[ACTUAL RESULT]:
unknown error:[42883]function 'coalesce' doesn't register, get id failed

SELECT * FROM t1 WHERE coalesce(a) in ('2022-02-28','2022-03-01');

[EXPECT RESULT]:
a
2022-03-01
[ACTUAL RESULT]:
unknown error:[42883]function 'coalesce' doesn't register, get id failed

SELECT CAST(20220101 AS date) BETWEEN 20220101 AND -1;

[EXPECT RESULT]:
CAST(20220101 AS date) BETWEEN 20220101 AND -1
false
[ACTUAL RESULT]:
unknown error:[42883]undefined function cast[BIGINT DATE]

SELECT CAST(00000501 AS date) NOT BETWEEN 100 AND -1;

[EXPECT RESULT]:
CAST(00000501 AS date) NOT BETWEEN 100 AND -1
true
[ACTUAL RESULT]:
unknown error:[42883]undefined function cast[BIGINT DATE]

SELECT CAST(0 AS date) BETWEEN 0 AND -1;

[EXPECT RESULT]:
CAST(0 AS date) BETWEEN 0 AND -1
NULL
[ACTUAL RESULT]:
unknown error:[42883]undefined function cast[BIGINT DATE]

SELECT CAST(10000101 as date) BETWEEN '1000-01-01' and '1000-01-02';

[EXPECT RESULT]:
CAST(10000101 as date) BETWEEN '1000-01-01' and '1000-01-02'
true
[ACTUAL RESULT]:
unknown error:[42883]undefined function cast[BIGINT DATE]

insert into t1 (a) values ('2022-01-02'),('2022-01-04'),('2022-01-06'),('2022-01-08'),('2022-01-10'),('2022-01-12');

[EXPECT RESULT]:

[ACTUAL RESULT]:
unknown error:[42611]Field 'b' doesn't have a default value

insert into t1 (a) values ('2022-01-02'),('2022-01-04'),('2022-01-06'),('2022-01-08'),('2022-01-10'),('2022-01-12');

[EXPECT RESULT]:

[ACTUAL RESULT]:
unknown error:[42611]Field 'b' doesn't have a default value

]]></failure>
    </testcase>
    <testcase name="cases/dtype/datetime.test" time="0.79">
        <failure type="0002" message="The actual result is not in accordance with the expectation.More,See the detail."><![CDATA[select cast('2000-01-01 00:00:00' as datetime(0));

[EXPECT RESULT]:
cast('2000-01-01 00:00:00' as datetime(0))
2000-01-01 00:00:00
[ACTUAL RESULT]:
cast(2000-01-01 00:00:00 as datetime(0))
2000-01-01 00:00:00

select cast('2000-01-01 00:00:00.0011' as datetime(0));

[EXPECT RESULT]:
cast('2000-01-01 00:00:00.0011' as datetime )
2000-01-01 00:00:00
[ACTUAL RESULT]:
cast(2000-01-01 00:00:00.0011 as datetime(0))
2000-01-01 00:00:00.001100000

select cast('2000-01-01 00:00:00.9011' as datetime(0));

[EXPECT RESULT]:
cast('2000-01-01 00:00:00.9011' as datetime )
2000-01-01 00:00:01
[ACTUAL RESULT]:
cast(2000-01-01 00:00:00.9011 as datetime(0))
2000-01-01 00:00:00.901100000

select cast('2000-01-01 00:00:00.001100999' as datetime(6));

[EXPECT RESULT]:
cast('2000-01-01 00:00:00.001100999' as datetime(6))
2000-01-01 00:00:00.001101
[ACTUAL RESULT]:
cast(2000-01-01 00:00:00.001100999 as datetime(6))
2000-01-01 00:00:00

select cast('2000-01-01 00:00:00.001109' as datetime(5));

[EXPECT RESULT]:
cast('2000-01-01 00:00:00.001109' as datetime(5))
2000-01-01 00:00:00.00111
[ACTUAL RESULT]:
cast(2000-01-01 00:00:00.001109 as datetime(5))
2000-01-01 00:00:00.001109000

select cast('2000-01-01 00:00:00.501109' as datetime(0));

[EXPECT RESULT]:
cast('2000-01-01 00:00:00.501109' as datetime(0))
2000-01-01 00:00:01
[ACTUAL RESULT]:
cast(2000-01-01 00:00:00.501109 as datetime(0))
2000-01-01 00:00:00.501109000

select cast('2000-01-01 00:00:00.49999' as datetime(0));

[EXPECT RESULT]:
cast('2000-01-01 00:00:00.49999' as datetime(0))
2000-01-01 00:00:00
[ACTUAL RESULT]:
cast(2000-01-01 00:00:00.49999 as datetime(0))
2000-01-01 00:00:00.499990000

select cast('2000-1-1' as datetime(0));

[EXPECT RESULT]:
cast('2000-1-1' as datetime(0))
2000-01-01 00:00:00
[ACTUAL RESULT]:
unknown error:[22000]Incorrect datetime value

select cast('2022-01-01 25:00:00' as datetime(0));

[EXPECT RESULT]:
cast('2022-01-01 25:00:00' as datetime(0))
NULL
[ACTUAL RESULT]:
unknown error:[22000]Incorrect datetime value

select cast('2000-1-1' as datetime(0))+1;

[EXPECT RESULT]:
cast('2000-1-1' as datetime(0))+1
20000101000001
[ACTUAL RESULT]:
unknown error:[42883]undefined function +[DATETIME BIGINT]

select cast('2000-1-1' as datetime(0))*1;

[EXPECT RESULT]:
cast('2000-1-1' as datetime(0))*1
20000101000000
[ACTUAL RESULT]:
unknown error:[42883]undefined function *[DATETIME BIGINT]

select cast('2000-1-1' as datetime(0))*1.1;

[EXPECT RESULT]:
cast('2000-1-1' as datetime(0))*1.1
22000111100000.0
[ACTUAL RESULT]:
unknown error:[42883]undefined function *[DATETIME DOUBLE]

SELECT DATE_ADD('2022-02-28 23:59:59.9999', INTERVAL 1 SECOND) '1 second later';

[EXPECT RESULT]:
1 second later
2022-03-01 00:00:00.999900
[ACTUAL RESULT]:
syntax error at position 80 near '1 second later'; You have an error in your SQL syntax; check the manual that corresponds to your MatrixOne server version for the right syntax to use

SELECT DATE_ADD('2022-02-28 23:59:59.9999', INTERVAL 1 MINUTE) '1 minute later';

[EXPECT RESULT]:
1 minute later
2022-03-01 00:00:59.999900
[ACTUAL RESULT]:
syntax error at position 80 near '1 minute later'; You have an error in your SQL syntax; check the manual that corresponds to your MatrixOne server version for the right syntax to use

SELECT DATE_ADD('2022-02-28 23:59:59.9999', INTERVAL 1 HOUR) '1 hour later';

[EXPECT RESULT]:
1 hour later
2022-03-01 00:59:59.999900
[ACTUAL RESULT]:
syntax error at position 76 near '1 hour later'; You have an error in your SQL syntax; check the manual that corresponds to your MatrixOne server version for the right syntax to use

SELECT DATE_ADD('2022-02-28 23:59:59.9999', INTERVAL 1 DAY) '1 day later';

[EXPECT RESULT]:
1 day later
2022-03-01 23:59:59.999900
[ACTUAL RESULT]:
syntax error at position 74 near '1 day later'; You have an error in your SQL syntax; check the manual that corresponds to your MatrixOne server version for the right syntax to use

SELECT DATE_ADD('2022-02-28 23:59:59.9999', INTERVAL 1 WEEK) '1 week later';

[EXPECT RESULT]:
1 week later
2022-03-07 23:59:59.999900
[ACTUAL RESULT]:
syntax error at position 76 near '1 week later'; You have an error in your SQL syntax; check the manual that corresponds to your MatrixOne server version for the right syntax to use

SELECT DATE_ADD('2022-02-28 23:59:59.9999', INTERVAL -13 MONTH) '1 month earlier';

[EXPECT RESULT]:
1 month earlier
2021-01-28 23:59:59.999900
[ACTUAL RESULT]:
syntax error at position 55; You have an error in your SQL syntax; check the manual that corresponds to your MatrixOne server version for the right syntax to use

SELECT DATE_ADD('2022-02-28 23:59:59.9999', INTERVAL -1 YEAR) '1 year earlier';

[EXPECT RESULT]:
1 year earlier
2021-02-28 23:59:59.999900
[ACTUAL RESULT]:
syntax error at position 55; You have an error in your SQL syntax; check the manual that corresponds to your MatrixOne server version for the right syntax to use

select cast(cast('2000-12-31' as date) as datetime(0));

[EXPECT RESULT]:
cast(cast('2000-12-31' as date) as datetime(0))
2000-12-31 00:00:00
[ACTUAL RESULT]:
unknown error:[42883]undefined function cast[DATE DATETIME]

select cast(cast('2000-12-31' as datetime(0)) as date);

[EXPECT RESULT]:
cast(cast('2000-12-31' as datetime(0)) as date)
2000-12-31
[ACTUAL RESULT]:
unknown error:[42883]undefined function cast[DATETIME DATE]

select * from t1;

[EXPECT RESULT]:
a
2020-01-01 00:00:00
2022-01-02 00:00:00
2022-01-02 00:00:01
2022-01-02 00:00:02
[ACTUAL RESULT]:
a
2020-01-01 00:00:00
2022-01-02 00:00:00
2022-01-02 00:00:01
2022-01-02 00:00:01.512345000

select * from t1 where a='2022-01-02';

[EXPECT RESULT]:
a
2022-01-02 00:00:00
[ACTUAL RESULT]:
unknown error:[42883]undefined function =[DATETIME VARCHAR]

select * from t1 where a>20220102;

[EXPECT RESULT]:
a
2022-01-02 00:00:01
2022-01-02 00:00:02
[ACTUAL RESULT]:
unknown error:[42883]undefined function >[DATETIME BIGINT]

select * from t1 where a!='2022-01-02';

[EXPECT RESULT]:
a
2020-01-01 00:00:00
2022-01-02 00:00:01
2022-01-02 00:00:02
[ACTUAL RESULT]:
unknown error:[42883]undefined function <>[DATETIME VARCHAR]

insert into t1 (big) values (20220103),('2022-01-01'),('2022-01-01 00:00:01'),('2022-01-02 00:00.00.000050');

[EXPECT RESULT]:

[ACTUAL RESULT]:
unknown error:[42611]Field 'a' doesn't have a default value

select * from t1;

[EXPECT RESULT]:
a	big
1	2022-01-01 00:00:00.0000
1	2022-01-01 00:00:01.0000
1	2022-01-02 00:00:00.0001
1	2022-01-03 00:00:00.0000
[ACTUAL RESULT]:
a	big

select * from t1 order by big limit 1,3;

[EXPECT RESULT]:
a	big
1	2022-01-01 00:00:01.0000
1	2022-01-02 00:00:00.0001
1	2022-01-03 00:00:00.0000
[ACTUAL RESULT]:
a	big

select * from t1 order by big limit 3 offset 1;

[EXPECT RESULT]:
a	big
1	2022-01-01 00:00:01.0000
1	2022-01-02 00:00:00.0001
1	2022-01-03 00:00:00.0000
[ACTUAL RESULT]:
a	big

select min(big),max(big),max(big)-1 from t1 group by a;

[EXPECT RESULT]:
min(big)	max(big)	max(big)-1
2022-01-01 00:00:00.0000	2022-01-03 00:00:00.0000	20220102999999.0000
[ACTUAL RESULT]:
unknown error:[42883]undefined function -[DATETIME BIGINT]

insert into t1(a) values(1);

[EXPECT RESULT]:

[ACTUAL RESULT]:
unknown error:[42611]Field 'id' doesn't have a default value

select * from t1;

[EXPECT RESULT]:

[ACTUAL RESULT]:
id	a

select * from t1;

[EXPECT RESULT]:

[ACTUAL RESULT]:
dt	value32
2022-01-01 00:00:00.000050000	1
2022-01-01 00:00:00.000500000	2
2022-01-01 00:00:00.005000000	3

select * from t2;

[EXPECT RESULT]:

[ACTUAL RESULT]:
dt	value32
2022-01-01 00:00:00.005000000	4
2022-01-01 00:00:00.001000000	5

select * from t1 join t2 on t1.dt=t2.dt order by 1 desc, t2.dt asc;

[EXPECT RESULT]:

[ACTUAL RESULT]:
dt	value32	dt	value32
2022-01-01 00:00:00.005000000	3	2022-01-01 00:00:00.005000000	4

select * from t1 join t2 on t1.dt=t2.dt where t1.value32<>t2.value32;

[EXPECT RESULT]:

[ACTUAL RESULT]:
dt	value32	dt	value32
2022-01-01 00:00:00.005000000	3	2022-01-01 00:00:00.005000000	3

SELECT id, id >= 20200102 FROM t_datetime;

[EXPECT RESULT]:

[ACTUAL RESULT]:
unknown error:[42883]undefined function >=[DATETIME BIGINT]

SELECT id, id = 202020101 FROM t_datetime;

[EXPECT RESULT]:

[ACTUAL RESULT]:
unknown error:[42883]undefined function =[DATETIME BIGINT]

SELECT id, 20200101 = id FROM t_datetime;

[EXPECT RESULT]:

[ACTUAL RESULT]:
unknown error:[42883]undefined function =[BIGINT DATETIME]

SELECT * from t_datetime WHERE id = 20200102;

[EXPECT RESULT]:

[ACTUAL RESULT]:
unknown error:[42883]undefined function =[DATETIME BIGINT]

SELECT * from t_datetime WHERE id = 2.0200102e7;

[EXPECT RESULT]:

[ACTUAL RESULT]:
unknown error:[42883]undefined function =[DATETIME DOUBLE]

SELECT * from t_datetime WHERE id = '20200102';

[EXPECT RESULT]:

[ACTUAL RESULT]:
unknown error:[42883]undefined function =[DATETIME VARCHAR]

SELECT * from t_datetime WHERE id IN ('2020-01-01','2022-01-02';

[EXPECT RESULT]:

[ACTUAL RESULT]:
syntax error at position 65; You have an error in your SQL syntax; check the manual that corresponds to your MatrixOne server version for the right syntax to use

SELECT * from t_datetime WHERE id IN (2.0200101e7,2.0200102e7 );

[EXPECT RESULT]:

[ACTUAL RESULT]:
unknown error:[42883]undefined function =[DATETIME DOUBLE]

SELECT * from t_datetime WHERE id IN (20220101, 20220102);

[EXPECT RESULT]:

[ACTUAL RESULT]:
unknown error:[42883]undefined function =[DATETIME BIGINT]

SELECT * from t_datetime WHERE id IN ('2.0200101e7','2.0200102e7');

[EXPECT RESULT]:

[ACTUAL RESULT]:
unknown error:[42883]undefined function =[DATETIME VARCHAR]

SELECT * from t_datetime WHERE id BETWEEN 20191231 AND 20200101;

[EXPECT RESULT]:

[ACTUAL RESULT]:
unknown error:[42883]undefined function >=[DATETIME BIGINT]

SELECT * from t_datetime WHERE id BETWEEN 2.0200101e7 and 2.0200102e7;

[EXPECT RESULT]:

[ACTUAL RESULT]:
unknown error:[42883]undefined function >=[DATETIME DOUBLE]

SELECT * from t_datetime WHERE id BETWEEN '2020-01-01' AND '2020-01-02';

[EXPECT RESULT]:

[ACTUAL RESULT]:
unknown error:[42883]undefined function >=[DATETIME VARCHAR]

SELECT * from t_datetime WHERE id BETWEEN '2022-01-01 00:00:00' AND '2022-01-02 00:00:00.000000';

[EXPECT RESULT]:

[ACTUAL RESULT]:
unknown error:[42883]undefined function >=[DATETIME VARCHAR]

SELECT * FROM t1 WHERE coalesce(a) not BETWEEN '2022-02-28' and '2022-03-01';

[EXPECT RESULT]:

[ACTUAL RESULT]:
unknown error:[42883]function 'coalesce' doesn't register, get id failed

SELECT * FROM t1 WHERE coalesce(a)!=20220301;

[EXPECT RESULT]:

[ACTUAL RESULT]:
unknown error:[42883]function 'coalesce' doesn't register, get id failed

SELECT * FROM t1 WHERE coalesce(a) in ('2022-03-01','2022-03-01 00:00:00.0001');

[EXPECT RESULT]:

[ACTUAL RESULT]:
unknown error:[42883]function 'coalesce' doesn't register, get id failed

SELECT CAST(20220101 AS datetime(0)) BETWEEN 20220101 AND -1;

[EXPECT RESULT]:

[ACTUAL RESULT]:
unknown error:[42883]undefined function cast[BIGINT DATETIME]

SELECT CAST(00000501 AS datetime(0)) NOT BETWEEN 100 AND -1;

[EXPECT RESULT]:

[ACTUAL RESULT]:
unknown error:[42883]undefined function cast[BIGINT DATETIME]

SELECT CAST(0 AS datetime(0)) BETWEEN 0 AND -1;

[EXPECT RESULT]:

[ACTUAL RESULT]:
unknown error:[42883]undefined function cast[BIGINT DATETIME]

SELECT CAST(1000101 as datetime(0)) BETWEEN '1000-01-01' and '1000-01-02';

[EXPECT RESULT]:

[ACTUAL RESULT]:
unknown error:[42883]undefined function cast[BIGINT DATETIME]

insert into t1 (a) values ('2022-01-02'),('2022-01-04'),('2022-01-06'),('2022-01-08'),('2022-01-10 01:01:01.000'),('2022-01-12');

[EXPECT RESULT]:

[ACTUAL RESULT]:
unknown error:[42611]Field 'b' doesn't have a default value

select * from t1;

[EXPECT RESULT]:

[ACTUAL RESULT]:
a	b
2022-01-01 00:00:00	apple
2022-01-02 00:00:00	apple

select * from t11;

[EXPECT RESULT]:

[ACTUAL RESULT]:
a	b
2022-01-03 00:00:00	10
2022-01-01 00:00:00	11
2022-01-02 00:00:00	12

select * from t12;

[EXPECT RESULT]:

[ACTUAL RESULT]:
a	b
2022-03-03 00:00:00	10
2020-01-03 01:00:00	11
2022-01-02 00:00:00	12

insert into t1 (a) values ('2022-01-02'),('2022-01-04'),('2022-01-06'),('2022-01-08'),('2022-01-10 01:01:01.000'),('2022-01-12');

[EXPECT RESULT]:

[ACTUAL RESULT]:
unknown error:[42611]Field 'b' doesn't have a default value

]]></failure>
    </testcase>
    <testcase name="cases/dtype/decimal.test" time="0.884">
        <failure type="0002" message="The actual result is not in accordance with the expectation.More,See the detail."><![CDATA[select 0.00,1.11,1234567890.1234567890123456789;

[EXPECT RESULT]:
0.00	1.11	1234567890.1234567890123456789
0.00	1.11	1234567890.1234567890123456789
[ACTUAL RESULT]:
0.00	1.11	1234567890.1234567890123456789
0.0	1.11	1.2345678901235E9

select 1123.2333+1233.3331;

[EXPECT RESULT]:
1123.2333+1233.3331
2356.5664
[ACTUAL RESULT]:
1123.2333 + 1233.3331
2356.5664

select cast(9223372.036854775808 as decimal)+1;

[EXPECT RESULT]:
cast(9223372.036854775808 as decimal)+1
9223373
[ACTUAL RESULT]:
unknown error:[42883]undefined function cast[DOUBLE DECIMAL64]

select round(cast(2320310.66666612312 as decimal));

[EXPECT RESULT]:
round(cast(2320310.66666612312 as decimal))
2320311
[ACTUAL RESULT]:
unknown error:[42883]undefined function cast[DOUBLE DECIMAL64]

select floor(cast(2231231.501231 as decimal));

[EXPECT RESULT]:
floor(cast(2231231.501231 as decimal))
2231232
[ACTUAL RESULT]:
unknown error:[42883]undefined function cast[DOUBLE DECIMAL64]

insert into t1 values (18446744073709551615), (0xFFFFFFFFFFFFFE), (18446744073709551613.0000000), (18446744073709551612.0000000001);

[EXPECT RESULT]:

[ACTUAL RESULT]:
unknown error:invalid decimal string

select * from t1;

[EXPECT RESULT]:
a
72057594037927934
18446744073709551612
18446744073709551613
18446744073709551615
[ACTUAL RESULT]:
a

select * from t1 where a=18446744073709551615;

[EXPECT RESULT]:
a
18446744073709551615
[ACTUAL RESULT]:
a

insert into t1 (big) values (-1),(12.34567891234567),(92.23372036854775807);

[EXPECT RESULT]:

[ACTUAL RESULT]:
unknown error:[42611]Field 'a' doesn't have a default value

select * from t1;

[EXPECT RESULT]:
a	big
1	-1.00000000000
1	12.34567891235
1	92.23372036855
[ACTUAL RESULT]:
a	big

select min(big),max(big),max(big)-1 from t1;

[EXPECT RESULT]:
min(big)	max(big)	max(big)-1
-1.00000000000	92.23372036855	91.23372036855
select min(big),avg(big),max(big)-1 from t1 group by a;
min(big)	avg(big)	max(big)-1
-1.00000000000	34.526466426966667	91.23372036855
[ACTUAL RESULT]:
unknown error:Internal error: panic runtime error: invalid memory address or nil pointer dereference: goroutine 492758 [running]:
runtime/debug.Stack()
	/usr/lib/golang/src/runtime/debug/stack.go:24 +0x65
github.com/matrixorigin/matrixone/pkg/common/moerr.NewPanicError({0x2bf4e20?, 0x44252f0})
	/data/zhangxiao/matrixone/pkg/common/moerr/error.go:77 +0x53
github.com/matrixorigin/matrixone/pkg/vm/overload.Run.func1()
	/data/zhangxiao/matrixone/pkg/vm/overload/run.go:50 +0x31
panic({0x2bf4e20, 0x44252f0})
	/usr/lib/golang/src/runtime/panic.go:838 +0x207
github.com/matrixorigin/matrixone/pkg/sql/colexec2/mergegroup.Call(0xc42160a210, {0x2aaf660?, 0xc3b3756190})
	/data/zhangxiao/matrixone/pkg/sql/colexec2/mergegroup/group.go:56 +0x1a8
github.com/matrixorigin/matrixone/pkg/vm/overload.Run({0xc1924a6120?, 0x3, 0x7f65f5c9b060?}, 0x10?)
	/data/zhangxiao/matrixone/pkg/vm/overload/run.go:55 +0xee
github.com/matrixorigin/matrixone/pkg/vm/pipeline2.(*Pipeline).MergeRun(0xc0db3c8f20, 0xc42160a210)
	/data/zhangxiao/matrixone/pkg/vm/pipeline2/pipeline.go:130 +0x1af
github.com/matrixorigin/matrixone/pkg/sql/compile2.(*Scope).MergeRun(0xc269150460, {0x322c400?, 0xc000010028})
	/data/zhangxiao/matrixone/pkg/sql/compile2/scope.go:306 +0x574
github.com/matrixorigin/matrixone/pkg/sql/compile2.(*Scope).MergeRun.func2(0x13?)
	/data/zhangxiao/matrixone/pkg/sql/compile2/scope.go:285 +0x79
created by github.com/matrixorigin/matrixone/pkg/sql/compile2.(*Scope).MergeRun
	/data/zhangxiao/matrixone/pkg/sql/compile2/scope.go:280 +0x2b8


insert into t1 (big) values (0),(18446744073), (0xFFFFFE), (184467.13), (184462);

[EXPECT RESULT]:

[ACTUAL RESULT]:
unknown error:[42611]Field 'a' doesn't have a default value

select * from t1 order by 2 desc;

[EXPECT RESULT]:
a	big
1	18446744073.0000
1	16777214.0000
1	184467.1300
1	184462.0000
1	0.0000
[ACTUAL RESULT]:
a	big

select * from t1 order by big limit 1,2;

[EXPECT RESULT]:
a	big
1	184462.0000
1	184467.1300
[ACTUAL RESULT]:
a	big

select * from t1 order by big limit 2 offset 1;

[EXPECT RESULT]:
a	big
1	184462.0000
1	184467.1300
[ACTUAL RESULT]:
a	big

select min(big),max(big),max(big)-1 from t1;

[EXPECT RESULT]:
min(big)	max(big)	max(big)-1
0.0000	18446744073.0000	18446744072.0000
select min(big),count(big),max(big)-1 from t1 group by a;
min(big)	count(big)	max(big)-1
0.0000	5	18446744072.0000
[ACTUAL RESULT]:
unknown error:Internal error: panic runtime error: invalid memory address or nil pointer dereference: goroutine 492760 [running]:
runtime/debug.Stack()
	/usr/lib/golang/src/runtime/debug/stack.go:24 +0x65
github.com/matrixorigin/matrixone/pkg/common/moerr.NewPanicError({0x2bf4e20?, 0x44252f0})
	/data/zhangxiao/matrixone/pkg/common/moerr/error.go:77 +0x53
github.com/matrixorigin/matrixone/pkg/vm/overload.Run.func1()
	/data/zhangxiao/matrixone/pkg/vm/overload/run.go:50 +0x31
panic({0x2bf4e20, 0x44252f0})
	/usr/lib/golang/src/runtime/panic.go:838 +0x207
github.com/matrixorigin/matrixone/pkg/sql/colexec2/mergegroup.Call(0xc42160adc0, {0x2aaf660?, 0xc3b37568f0})
	/data/zhangxiao/matrixone/pkg/sql/colexec2/mergegroup/group.go:56 +0x1a8
github.com/matrixorigin/matrixone/pkg/vm/overload.Run({0xc094bac960?, 0x3, 0x7f65f5c9b060?}, 0x10?)
	/data/zhangxiao/matrixone/pkg/vm/overload/run.go:55 +0xee
github.com/matrixorigin/matrixone/pkg/vm/pipeline2.(*Pipeline).MergeRun(0xc0db3c8f20, 0xc42160adc0)
	/data/zhangxiao/matrixone/pkg/vm/pipeline2/pipeline.go:130 +0x1af
github.com/matrixorigin/matrixone/pkg/sql/compile2.(*Scope).MergeRun(0xc2691512c0, {0x322c400?, 0xc000010028})
	/data/zhangxiao/matrixone/pkg/sql/compile2/scope.go:306 +0x574
github.com/matrixorigin/matrixone/pkg/sql/compile2.(*Scope).MergeRun.func2(0x13?)
	/data/zhangxiao/matrixone/pkg/sql/compile2/scope.go:285 +0x79
created by github.com/matrixorigin/matrixone/pkg/sql/compile2.(*Scope).MergeRun
	/data/zhangxiao/matrixone/pkg/sql/compile2/scope.go:280 +0x2b8


select * from t1 join t2 on t1.decimald=t2.decimald order by 1 asc, 2 desc;

[EXPECT RESULT]:
decimald	value32	decimald	value32
9.22340	2	9.2234	4
[ACTUAL RESULT]:
decimald	value32	decimald	value32

select * from t1 join t2 on t1.decimald=t2.decimald where t1.decimald!=0;

[EXPECT RESULT]:
decimald	value32	decimald	value32
9.22340	2	9.2234	4
[ACTUAL RESULT]:
decimald	value32	decimald	value32

select * from t1 join t2 on t1.decimald=t2.decimald order by 1,2 desc;

[EXPECT RESULT]:
decimald	value32	decimald	value32
9.22340	2	9.2234	4
[ACTUAL RESULT]:
decimald	value32	decimald	value32

select * from t1;

[EXPECT RESULT]:
decimal20
0.000000000000000000
0.000000000000000001
[ACTUAL RESULT]:
decimal20
0
1E-18

select * from t1 where decimal_col=-17666000000000000000 order by 1 asc;

[EXPECT RESULT]:
decimal_col
-17666000000000000000
[ACTUAL RESULT]:
decimal_col

select * from t1 where decimal_col='-17666000000000000000' order by decimal_col desc;

[EXPECT RESULT]:
decimal_col
-17666000000000000000
[ACTUAL RESULT]:
unknown error:[42883]undefined function =[DECIMAL128 VARCHAR]

select cast(10000002383263201056 as decimal) mod 50 as result;

[EXPECT RESULT]:
result
49
[ACTUAL RESULT]:
unknown error:[42883]undefined function %[DECIMAL64 BIGINT]

select cast(cast(19999999999999999999 as decimal) as unsigned);

[EXPECT RESULT]:
cast(cast(19999999999999999999 as decimal) as unsigned)
9999999999
[ACTUAL RESULT]:
syntax error at position 38 near '19999999999999999999'; You have an error in your SQL syntax; check the manual that corresponds to your MatrixOne server version for the right syntax to use

INSERT INTO t1 (id,a) VALUES
(1,0),
(2,CAST(0x7FFFFFFFFFFFFFFF AS UNSIGNED)),
(3,CAST(0x8000000000000000 AS UNSIGNED)),
(4,CAST(0xFFFFFFFFFFFFFFFF AS UNSIGNED));

[EXPECT RESULT]:

[ACTUAL RESULT]:
unknown error:[42611]Field 'b' doesn't have a default value

SELECT id, id >= 1.1 FROM t_decimal;

[EXPECT RESULT]:
id	id >= 1.1
1.00000	false	
2.00000	true	
1.10000	true	
2.20000	true
[ACTUAL RESULT]:
unknown error:[42883]undefined function >=[DECIMAL64 DOUBLE]

SELECT id, 1.1 <= id FROM t_decimal;

[EXPECT RESULT]:
id	1.1 <= id
1.00000	false	
2.00000	true	
1.10000	true	
2.20000	true
[ACTUAL RESULT]:
unknown error:[42883]undefined function <=[DOUBLE DECIMAL64]

SELECT id, id = 1.1 FROM t_decimal;

[EXPECT RESULT]:
id	id = 1.1
1.00000	false	
2.00000	false	
1.10000	true	
2.20000	false
[ACTUAL RESULT]:
unknown error:[42883]undefined function =[DECIMAL64 DOUBLE]

SELECT id, 1.1 = id FROM t_decimal;

[EXPECT RESULT]:
id	1.1 = id
1.00000	false	
2.00000	false	
1.10000	true	
2.20000	false
[ACTUAL RESULT]:
unknown error:[42883]undefined function =[DOUBLE DECIMAL64]

SELECT * from t_decimal WHERE id = 1.1;

[EXPECT RESULT]:
id
1.10000
[ACTUAL RESULT]:
unknown error:[42883]undefined function =[DECIMAL64 DOUBLE]

SELECT * from t_decimal WHERE id = 1.1e0;

[EXPECT RESULT]:
id
1.10000
[ACTUAL RESULT]:
unknown error:[42883]undefined function =[DECIMAL64 DOUBLE]

SELECT * from t_decimal WHERE id = '1.1';

[EXPECT RESULT]:
id
1.10000
[ACTUAL RESULT]:
unknown error:[42883]undefined function =[DECIMAL64 VARCHAR]

SELECT * from t_decimal WHERE id = '1.1e0';

[EXPECT RESULT]:
id
1.10000
[ACTUAL RESULT]:
unknown error:[42883]undefined function =[DECIMAL64 VARCHAR]

SELECT * from t_decimal WHERE id IN (1.1, 2.2);

[EXPECT RESULT]:
id
1.10000
2.20000
[ACTUAL RESULT]:
unknown error:[42883]undefined function =[DECIMAL64 DOUBLE]

SELECT * from t_decimal WHERE id IN (1.1e0, 2.2e0);

[EXPECT RESULT]:
id
1.10000
2.20000
[ACTUAL RESULT]:
unknown error:[42883]undefined function =[DECIMAL64 DOUBLE]

SELECT * from t_decimal WHERE id IN ('1.1', '2.2');

[EXPECT RESULT]:
id
1.10000
2.20000
[ACTUAL RESULT]:
unknown error:[42883]undefined function =[DECIMAL64 VARCHAR]

SELECT * from t_decimal WHERE id IN ('1.1e0', '2.2e0');

[EXPECT RESULT]:
id
1.10000
2.20000
[ACTUAL RESULT]:
unknown error:[42883]undefined function =[DECIMAL64 VARCHAR]

SELECT * from t_decimal WHERE id BETWEEN 1.1 AND 1.9;

[EXPECT RESULT]:
id
1.10000
[ACTUAL RESULT]:
unknown error:[42883]undefined function >=[DECIMAL64 DOUBLE]

SELECT * from t_decimal WHERE id BETWEEN 1.1e0 AND 1.9e0;

[EXPECT RESULT]:
id
1.10000
[ACTUAL RESULT]:
unknown error:[42883]undefined function >=[DECIMAL64 DOUBLE]

SELECT * from t_decimal WHERE id BETWEEN '1.1' AND '1.9';

[EXPECT RESULT]:
id
1.10000
[ACTUAL RESULT]:
unknown error:[42883]undefined function >=[DECIMAL64 VARCHAR]

SELECT * from t_decimal WHERE id BETWEEN '1.1e0' AND '1.9e0';

[EXPECT RESULT]:
id
1.10000
[ACTUAL RESULT]:
unknown error:[42883]undefined function >=[DECIMAL64 VARCHAR]

SELECT * FROM t1 WHERE coalesce(a) BETWEEN 0 and 0.9;

[EXPECT RESULT]:
a
0.9
0.9
[ACTUAL RESULT]:
unknown error:[42883]function 'coalesce' doesn't register, get id failed

SELECT * FROM t1 WHERE coalesce(a)=0.9;

[EXPECT RESULT]:
a
0.9
0.9
[ACTUAL RESULT]:
unknown error:[42883]function 'coalesce' doesn't register, get id failed

SELECT * FROM t1 WHERE coalesce(a) in (0.8,0.9);

[EXPECT RESULT]:
a
0.9
0.9
[ACTUAL RESULT]:
unknown error:[42883]function 'coalesce' doesn't register, get id failed

SELECT * FROM t1 WHERE a BETWEEN 0 AND 0.9;

[EXPECT RESULT]:
a
0.9
0.9
[ACTUAL RESULT]:
unknown error:[42883]undefined function <=[DECIMAL64 DOUBLE]

SELECT * FROM t1 WHERE a=0.9;

[EXPECT RESULT]:
a
0.9
0.9
[ACTUAL RESULT]:
unknown error:[42883]undefined function =[DECIMAL64 DOUBLE]

SELECT * FROM t1 WHERE a IN (0.8,0.9);

[EXPECT RESULT]:
a
0.9
0.9
[ACTUAL RESULT]:
unknown error:[42883]undefined function =[DECIMAL64 DOUBLE]

select count(*) from t
where id>=88947549497796.3574 and id <=889475494977969.358;

[EXPECT RESULT]:
count(*)
3
[ACTUAL RESULT]:
unknown error:[42883]undefined function >=[DECIMAL128 DOUBLE]

select count(*) from t
where id between 88947549497796.3574 and 889475494977969.358;

[EXPECT RESULT]:
count(*)
3
[ACTUAL RESULT]:
unknown error:[42883]undefined function >=[DECIMAL128 DOUBLE]

SELECT CAST(1.00 AS decimal) BETWEEN 1 AND -1;

[EXPECT RESULT]:
CAST(1.00 AS decimal) BETWEEN 1 AND -1
false
[ACTUAL RESULT]:
unknown error:[42883]undefined function cast[DOUBLE DECIMAL64]

SELECT CAST(1.00 AS decimal) NOT BETWEEN 1 AND -1;

[EXPECT RESULT]:
CAST(1.00 AS decimal) NOT BETWEEN 1 AND -1
true
[ACTUAL RESULT]:
unknown error:[42883]undefined function cast[DOUBLE DECIMAL64]

SELECT CAST(-0 AS decimal) BETWEEN 0 AND -1;

[EXPECT RESULT]:
CAST(-0 AS decimal) BETWEEN 0 AND -1
false
[ACTUAL RESULT]:
unknown error:[42000]parameter types of cast function do not match

SELECT CAST(0 AS decimal) NOT BETWEEN 0 AND -1;

[EXPECT RESULT]:
CAST(0 AS decimal) NOT BETWEEN 0 AND -1
true
[ACTUAL RESULT]:
unknown error:[42000]parameter types of cast function do not match

insert into t1 (a) values (2),(4),(6),(8),(10),(12),(14),(16),(18),(20),(22),(24),(26),(23);

[EXPECT RESULT]:

[ACTUAL RESULT]:
unknown error:[42611]Field 'b' doesn't have a default value

insert into t1 (a) values (2.1111),(4),(00006.12311),(8.41231),(24.0000);

[EXPECT RESULT]:

[ACTUAL RESULT]:
unknown error:[42611]Field 'b' doesn't have a default value

]]></failure>
    </testcase>
    <testcase name="cases/dtype/double.test" time="1.487">
        <failure type="0002" message="The actual result is not in accordance with the expectation.More,See the detail."><![CDATA[select -1.7976931348623157E+308,-2.2250738585072014E-308,0,2.2250738585072014E-308,1.7976931348623157E+308;

[EXPECT RESULT]:
-1.7976931348623157E+308	-2.2250738585072014E-308	0	2.2250738585072014E-308	1.7976931348623157E+308
-1.7976931348623157e308	-2.2250738585072014e-308	0	2.2250738585072014e-308	1.7976931348623157e308
[ACTUAL RESULT]:
-1.7976931348623157e+308	-2.2250738585072014e-308	0	2.2250738585072014e-308	1.7976931348623157e+308
-1.7976931348623157E308	-0.0	0	0.0	1.7976931348623157E308

select 1.7976931348623158E+308,-2.2250738585072015E-308,2.2250738585072015E-308,1.7976931348623158E+308;

[EXPECT RESULT]:
1.7976931348623158E+308	-2.2250738585072015E-308	2.2250738585072015E-308	1.7976931348623158E+308
1.7976931348623157e308	-2.2250738585072014e-308	2.2250738585072014e-308	1.7976931348623157e308
[ACTUAL RESULT]:
1.7976931348623158e+308	-2.2250738585072015e-308	2.2250738585072015e-308	1.7976931348623158e+308
1.7976931348623157E308	-0.0	0.0	1.7976931348623157E308

select 1.7976931348623158E+308*1,-2.2250738585072015E-308+1.2250738585072015E-308;

[EXPECT RESULT]:
1.7976931348623158E+308*1	-2.2250738585072015E-308+1.2250738585072015E-308
1.7976931348623157e308	-1e-308
[ACTUAL RESULT]:
1.7976931348623158e+308 * 1	-2.2250738585072015e-308 + 1.2250738585072015e-308
1.7976931348623157E308	-0.0

select * from t1;

[EXPECT RESULT]:
a
-1.7976931348623157e308
-2.2250738585072014e-308
0
2.2250738585072014e-308
1.7976931348623157e308
[ACTUAL RESULT]:
a
-1.7976931348623157E308
-0.0
0.0
0.0
1.7976931348623157E308

select * from t1;

[EXPECT RESULT]:
a
-1.797693134862315700000000000000
2.225073858507201400000000000000
0.000000000000000000000000000000
2.225073858507201400000000000000
1.797693134862315700000000000000
[ACTUAL RESULT]:
a
-1.7977
2.2251
0.0
2.2251
1.7977

select * from t1;

[EXPECT RESULT]:
a
-1.79769
2.22507
0.00000
2.22507
1.79769
[ACTUAL RESULT]:
a
-1.7977
2.2251
0.0
2.2251
1.7977

show create table t1;

[EXPECT RESULT]:
Table	Create Table
t1	CREATE TABLE `t1` (
  `a` double DEFAULT NULL
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_0900_ai_ci
[ACTUAL RESULT]:
unknown error:[42000]query 'ddl:<ddl_type:SHOW_CREATETABLE query:<stmt_type:SELECT steps:3 nodes:<node_type:TABLE_SCAN project_list:<typ:<id:VARCHAR width:100 > table_name:"mt" col_name:"relname" col:<> > project_list:<typ:<id:VARCHAR width:100 > table_name:"mt" col_name:"reldatabase" col:<col_pos:1 > > project_list:<typ:<id:CHAR width:8 > table_name:"mt" col_name:"relpersistence" col:<col_pos:2 > > project_list:<typ:<id:CHAR width:8 > table_name:"mt" col_name:"relkind" col:<col_pos:3 > > project_list:<typ:<id:VARCHAR width:100 > table_name:"mt" col_name:"rel_comment" col:<col_pos:4 > > project_list:<typ:<id:VARCHAR width:100 > table_name:"mt" col_name:"rel_createsql" col:<col_pos:5 > > table_def:<name:"mo_tables" alias:"mt" cols:<name:"relname" alias:"relname" typ:<id:VARCHAR width:100 > primary:true > cols:<name:"reldatabase" alias:"reldatabase" typ:<id:VARCHAR width:100 > > cols:<name:"relpersistence" alias:"relpersistence" typ:<id:CHAR width:8 > > cols:<name:"relkind" alias:"relkind" typ:<id:CHAR width:8 > > cols:<name:"rel_comment" alias:"rel_comment" typ:<id:VARCHAR width:100 > > cols:<name:"rel_createsql" alias:"rel_createsql" typ:<id:VARCHAR width:100 > > > obj_ref:<schema_name:"mo_catalog" obj_name:"mo_tables" > > nodes:<node_type:TABLE_SCAN node_id:1 project_list:<typ:<id:VARCHAR width:100 > table_name:"mc" col_name:"att_database" col:<> > project_list:<typ:<id:VARCHAR width:100 > table_name:"mc" col_name:"att_relname" col:<col_pos:1 > > project_list:<typ:<id:VARCHAR width:100 > table_name:"mc" col_name:"attname" col:<col_pos:2 > > project_list:<typ:<id:INT32 width:32 > table_name:"mc" col_name:"atttyp" col:<col_pos:3 > > project_list:<typ:<id:INT32 width:32 > table_name:"mc" col_name:"attnum" col:<col_pos:4 > > project_list:<typ:<id:INT32 width:32 > table_name:"mc" col_name:"att_length" col:<col_pos:5 > > project_list:<typ:<id:INT8 width:8 > table_name:"mc" col_name:"attnotnull" col:<col_pos:6 > > project_list:<typ:<id:INT8 width:8 > table_name:"mc" col_name:"atthasdef" col:<col_pos:7 > > project_list:<typ:<id:VARCHAR width:100 > table_name:"mc" col_name:"att_default" col:<col_pos:8 > > project_list:<typ:<id:INT8 width:8 > table_name:"mc" col_name:"attisdropped" col:<col_pos:9 > > project_list:<typ:<id:CHAR width:8 > table_name:"mc" col_name:"att_constraint_type" col:<col_pos:10 > > project_list:<typ:<id:INT8 width:8 > table_name:"mc" col_name:"att_is_unsigned" col:<col_pos:11 > > project_list:<typ:<id:INT8 width:8 > table_name:"mc" col_name:"att_is_auto_increment" col:<col_pos:12 > > project_list:<typ:<id:VARCHAR width:100 > table_name:"mc" col_name:"att_comment" col:<col_pos:13 > > project_list:<typ:<id:INT8 width:8 > table_name:"mc" col_name:"att_is_hidden" col:<col_pos:14 > > table_def:<name:"mo_columns" alias:"mc" cols:<name:"att_database" alias:"att_database" typ:<id:VARCHAR width:100 > > cols:<name:"att_relname" alias:"att_relname" typ:<id:VARCHAR width:100 > > cols:<name:"attname" alias:"attname" typ:<id:VARCHAR width:100 > primary:true > cols:<name:"atttyp" alias:"atttyp" typ:<id:INT32 width:32 > > cols:<name:"attnum" alias:"attnum" typ:<id:INT32 width:32 > > cols:<name:"att_length" alias:"att_length" typ:<id:INT32 width:32 > > cols:<name:"attnotnull" alias:"attnotnull" typ:<id:INT8 width:8 > > cols:<name:"atthasdef" alias:"atthasdef" typ:<id:INT8 width:8 > > cols:<name:"att_default" alias:"att_default" typ:<id:VARCHAR width:100 > > cols:<name:"attisdropped" alias:"attisdropped" typ:<id:INT8 width:8 > > cols:<name:"att_constraint_type" alias:"att_constraint_type" typ:<id:CHAR width:8 > > cols:<name:"att_is_unsigned" alias:"att_is_unsigned" typ:<id:INT8 width:8 > > cols:<name:"att_is_auto_increment" alias:"att_is_auto_increment" typ:<id:INT8 width:8 > > cols:<name:"att_comment" alias:"att_comment" typ:<id:VARCHAR width:100 > > cols:<name:"att_is_hidden" alias:"att_is_hidden" typ:<id:INT8 width:8 > > > obj_ref:<schema_name:"mo_catalog" obj_name:"mo_columns" > > nodes:<node_type:JOIN node_id:2 project_list:<typ:<id:VARCHAR width:100 > table_name:"mt" col_name:"relname" col:<> > project_list:<typ:<id:VARCHAR width:100 > table_name:"mt" col_name:"reldatabase" col:<col_pos:1 > > project_list:<typ:<id:CHAR width:8 > table_name:"mt" col_name:"relpersistence" col:<col_pos:2 > > project_list:<typ:<id:CHAR width:8 > table_name:"mt" col_name:"relkind" col:<col_pos:3 > > project_list:<typ:<id:VARCHAR width:100 > table_name:"mt" col_name:"rel_comment" col:<col_pos:4 > > project_list:<typ:<id:VARCHAR width:100 > table_name:"mt" col_name:"rel_createsql" col:<col_pos:5 > > project_list:<typ:<id:VARCHAR width:100 > table_name:"mc" col_name:"att_database" col:<rel_pos:1 > > project_list:<typ:<id:VARCHAR width:100 > table_name:"mc" col_name:"att_relname" col:<rel_pos:1 col_pos:1 > > project_list:<typ:<id:VARCHAR width:100 > table_name:"mc" col_name:"attname" col:<rel_pos:1 col_pos:2 > > project_list:<typ:<id:INT32 width:32 > table_name:"mc" col_name:"atttyp" col:<rel_pos:1 col_pos:3 > > project_list:<typ:<id:INT32 width:32 > table_name:"mc" col_name:"attnum" col:<rel_pos:1 col_pos:4 > > project_list:<typ:<id:INT32 width:32 > table_name:"mc" col_name:"att_length" col:<rel_pos:1 col_pos:5 > > project_list:<typ:<id:INT8 width:8 > table_name:"mc" col_name:"attnotnull" col:<rel_pos:1 col_pos:6 > > project_list:<typ:<id:INT8 width:8 > table_name:"mc" col_name:"atthasdef" col:<rel_pos:1 col_pos:7 > > project_list:<typ:<id:VARCHAR width:100 > table_name:"mc" col_name:"att_default" col:<rel_pos:1 col_pos:8 > > project_list:<typ:<id:INT8 width:8 > table_name:"mc" col_name:"attisdropped" col:<rel_pos:1 col_pos:9 > > project_list:<typ:<id:CHAR width:8 > table_name:"mc" col_name:"att_constraint_type" col:<rel_pos:1 col_pos:10 > > project_list:<typ:<id:INT8 width:8 > table_name:"mc" col_name:"att_is_unsigned" col:<rel_pos:1 col_pos:11 > > project_list:<typ:<id:INT8 width:8 > table_name:"mc" col_name:"att_is_auto_increment" col:<rel_pos:1 col_pos:12 > > project_list:<typ:<id:VARCHAR width:100 > table_name:"mc" col_name:"att_comment" col:<rel_pos:1 col_pos:13 > > project_list:<typ:<id:INT8 width:8 > table_name:"mc" col_name:"att_is_hidden" col:<rel_pos:1 col_pos:14 > > children:0 children:1 on_list:<typ:<id:BOOL > col_name:"mt.relname = mc.att_relname" f:<func:<obj:12 obj_name:"=" > args:<typ:<id:VARCHAR width:100 > table_name:"mt" col_name:"relname" col:<> > args:<typ:<id:VARCHAR width:100 > table_name:"mc" col_name:"att_relname" col:<rel_pos:1 col_pos:1 > > > > > nodes:<node_type:PROJECT node_id:3 project_list:<typ:<id:VARCHAR width:100 > table_name:"mc" col_name:"att_database" col:<rel_pos:1 > > project_list:<typ:<id:VARCHAR width:100 > table_name:"mc" col_name:"att_relname" col:<rel_pos:1 col_pos:1 > > project_list:<typ:<id:VARCHAR width:100 > table_name:"mc" col_name:"attname" col:<rel_pos:1 col_pos:2 > > project_list:<typ:<id:INT32 width:32 > table_name:"mc" col_name:"atttyp" col:<rel_pos:1 col_pos:3 > > project_list:<typ:<id:INT32 width:32 > table_name:"mc" col_name:"attnum" col:<rel_pos:1 col_pos:4 > > project_list:<typ:<id:INT32 width:32 > table_name:"mc" col_name:"att_length" col:<rel_pos:1 col_pos:5 > > project_list:<typ:<id:INT8 width:8 > table_name:"mc" col_name:"attnotnull" col:<rel_pos:1 col_pos:6 > > project_list:<typ:<id:INT8 width:8 > table_name:"mc" col_name:"atthasdef" col:<rel_pos:1 col_pos:7 > > project_list:<typ:<id:VARCHAR width:100 > table_name:"mc" col_name:"att_default" col:<rel_pos:1 col_pos:8 > > project_list:<typ:<id:INT8 width:8 > table_name:"mc" col_name:"attisdropped" col:<rel_pos:1 col_pos:9 > > project_list:<typ:<id:CHAR width:8 > table_name:"mc" col_name:"att_constraint_type" col:<rel_pos:1 col_pos:10 > > project_list:<typ:<id:INT8 width:8 > table_name:"mc" col_name:"att_is_unsigned" col:<rel_pos:1 col_pos:11 > > project_list:<typ:<id:INT8 width:8 > table_name:"mc" col_name:"att_is_auto_increment" col:<rel_pos:1 col_pos:12 > > project_list:<typ:<id:VARCHAR width:100 > table_name:"mc" col_name:"att_comment" col:<rel_pos:1 col_pos:13 > > project_list:<typ:<id:INT8 width:8 > table_name:"mc" col_name:"att_is_hidden" col:<rel_pos:1 col_pos:14 > > children:2 where_list:<typ:<id:BOOL > col_name:"mt.reldatabase = double" f:<func:<obj:12 obj_name:"=" > args:<typ:<id:VARCHAR width:100 > table_name:"mt" col_name:"reldatabase" col:<col_pos:1 > > args:<typ:<id:VARCHAR width:2147483647 > col_name:"double" c:<sval:"double" > > > > where_list:<typ:<id:BOOL > col_name:"mt.relname = t1" f:<func:<obj:12 obj_name:"=" > args:<typ:<id:VARCHAR width:100 > table_name:"mt" col_name:"relname" col:<> > args:<typ:<id:VARCHAR width:2147483647 > col_name:"t1" c:<sval:"t1" > > > > > > > ' not support now

insert into t1 (big) values (-1),(12345678.901234567),(92233720368547.75807);

[EXPECT RESULT]:

[ACTUAL RESULT]:
unknown error:[42611]Field 'a' doesn't have a default value

select * from t1;

[EXPECT RESULT]:
a	big
1	-1.00000
1	12345678.90123
1	92233720368547.77000
[ACTUAL RESULT]:
a	big

select min(big),max(big),max(big)-1 from t1;

[EXPECT RESULT]:
min(big)	max(big)	max(big)-1
-1.00000	92233720368547.77000	92233720368546.77000
[ACTUAL RESULT]:
min(big)	max(big)	max(big) - 1
null	null	null

select min(big),max(big),max(big)-1 from t1 group by a;

[EXPECT RESULT]:
min(big)	max(big)	max(big)-1
-1.00000	92233720368547.77000	92233720368546.77000
[ACTUAL RESULT]:
min(big)	max(big)	max(big) - 1

insert into t1 (big) values (-1),(12345678.901234567),(92233720368547.75807);

[EXPECT RESULT]:

[ACTUAL RESULT]:
unknown error:[42611]Field 'a' doesn't have a default value

select * from t1;

[EXPECT RESULT]:
a	big
1	-1
1	12345678.901234567
1	92233720368547.77
[ACTUAL RESULT]:
a	big

select * from t1 order by big limit 1,2;

[EXPECT RESULT]:
a	big
1	12345678.901234567
1	92233720368547.77
[ACTUAL RESULT]:
a	big

select * from t1 order by big limit 2 offset 1;

[EXPECT RESULT]:
a	big
1	12345678.901234567
1	92233720368547.77
[ACTUAL RESULT]:
a	big

select min(big),max(big),max(big)-1 from t1;

[EXPECT RESULT]:
min(big)	max(big)	max(big)-1
-1	92233720368547.77	92233720368546.77
[ACTUAL RESULT]:
min(big)	max(big)	max(big) - 1
null	null	null

select min(big),max(big),max(big)+1 from t1 group by a;

[EXPECT RESULT]:
min(big)	max(big)	max(big)+1
-1	92233720368547.77	92233720368548.77
[ACTUAL RESULT]:
min(big)	max(big)	max(big) + 1

select * from t1;

[EXPECT RESULT]:
a	b
0.123456	1
1.23456	2
3	5
[ACTUAL RESULT]:
a	b
0.1235	1.0
1.2346	2.0
3.0	5.0

select * from t2;

[EXPECT RESULT]:
a	b
0.123456	3
12.3456	4
[ACTUAL RESULT]:
a	b
0.1235	3
12.3456	4

select * from t1 join t2 on t1.a=t2.a order by 1 asc, 2 desc;

[EXPECT RESULT]:
a	b	a	b
0.123456	1	0.123456	3
[ACTUAL RESULT]:
a	b	a	b
0.1235	1.0	0.1235	3

select * from t1 join t2 on t1.a=t2.a where t1.a>=0.123456;

[EXPECT RESULT]:
a	b	a	b
0.123456	1	0.123456	3
[ACTUAL RESULT]:
a	b	a	b
0.1235	1.0	0.1235	1

select * from t1 join t2 on t2.b=t1.a order by t1.a, t2.b asc;

[EXPECT RESULT]:
a	b	a	b
3	5	0.123456	3
[ACTUAL RESULT]:
a	b	a	b
3.0	5.0	0.1235	3

select * from t1 where a>='17.6660';

[EXPECT RESULT]:
a
17.666
CREATE TABLE t1 (id INT PRIMARY KEY,
a double(20),
b VARCHAR(20));
INSERT INTO t1 (id,a) VALUES
(1,0),
(2,CAST(0x7FFFFFFFFFFFFFFF AS UNSIGNED)),
(3,CAST(0x8000000000000000 AS UNSIGNED)),
(4,CAST(0xFFFFFFFFFFFFFFFF AS UNSIGNED));
select * from t1;
id	a	b
1	0	NULL
2	9223372036854776000	NULL
3	9223372036854776000	NULL
4	18446744073709552000	NULL
UPDATE t1 SET b = a;
select * from t1;
id	a	b
1	0	0
2	9223372036854776000	9.223372036854776e18
3	9223372036854776000	9.223372036854776e18
4	18446744073709552000	1.844674407370955e19
select a,count(a) from t1 where ((a = 9.223372036854776e18) and (b = '9.223372036854776e18')) group by a having count(a)>1 order by count(a);
a	count(a)
9223372036854776000	2
select distinct a,b from t1 where ((a = 1.844674407370955e19) and (b != '9.223372036854776e18')) order by 1;
a	b
CREATE TABLE t_double(id double(30,1));
INSERT INTO t_double VALUES (1.19),(1.11), (2);
SELECT id, id >= 1.1 FROM t_double;
id	id >= 1.1
1.2	true	
1.1	true	
2.0	true	
SELECT id, 1.1 <= id FROM t_double;
id	1.1 <= id
1.2	true	
1.1	true	
2.0	true	
SELECT id, id = 1.1 FROM t_double;
id	id = 1.1
1.2	false	
1.1	true	
2.0	false	
SELECT id, 1.1 = id FROM t_double;
id	1.1 = id
1.2	false	
1.1	true	
2.0	false	
SELECT * from t_double WHERE id = 1.1;
id
1.1
SELECT * from t_double WHERE id = 1.1e0;
id
1.1
SELECT * from t_double WHERE id = '1.1';
id
1.1
SELECT * from t_double WHERE id = '1.1e0';
id
1.1
SELECT * from t_double WHERE id IN (1.1, 2.2);
id
1.1
SELECT * from t_double WHERE id IN (1.1e0, 2.2e0);
id
1.1
SELECT * from t_double WHERE id IN ('1.1', '2.2');
id
1.1
SELECT * from t_double WHERE id IN ('1.1e0', '2.2e0');
id
1.1
SELECT * from t_double WHERE id BETWEEN 1.1 AND 1.9;
id
1.2
1.1
SELECT * from t_double WHERE id BETWEEN 1.1e0 AND 1.9e0;
id
1.2
1.1
SELECT * from t_double WHERE id BETWEEN '1.1' AND '1.9';
id
1.2
1.1
SELECT * from t_double WHERE id BETWEEN '1.1e0' AND '1.9e0';
id
1.2
1.1
[ACTUAL RESULT]:
unknown error:[42883]undefined function >=[DOUBLE VARCHAR]

INSERT INTO t1 (id,a) VALUES
(1,0),
(2,CAST(0x7FFFFFFFFFFFFFFF AS UNSIGNED)),
(3,CAST(0x8000000000000000 AS UNSIGNED)),
(4,CAST(0xFFFFFFFFFFFFFFFF AS UNSIGNED));

[EXPECT RESULT]:

[ACTUAL RESULT]:
unknown error:[42611]Field 'b' doesn't have a default value

select * from t1;

[EXPECT RESULT]:

[ACTUAL RESULT]:
id	a	b

SELECT id, id >= 1.1 FROM t_double;

[EXPECT RESULT]:

[ACTUAL RESULT]:
id	id >= 1.1
1.19	true
1.11	true
2.0	true

SELECT id, 1.1 <= id FROM t_double;

[EXPECT RESULT]:

[ACTUAL RESULT]:
id	1.1 <= id
1.19	true
1.11	true
2.0	true

SELECT id, id = 1.1 FROM t_double;

[EXPECT RESULT]:

[ACTUAL RESULT]:
id	id = 1.1
1.19	false
1.11	false
2.0	false

SELECT id, 1.1 = id FROM t_double;

[EXPECT RESULT]:

[ACTUAL RESULT]:
id	1.1 = id
1.19	false
1.11	false
2.0	false

SELECT * from t_double WHERE id = 1.1;

[EXPECT RESULT]:

[ACTUAL RESULT]:
id

SELECT * from t_double WHERE id = 1.1e0;

[EXPECT RESULT]:

[ACTUAL RESULT]:
id

SELECT * from t_double WHERE id = '1.1';

[EXPECT RESULT]:

[ACTUAL RESULT]:
unknown error:[42883]undefined function =[DOUBLE VARCHAR]

SELECT * from t_double WHERE id = '1.1e0';

[EXPECT RESULT]:

[ACTUAL RESULT]:
unknown error:[42883]undefined function =[DOUBLE VARCHAR]

SELECT * from t_double WHERE id IN (1.1, 2.2);

[EXPECT RESULT]:

[ACTUAL RESULT]:
id

SELECT * from t_double WHERE id IN (1.1e0, 2.2e0);

[EXPECT RESULT]:

[ACTUAL RESULT]:
id

SELECT * from t_double WHERE id IN ('1.1', '2.2');

[EXPECT RESULT]:

[ACTUAL RESULT]:
unknown error:[42883]undefined function =[DOUBLE VARCHAR]

SELECT * from t_double WHERE id IN ('1.1e0', '2.2e0');

[EXPECT RESULT]:

[ACTUAL RESULT]:
unknown error:[42883]undefined function =[DOUBLE VARCHAR]

SELECT * from t_double WHERE id BETWEEN 1.1 AND 1.9;

[EXPECT RESULT]:

[ACTUAL RESULT]:
id
1.19
1.11

SELECT * from t_double WHERE id BETWEEN 1.1e0 AND 1.9e0;

[EXPECT RESULT]:

[ACTUAL RESULT]:
id
1.19
1.11

SELECT * from t_double WHERE id BETWEEN '1.1' AND '1.9';

[EXPECT RESULT]:

[ACTUAL RESULT]:
unknown error:[42883]undefined function >=[DOUBLE VARCHAR]

SELECT * from t_double WHERE id BETWEEN '1.1e0' AND '1.9e0';

[EXPECT RESULT]:

[ACTUAL RESULT]:
unknown error:[42883]undefined function >=[DOUBLE VARCHAR]

SELECT * FROM t1 WHERE coalesce(a) BETWEEN 0 and 0.9;

[EXPECT RESULT]:

[ACTUAL RESULT]:
unknown error:[42883]function 'coalesce' doesn't register, get id failed

SELECT * FROM t1 WHERE a=0.9;

[EXPECT RESULT]:

[ACTUAL RESULT]:
a

SELECT * FROM t1 WHERE a in (0.8,0.9);

[EXPECT RESULT]:

[ACTUAL RESULT]:
a
0.8

SELECT * FROM t1 WHERE a BETWEEN 0 AND 0.9;

[EXPECT RESULT]:

[ACTUAL RESULT]:
a
0.8999
0.8

select count(*) from t1
where id>=5.3111 and id <=177.171 order by 1;

[EXPECT RESULT]:

[ACTUAL RESULT]:
unknown error:[42P10]column 'id' does not exist

select count(*) from t1
where id between 5.3111 and 177.171;

[EXPECT RESULT]:

[ACTUAL RESULT]:
count(id)
1

insert into t1 (a) values (2),(4),(6),(8),(10),(12),(14),(16),(18),(20),(22),(24),(26),(23);

[EXPECT RESULT]:

[ACTUAL RESULT]:
unknown error:[42611]Field 'b' doesn't have a default value

insert into t1 (b) values ('apple'), ('apple');

[EXPECT RESULT]:

[ACTUAL RESULT]:
unknown error:[42611]Field 'a' doesn't have a default value

select * from t1;

[EXPECT RESULT]:

[ACTUAL RESULT]:
a	b

insert into t1 (a) values (2.1111),(4),(00006.12311),(8.41231),(24.0000);

[EXPECT RESULT]:

[ACTUAL RESULT]:
unknown error:[42611]Field 'b' doesn't have a default value

insert into t1 (b) values ('apple'), ('apple');

[EXPECT RESULT]:

[ACTUAL RESULT]:
unknown error:[42611]Field 'a' doesn't have a default value

select * from t1;

[EXPECT RESULT]:

[ACTUAL RESULT]:
a	b

]]></failure>
    </testcase>
    <testcase name="cases/dtype/float.test" time="1.67">
        <failure type="0002" message="The actual result is not in accordance with the expectation.More,See the detail."><![CDATA[select -3.402823466E+38,-3.402823467E+38,-1.175494351E-38,-1.175494352E-38;

[EXPECT RESULT]:
-3.402823466E+38	-3.402823467E+38	-1.175494351E-38	-1.175494352E-38
-3.402823466e38	-3.402823467e38	-1.175494351e-38	-1.175494352e-38
[ACTUAL RESULT]:
-3.402823466e+38	-3.402823467e+38	-1.175494351e-38	-1.175494352e-38
-3.402823466E38	-3.402823467E38	-0.0	-0.0

select 1.175494351E-38,1.175494352E-38,3.402823467E+38,3.402823467E+38;

[EXPECT RESULT]:
1.175494351E-38	1.175494352E-38	3.402823467E+38	3.402823467E+38
1.175494351e-38	1.175494352e-38	3.402823467e38	3.402823467e38
[ACTUAL RESULT]:
1.175494351e-38	1.175494352e-38	3.402823467e+38	3.402823467e+38
0.0	0.0	3.402823467E38	3.402823467E38

select -3.402823466E+38*1,-1.175494351E-38-0.1E-38;

[EXPECT RESULT]:
-3.402823466E+38*1	-1.175494351E-38-0.1E-38
-3.402823466e38	-1.275494351e-38
[ACTUAL RESULT]:
-3.402823466e+38 * 1	-1.175494351e-38 - 0.1e-38
-3.402823466E38	-0.0

select * from t1 order by 1;

[EXPECT RESULT]:
a
-3.40282e38
-1.17549e-38
0
1.17549e-38
3.40282e38
[ACTUAL RESULT]:
unknown error:Internal error: panic runtime error: index out of range [1] with length 1: goroutine 496270 [running]:
runtime/debug.Stack()
	/usr/lib/golang/src/runtime/debug/stack.go:24 +0x65
github.com/matrixorigin/matrixone/pkg/common/moerr.NewPanicError({0x2d6da80?, 0xc0bc9d3e30})
	/data/zhangxiao/matrixone/pkg/common/moerr/error.go:77 +0x53
github.com/matrixorigin/matrixone/pkg/vm/overload.Run.func1()
	/data/zhangxiao/matrixone/pkg/vm/overload/run.go:50 +0x31
panic({0x2d6da80, 0xc0bc9d3e30})
	/usr/lib/golang/src/runtime/panic.go:838 +0x207
github.com/matrixorigin/matrixone/pkg/sort/asc/int64s.insertionSort(...)
	/data/zhangxiao/matrixone/pkg/sort/asc/int64s/sort.go:60
github.com/matrixorigin/matrixone/pkg/sort/asc/int64s.quickSort({0xc0b98132b0?, 0x1, 0x1}, {0xc087fa1c20?, 0x5, 0x5}, 0x1c831?, 0x0?, 0xc0da362b80?)
	/data/zhangxiao/matrixone/pkg/sort/asc/int64s/sort.go:53 +0x27b
github.com/matrixorigin/matrixone/pkg/sort/asc/int64s.Sort({0xc0b98132b0?, 0x7f67788815b8?, 0x30?}, {0xc087fa1c20?, 0xc087fa1c20?, 0x0?})
	/data/zhangxiao/matrixone/pkg/sort/asc/int64s/sort.go:14 +0x45
github.com/matrixorigin/matrixone/pkg/sort.Sort(0xb0?, {0xc087fa1c20?, 0xc0470773b0?, 0xc4d2ea8460?}, 0x3249a20?)
	/data/zhangxiao/matrixone/pkg/sort/sort.go:89 +0x2e8
github.com/matrixorigin/matrixone/pkg/sql/colexec2/order.(*Container).process(0xc05fa1b3b0, 0xc0f09b67c8?, 0xc0470773b0, 0xc373d08bb0)
	/data/zhangxiao/matrixone/pkg/sql/colexec2/order/order.go:98 +0x154
github.com/matrixorigin/matrixone/pkg/sql/colexec2/order.Call(0xc373d08bb0?, {0x2aaf860?, 0xc3fcb7f540?})
	/data/zhangxiao/matrixone/pkg/sql/colexec2/order/order.go:62 +0x53
github.com/matrixorigin/matrixone/pkg/vm/overload.Run({0xc2a75545a0?, 0x3, 0x1?}, 0x1?)
	/data/zhangxiao/matrixone/pkg/vm/overload/run.go:55 +0xee
github.com/matrixorigin/matrixone/pkg/vm/pipeline2.(*Pipeline).Run(0xc0da362f20, {0x3210e40, 0xc0b9ca0540}, 0xc373d08bb0)
	/data/zhangxiao/matrixone/pkg/vm/pipeline2/pipeline.go:75 +0x22d
github.com/matrixorigin/matrixone/pkg/sql/compile2.(*Scope).Run(0xc0a27d9860?, {0x322c400?, 0xc000010028?})
	/data/zhangxiao/matrixone/pkg/sql/compile2/scope.go:259 +0xc5
github.com/matrixorigin/matrixone/pkg/sql/compile2.(*Scope).MergeRun.func1(0x1d?)
	/data/zhangxiao/matrixone/pkg/sql/compile2/scope.go:277 +0x79
created by github.com/matrixorigin/matrixone/pkg/sql/compile2.(*Scope).MergeRun
	/data/zhangxiao/matrixone/pkg/sql/compile2/scope.go:272 +0x1ad


select * from t1;

[EXPECT RESULT]:
a
-3.4028234481811523000000
-1.1754943132400513000000
0.0000000000000000000000
1.1754943132400513000000
3.4028234481811523000000
[ACTUAL RESULT]:
a
-3.4028
-1.1755
0.0
1.1755
3.4028

select * from t1;

[EXPECT RESULT]:
a
-3.40282
-1.17549
0
1.17549
3.40282
[ACTUAL RESULT]:
a
-3.4028
-1.1755
0.0
1.1755
3.4028

insert into t1 (big) values (-1),(12345678.901234567),(92233720368547.75807);

[EXPECT RESULT]:

[ACTUAL RESULT]:
unknown error:[42611]Field 'a' doesn't have a default value

select * from t1;

[EXPECT RESULT]:
a	big
1	-1.00000
1	12345679.00000
1	92233718038528.00000
[ACTUAL RESULT]:
a	big

select min(big),max(big),max(big)-1 from t1;

[EXPECT RESULT]:
min(big)	max(big)	max(big)-1
-1.00000	92233718038528.00000	92233718038527.00000
[ACTUAL RESULT]:
min(big)	max(big)	max(big) - 1
null	null	null

select min(big),max(big),max(big)-1 from t1 group by a;

[EXPECT RESULT]:
min(big)	max(big)	max(big)-1
-1.00000	92233718038528.00000	92233718038527.00000
[ACTUAL RESULT]:
min(big)	max(big)	max(big) - 1

insert into t1 (big) values (-1),(12345678.901234567),(92233720368547.75807);

[EXPECT RESULT]:

[ACTUAL RESULT]:
unknown error:[42611]Field 'a' doesn't have a default value

select * from t1;

[EXPECT RESULT]:
a	big
1	-1
1	12345700
1	92233700000000
[ACTUAL RESULT]:
a	big

select * from t1 order by big limit 1,2;

[EXPECT RESULT]:
a	big
1	12345700
1	92233700000000
[ACTUAL RESULT]:
a	big

select * from t1 order by big limit 2 offset 1;

[EXPECT RESULT]:
a	big
1	12345700
1	92233700000000
[ACTUAL RESULT]:
a	big

select min(big),max(big),max(big)-1 from t1;

[EXPECT RESULT]:
min(big)	max(big)	max(big)-1
-1	92233700000000	92233718038527
[ACTUAL RESULT]:
min(big)	max(big)	max(big) - 1
null	null	null

select min(big),max(big),max(big)-1 from t1 group by a;

[EXPECT RESULT]:
min(big)	max(big)	max(big)-1
-1	92233700000000	92233718038527
[ACTUAL RESULT]:
min(big)	max(big)	max(big) - 1

select * from t1;

[EXPECT RESULT]:
a	b
0.123456	1
1.23456	2
3	5
[ACTUAL RESULT]:
a	b
0.1235	1.0
1.2346	2.0
3.0	5.0

select * from t2;

[EXPECT RESULT]:
a	b
0.123456	3
12.3456	4
[ACTUAL RESULT]:
a	b
0.1235	3
12.3456	4

select * from t1 join t2 on t1.a=t2.a order by t1.a asc, t2.b desc;

[EXPECT RESULT]:
a	b	a	b
0.123456	1	0.123456	3
[ACTUAL RESULT]:
a	b	a	b
0.1235	1.0	0.1235	3

select * from t1 join t2 on t1.a=t2.a where t1.a>=0.123456;

[EXPECT RESULT]:
a	b	a	b
0.123456	1	0.123456	3
[ACTUAL RESULT]:
a	b	a	b
0.1235	1.0	0.1235	1

select * from t1 join t2 on t2.b=t1.a order by 1,2 desc;

[EXPECT RESULT]:
a	b	a	b
3	5	0.123456	3
[ACTUAL RESULT]:
a	b	a	b
3.0	5.0	0.1235	3

select * from t1 where a>='17.6660';

[EXPECT RESULT]:
a
17.666
[ACTUAL RESULT]:
unknown error:[42883]undefined function >=[FLOAT VARCHAR]

select a  mod 50 as result from t1;

[EXPECT RESULT]:
result
17.666000366210938
[ACTUAL RESULT]:
result
0.0

select cast(a as unsigned) mod 50 as result from t1;

[EXPECT RESULT]:
result
18
[ACTUAL RESULT]:
result
0.0

select cast(a+a as signed) from t1;

[EXPECT RESULT]:
cast(a+a as signed)
35
[ACTUAL RESULT]:
cast(a + a as signed)
35

select cast(0-a as signed) from t1;

[EXPECT RESULT]:
cast(0-a as signed)
-18
[ACTUAL RESULT]:
cast(0 - a as signed)
-17

INSERT INTO t1 (id,a) VALUES
(1,0),
(2,CAST(0x7FFFFFFFFFFFFFFF AS UNSIGNED)),
(3,CAST(0x8000000000000000 AS UNSIGNED)),
(4,CAST(0xFFFFFFFFFFFFFFFF AS UNSIGNED));

[EXPECT RESULT]:

[ACTUAL RESULT]:
unknown error:[42611]Field 'b' doesn't have a default value

select * from t1;

[EXPECT RESULT]:
id	a	b
1	0	NULL
2	9.22337e18	NULL
3	9.22337e18	NULL
4	1.84467e19	NULL
[ACTUAL RESULT]:
id	a	b

SELECT id, id >= 1.1 FROM t_float;

[EXPECT RESULT]:
id	id >= 1.1
1.0	false	
1.1	true	
2.0	true
[ACTUAL RESULT]:
id	id >= 1.1
1.0	false
1.1	true
2.0	true

SELECT id, 1.1 <= id FROM t_float;

[EXPECT RESULT]:
id	1.1 <= id
1.0	false	
1.1	true	
2.0	true
[ACTUAL RESULT]:
id	1.1 <= id
1.0	false
1.1	true
2.0	true

SELECT id, id = 1.1 FROM t_float;

[EXPECT RESULT]:
id	id = 1.1
1.0	false	
1.1	true	
2.0	false
[ACTUAL RESULT]:
id	id = 1.1
1.0	false
1.1	false
2.0	false

SELECT id, 1.1 = id FROM t_float;

[EXPECT RESULT]:
id	1.1 = id
1.0	false	
1.1	true	
2.0	false
[ACTUAL RESULT]:
id	1.1 = id
1.0	false
1.1	false
2.0	false

SELECT * from t_float WHERE id = 1.1;

[EXPECT RESULT]:
id
1.1
[ACTUAL RESULT]:
id

SELECT * from t_float WHERE id = 1.1e0;

[EXPECT RESULT]:
id
1.1
[ACTUAL RESULT]:
id

SELECT * from t_float WHERE id = '1.1';

[EXPECT RESULT]:
id
1.1
[ACTUAL RESULT]:
unknown error:[42883]undefined function =[FLOAT VARCHAR]

SELECT * from t_float WHERE id = '1.1e0';

[EXPECT RESULT]:
id
1.1
[ACTUAL RESULT]:
unknown error:[42883]undefined function =[FLOAT VARCHAR]

SELECT * from t_float WHERE id IN ('1.1', '2.2');

[EXPECT RESULT]:
id
[ACTUAL RESULT]:
unknown error:[42883]undefined function =[FLOAT VARCHAR]

SELECT * from t_float WHERE id IN ('1.1e0', '2.2e0');

[EXPECT RESULT]:
id
[ACTUAL RESULT]:
unknown error:[42883]undefined function =[FLOAT VARCHAR]

SELECT * from t_float WHERE id BETWEEN '1.1' AND '1.9';

[EXPECT RESULT]:
id
1.1
[ACTUAL RESULT]:
unknown error:[42883]undefined function >=[FLOAT VARCHAR]

SELECT * from t_float WHERE id BETWEEN '1.1e0' AND '1.9e0';

[EXPECT RESULT]:
id
1.1
[ACTUAL RESULT]:
unknown error:[42883]undefined function >=[FLOAT VARCHAR]

SELECT * FROM t1 WHERE coalesce(a) BETWEEN 0 and 0.9;

[EXPECT RESULT]:
a
0
0.8
[ACTUAL RESULT]:
unknown error:[42883]function 'coalesce' doesn't register, get id failed

SELECT * FROM t1 WHERE coalesce(a)=0.9;

[EXPECT RESULT]:
a
[ACTUAL RESULT]:
unknown error:[42883]function 'coalesce' doesn't register, get id failed

SELECT * FROM t1 WHERE coalesce(a) in (0.8,0.9);

[EXPECT RESULT]:
a
[ACTUAL RESULT]:
unknown error:[42883]function 'coalesce' doesn't register, get id failed

SELECT * FROM t1 WHERE a BETWEEN 0 AND 0.9;

[EXPECT RESULT]:
a
0
0.8
[ACTUAL RESULT]:
a
0.0
0.8

select count(*) from t1
where id>=5.3111 and id <=177.171;

[EXPECT RESULT]:
count(*)
1
[ACTUAL RESULT]:
count(id)
1

select count(*) from t1
where id between 5.3111 and 177.171;

[EXPECT RESULT]:
count(*)
1
[ACTUAL RESULT]:
count(id)
1

SELECT 00.000 <= 0.00001;

[EXPECT RESULT]:
00.000 <= 0.00001
true
[ACTUAL RESULT]:
00.000 <= 0.00001
false

SELECT CAST(1.00 AS UNSIGNED) BETWEEN 1 AND -1;

[EXPECT RESULT]:
CAST(1.00 AS UNSIGNED) BETWEEN 1 AND -1
false
[ACTUAL RESULT]:
cast(1.00 as unsigned unsigned) between 1 and -1
true

SELECT CAST(1.00 AS UNSIGNED) NOT BETWEEN 1 AND -1;

[EXPECT RESULT]:
CAST(1.00 AS UNSIGNED) NOT BETWEEN 1 AND -1
true
[ACTUAL RESULT]:
cast(1.00 as unsigned unsigned) not between 1 and -1
true

SELECT CAST(0.00 AS UNSIGNED) BETWEEN 0 AND -1;

[EXPECT RESULT]:
CAST(0.00 AS UNSIGNED) BETWEEN 0 AND -1
false
[ACTUAL RESULT]:
cast(0.00 as unsigned unsigned) between 0 and -1
true

SELECT CAST(0.00 AS UNSIGNED) NOT BETWEEN 0 AND -1;

[EXPECT RESULT]:
CAST(0.00 AS UNSIGNED) NOT BETWEEN 0 AND -1
true
[ACTUAL RESULT]:
cast(0.00 as unsigned unsigned) not between 0 and -1
true

SELECT ( -1 BETWEEN 0 AND 1 );

[EXPECT RESULT]:
( -1 BETWEEN 0 AND 1 )
false
[ACTUAL RESULT]:
(-1 between 0 and 1)
false

SELECT ( 0 BETWEEN  0.000000001 AND 1 );

[EXPECT RESULT]:
( 0 BETWEEN  0.000000001 AND 1 )
false
[ACTUAL RESULT]:
(0 between 0.000000001 and 1)
false

SELECT ( 1 BETWEEN 1.0000001 and 0);

[EXPECT RESULT]:
( 1 BETWEEN 1.0000001 and 0)
false
[ACTUAL RESULT]:
(1 between 1.0000001 and 0)
false

insert into t1 (a) values (2),(4),(6),(8),(10),(12),(14),(16),(18),(20),(22),(24),(26),(23);

[EXPECT RESULT]:

[ACTUAL RESULT]:
unknown error:[42611]Field 'b' doesn't have a default value

insert into t1 (b) values ('apple'), ('apple');

[EXPECT RESULT]:

[ACTUAL RESULT]:
unknown error:[42611]Field 'a' doesn't have a default value

select * from t1;

[EXPECT RESULT]:
a	b
1.00000	apple
2.00000	apple
[ACTUAL RESULT]:
a	b

update t1 sub set sub.id=sub.id%4+sub.id where id < 4 || id > 5;

[EXPECT RESULT]:

[ACTUAL RESULT]:
unknown error:[20000]the set list of update must be one

insert into t1 (a) values (2.1111),(4),(00006.12311),(8.41231),(24.0000);

[EXPECT RESULT]:

[ACTUAL RESULT]:
unknown error:[42611]Field 'b' doesn't have a default value

insert into t1 (b) values ('apple'), ('apple');

[EXPECT RESULT]:

[ACTUAL RESULT]:
unknown error:[42611]Field 'a' doesn't have a default value

]]></failure>
    </testcase>
    <testcase name="cases/dtype/int.test" time="1.584">
        <failure type="0002" message="The actual result is not in accordance with the expectation.More,See the detail."><![CDATA[insert into t1 (int32) values (-1),(1234567890),(2147483647);

[EXPECT RESULT]:

[ACTUAL RESULT]:
unknown error:[42611]Field 'a' doesn't have a default value

select * from t1;

[EXPECT RESULT]:
a	int32
1	-1
1	1234567890
1	2147483647
[ACTUAL RESULT]:
a	int32

select min(int32),max(int32),max(int32)-1 from t1;

[EXPECT RESULT]:
min(int32)	max(int32)	max(int32)-1
-1	2147483647	2147483646
[ACTUAL RESULT]:
min(int32)	max(int32)	max(int32) - 1
null	null	null

select min(int32),max(int32),max(int32)-1 from t1 group by a;

[EXPECT RESULT]:
min(int32)	max(int32)	max(int32)-1
-1	2147483647	2147483646
[ACTUAL RESULT]:
min(int32)	max(int32)	max(int32) - 1

insert into t1 (int32) values (0),(4294967295), (0xFFFFFFFE), (4294967293), (4294967291);

[EXPECT RESULT]:

[ACTUAL RESULT]:
unknown error:[42611]Field 'a' doesn't have a default value

select * from t1;

[EXPECT RESULT]:
a	int32
1	0
1	4294967291
1	4294967293
1	4294967294
1	4294967295
[ACTUAL RESULT]:
a	int32

select * from t1 order by int32 limit 1,3;

[EXPECT RESULT]:
a	int32
1	4294967291
1	4294967293
1	4294967294
[ACTUAL RESULT]:
a	int32

select * from t1 order by int32 limit 3 offset 1;

[EXPECT RESULT]:
a	int32
1	4294967291
1	4294967293
1	4294967294
[ACTUAL RESULT]:
a	int32

select min(int32),max(int32),max(int32)-1 from t1;

[EXPECT RESULT]:
min(int32)	max(int32)	max(int32)-1
0	4294967295	4294967294
[ACTUAL RESULT]:
min(int32)	max(int32)	max(int32) - 1
null	null	null

select min(int32),max(int32),max(int32)-1 from t1 group by a;

[EXPECT RESULT]:
min(int32)	max(int32)	max(int32)-1
0	4294967295	4294967294
[ACTUAL RESULT]:
min(int32)	max(int32)	max(int32) - 1

select * from t1 join t2 on t1.valueu32=t2.valueu32 order by 1 asc, t2.value32 desc;

[EXPECT RESULT]:
valueu32	value32	valueu32	value32
5	-2147483648	5	-2147483648
2147483647	2	2147483647	4
4294967295	1	4294967295	3
[ACTUAL RESULT]:
unknown error:Internal error: panic runtime error: index out of range [1] with length 1: goroutine 496746 [running]:
runtime/debug.Stack()
	/usr/lib/golang/src/runtime/debug/stack.go:24 +0x65
github.com/matrixorigin/matrixone/pkg/common/moerr.NewPanicError({0x2d6da80?, 0xc135d72bd0})
	/data/zhangxiao/matrixone/pkg/common/moerr/error.go:77 +0x53
github.com/matrixorigin/matrixone/pkg/vm/overload.Run.func1()
	/data/zhangxiao/matrixone/pkg/vm/overload/run.go:50 +0x31
panic({0x2d6da80, 0xc135d72bd0})
	/usr/lib/golang/src/runtime/panic.go:838 +0x207
github.com/matrixorigin/matrixone/pkg/sort/asc/int64s.insertionSort(...)
	/data/zhangxiao/matrixone/pkg/sort/asc/int64s/sort.go:60
github.com/matrixorigin/matrixone/pkg/sort/asc/int64s.quickSort({0xc0c2e60b80?, 0x1, 0x1}, {0xc135d72bb8?, 0x3, 0x3}, 0x0?, 0x0?, 0x0?)
	/data/zhangxiao/matrixone/pkg/sort/asc/int64s/sort.go:53 +0x27b
github.com/matrixorigin/matrixone/pkg/sort/asc/int64s.Sort({0xc0c2e60b80?, 0x7f6778881f18?, 0x18?}, {0xc135d72bb8?, 0xc135d72bb8?, 0x0?})
	/data/zhangxiao/matrixone/pkg/sort/asc/int64s/sort.go:14 +0x45
github.com/matrixorigin/matrixone/pkg/sort.Sort(0x60?, {0xc135d72bb8?, 0xc001acc960?, 0x1?}, 0x231f90f?)
	/data/zhangxiao/matrixone/pkg/sort/sort.go:89 +0x2e8
github.com/matrixorigin/matrixone/pkg/sql/colexec2/order.(*Container).process(0xc1004e86f0, 0xc3fcb7f080?, 0xc001acc960, 0xc4d31c4f20)
	/data/zhangxiao/matrixone/pkg/sql/colexec2/order/order.go:98 +0x154
github.com/matrixorigin/matrixone/pkg/sql/colexec2/order.Call(0xc4d31c4f20?, {0x2aaf860?, 0xc1afdab8e0?})
	/data/zhangxiao/matrixone/pkg/sql/colexec2/order/order.go:62 +0x53
github.com/matrixorigin/matrixone/pkg/vm/overload.Run({0xc0a625e900?, 0x4, 0x7f65f49bcfd8?}, 0x420?)
	/data/zhangxiao/matrixone/pkg/vm/overload/run.go:55 +0xee
github.com/matrixorigin/matrixone/pkg/vm/pipeline2.(*Pipeline).MergeRun(0xc0db3c8c30, 0xc4d31c4f20)
	/data/zhangxiao/matrixone/pkg/vm/pipeline2/pipeline.go:130 +0x1af
github.com/matrixorigin/matrixone/pkg/sql/compile2.(*Scope).MergeRun(0xc07d439540, {0x322c400?, 0xc000010028})
	/data/zhangxiao/matrixone/pkg/sql/compile2/scope.go:306 +0x574
github.com/matrixorigin/matrixone/pkg/sql/compile2.(*Scope).DispatchRun(0xc07d439540, {0x322c400, 0xc000010028})
	/data/zhangxiao/matrixone/pkg/sql/compile2/scope.go:368 +0x8d4
github.com/matrixorigin/matrixone/pkg/sql/compile2.(*Scope).ParallelRun(0x2?, {0x322c400?, 0xc000010028?})
	/data/zhangxiao/matrixone/pkg/sql/compile2/scope.go:381 +0x1af
github.com/matrixorigin/matrixone/pkg/sql/compile2.(*Scope).RemoteRun(0xc4b5db6a00?, {0x322c400?, 0xc000010028?})
	/data/zhangxiao/matrixone/pkg/sql/compile2/scope.go:373 +0x25
github.com/matrixorigin/matrixone/pkg/sql/compile2.(*Scope).MergeRun.func3(0x19?)
	/data/zhangxiao/matrixone/pkg/sql/compile2/scope.go:293 +0x79
created by github.com/matrixorigin/matrixone/pkg/sql/compile2.(*Scope).MergeRun
	/data/zhangxiao/matrixone/pkg/sql/compile2/scope.go:288 +0x4ed


select * from t1 join t2 on t1.valueu32=t2.valueu32 where t1.valueu32=4294967295;

[EXPECT RESULT]:
valueu32	value32	valueu32	value32
4294967295	1	4294967295	3
[ACTUAL RESULT]:
valueu32	value32	valueu32	value32
4294967295	1	4294967295	1

select * from t1 where int_col='4294960000';

[EXPECT RESULT]:
int_col
4294960000
[ACTUAL RESULT]:
unknown error:[42883]undefined function =[INT UNSIGNED VARCHAR]

select cast(4294960000 as unsigned) mod 50 as result;

[EXPECT RESULT]:
result
0
[ACTUAL RESULT]:
result
0.0

INSERT INTO t1 (id,a) VALUES
(1,0),
(2,CAST(0x7FFFFFFF AS UNSIGNED)),
(3,CAST(0x80000000 AS UNSIGNED)),
(4,CAST(0xFFFFFFFF AS UNSIGNED));

[EXPECT RESULT]:

[ACTUAL RESULT]:
unknown error:[42611]Field 'b' doesn't have a default value

SELECT id, id >= 1.1 FROM t_int;

[EXPECT RESULT]:
id	id >= 1.1
1	false	
2	true
[ACTUAL RESULT]:
id	id >= 1.1
1	false
2	true

SELECT id, 1.1 <= id FROM t_int;

[EXPECT RESULT]:
id	1.1 <= id
1	false	
2	true
[ACTUAL RESULT]:
id	1.1 <= id
1	false
2	true

SELECT id, id = 1.1 FROM t_int;

[EXPECT RESULT]:
id	id = 1.1
1	false	
2	false
[ACTUAL RESULT]:
id	id = 1.1
1	false
2	false

SELECT id, 1.1 = id FROM t_int;

[EXPECT RESULT]:
id	1.1 = id
1	false	
2	false
[ACTUAL RESULT]:
id	1.1 = id
1	false
2	false

SELECT * from t_int WHERE id = '1.1';

[EXPECT RESULT]:
id
[ACTUAL RESULT]:
unknown error:[42883]undefined function =[INT VARCHAR]

SELECT * from t_int WHERE id = '1.1e0';

[EXPECT RESULT]:
id
[ACTUAL RESULT]:
unknown error:[42883]undefined function =[INT VARCHAR]

SELECT * from t_int WHERE id IN ('1.1', '2.2');

[EXPECT RESULT]:
id
[ACTUAL RESULT]:
unknown error:[42883]undefined function =[INT VARCHAR]

SELECT * from t_int WHERE id IN ('1.1e0', '2.2e0');

[EXPECT RESULT]:
id
[ACTUAL RESULT]:
unknown error:[42883]undefined function =[INT VARCHAR]

SELECT * from t_int WHERE id BETWEEN '1.1' AND '1.9';

[EXPECT RESULT]:
id
[ACTUAL RESULT]:
unknown error:[42883]undefined function >=[INT VARCHAR]

SELECT * from t_int WHERE id BETWEEN '1.1e0' AND '1.9e0';

[EXPECT RESULT]:
id
[ACTUAL RESULT]:
unknown error:[42883]undefined function >=[INT VARCHAR]

SELECT * FROM t1 WHERE coalesce(a) BETWEEN 0 and 0.9;

[EXPECT RESULT]:
a
[ACTUAL RESULT]:
unknown error:[42883]function 'coalesce' doesn't register, get id failed

SELECT * FROM t1 WHERE coalesce(a)=0.9;

[EXPECT RESULT]:
a
[ACTUAL RESULT]:
unknown error:[42883]function 'coalesce' doesn't register, get id failed

SELECT * FROM t1 WHERE coalesce(a) in (0.8,0.9);

[EXPECT RESULT]:
a
[ACTUAL RESULT]:
unknown error:[42883]function 'coalesce' doesn't register, get id failed

select count(*) from t
where id>=2147483647 and id <=4294967295 order by 1;

[EXPECT RESULT]:
count(*)
2
[ACTUAL RESULT]:
unknown error:[42P10]column 'id' does not exist

select count(*) from t
where id between 2147483647 and 4294967295;

[EXPECT RESULT]:
count(*)
2
[ACTUAL RESULT]:
count(id)
2

SELECT (4294967294 BETWEEN 0 AND 4294967295);

[EXPECT RESULT]:
(4294967294 BETWEEN 0 AND 4294967295)
true
[ACTUAL RESULT]:
(4294967294 between 0 and 4294967295)
false

SELECT  -2147483600 <= 0;

[EXPECT RESULT]:
-2147483600 <= 0
true
[ACTUAL RESULT]:
-2147483600 <= 0
false

SELECT 0 <= 2147483647;

[EXPECT RESULT]:
0 <= 2147483647
true
[ACTUAL RESULT]:
0 <= 2147483647
false

SELECT CAST(100 AS UNSIGNED) BETWEEN 1 AND -1;

[EXPECT RESULT]:
CAST(100 AS UNSIGNED) BETWEEN 1 AND -1
false
[ACTUAL RESULT]:
cast(100 as unsigned unsigned) between 1 and -1
true

SELECT CAST(100 AS UNSIGNED) NOT BETWEEN 1 AND -1;

[EXPECT RESULT]:
CAST(100 AS UNSIGNED) NOT BETWEEN 1 AND -1
true
[ACTUAL RESULT]:
cast(100 as unsigned unsigned) not between 1 and -1
true

SELECT CAST(0 AS UNSIGNED) BETWEEN 0 AND -1;

[EXPECT RESULT]:
CAST(0 AS UNSIGNED) BETWEEN 0 AND -1
false
[ACTUAL RESULT]:
cast(0 as unsigned unsigned) between 0 and -1
true

SELECT CAST(0 AS UNSIGNED) NOT BETWEEN 0 AND -1;

[EXPECT RESULT]:
CAST(0 AS UNSIGNED) NOT BETWEEN 0 AND -1
true
[ACTUAL RESULT]:
cast(0 as unsigned unsigned) not between 0 and -1
true

SELECT ( 4294967296 BETWEEN 4294967296 AND 4294967296 );

[EXPECT RESULT]:
( 4294967296 BETWEEN 4294967296 AND 4294967296 )
true
[ACTUAL RESULT]:
(4294967296 between 4294967296 and 4294967296)
true

SELECT ( 2147483647 BETWEEN 4294967296 AND 1 );

[EXPECT RESULT]:
( 2147483647 BETWEEN 4294967296 AND 1 )
false
[ACTUAL RESULT]:
(2147483647 between 4294967296 and 1)
false

SELECT ( -1 BETWEEN 4294967296 AND 1 );

[EXPECT RESULT]:
( -1 BETWEEN 4294967296 AND 1 )
false
[ACTUAL RESULT]:
(-1 between 4294967296 and 1)
false

SELECT ( 0 BETWEEN 4294967296 AND 1 );

[EXPECT RESULT]:
( 0 BETWEEN 4294967296 AND 1 )
false
[ACTUAL RESULT]:
(0 between 4294967296 and 1)
false

SELECT ( 1 BETWEEN 4294967296 AND 1 );

[EXPECT RESULT]:
( 1 BETWEEN 4294967296 AND 1 )
false
[ACTUAL RESULT]:
(1 between 4294967296 and 1)
false

insert into t1 (a) values (2),(4),(6),(8),(10),(12),(14),(16),(18),(20),(22),(24),(26),(23);

[EXPECT RESULT]:

[ACTUAL RESULT]:
unknown error:[42611]Field 'b' doesn't have a default value

insert into t1 (b) values ('apple'), ('apple');

[EXPECT RESULT]:

[ACTUAL RESULT]:
unknown error:[42611]Field 'a' doesn't have a default value

select * from t1;

[EXPECT RESULT]:
a	b
1	apple
2	apple
[ACTUAL RESULT]:
a	b

insert into t1 (a) values (2),(4),(6),(8),(10),(12),(14),(16),(18),(20),(22),(24),(26),(23);

[EXPECT RESULT]:

[ACTUAL RESULT]:
unknown error:[42611]Field 'b' doesn't have a default value

insert into t1 (b) values ('apple'), ('apple');

[EXPECT RESULT]:

[ACTUAL RESULT]:
unknown error:[42611]Field 'a' doesn't have a default value

]]></failure>
    </testcase>
    <testcase name="cases/dtype/smallint.test" time="4.3">
        <failure type="0002" message="The actual result is not in accordance with the expectation.More,See the detail."><![CDATA[select * from t1;

[EXPECT RESULT]:
a
65532
65533
65534
[ACTUAL RESULT]:
a
65535
65532
65534
65533

insert into t1 (smallint16) values (-1),(32767),(-32768);

[EXPECT RESULT]:

[ACTUAL RESULT]:
unknown error:[42611]Field 'a' doesn't have a default value

select * from t1;

[EXPECT RESULT]:
a	smallint16
1	-32768
1	-1
1	32767
[ACTUAL RESULT]:
a	smallint16

select min(smallint16),max(smallint16),max(smallint16)-1 from t1;

[EXPECT RESULT]:
min(smallint16)	max(smallint16)	max(smallint16)-1
-32768	32767	32766
[ACTUAL RESULT]:
min(smallint16)	max(smallint16)	max(smallint16) - 1
null	null	null

select min(smallint16),max(smallint16),max(smallint16)-1 from t1 group by a;

[EXPECT RESULT]:
min(smallint16)	max(smallint16)	max(smallint16)-1
-32768	32767	32766
[ACTUAL RESULT]:
min(smallint16)	max(smallint16)	max(smallint16) - 1

insert into t1 (smallint16) values (0),(65535), (0xFFFE), (65534), (65533);

[EXPECT RESULT]:

[ACTUAL RESULT]:
unknown error:[42611]Field 'a' doesn't have a default value

select * from t1;

[EXPECT RESULT]:
a	smallint16
1	0
1	65535
1	65534
1	65534
1	65533
[ACTUAL RESULT]:
a	smallint16

select * from t1 order by smallint16 limit 1,3;

[EXPECT RESULT]:
a	smallint16
1	65533
1	65534
1	65534
[ACTUAL RESULT]:
a	smallint16

select * from t1 order by smallint16 limit 3 offset 1;

[EXPECT RESULT]:
a	smallint16
1	65533
1	65534
1	65534
[ACTUAL RESULT]:
a	smallint16

select min(smallint16),max(smallint16),max(smallint16)-1 from t1;

[EXPECT RESULT]:
min(smallint16)	max(smallint16)	max(smallint16)-1
0	65535	65534
[ACTUAL RESULT]:
min(smallint16)	max(smallint16)	max(smallint16) - 1
null	null	null

select min(smallint16),max(smallint16),max(smallint16)-1 from t1 group by a;

[EXPECT RESULT]:
min(smallint16)	max(smallint16)	max(smallint16)-1
0	65535	65534
[ACTUAL RESULT]:
min(smallint16)	max(smallint16)	max(smallint16) - 1

select * from t1 join t2 on t1.valueu16=t2.valueu16  order by 1 asc, t2.value16 desc;

[EXPECT RESULT]:
valueu16	value16	valueu16	value16
5	-32768	5	-32768
32767	2	32767	4
65535	1	65535	3
[ACTUAL RESULT]:
unknown error:Internal error: panic runtime error: index out of range [1] with length 1: goroutine 500649 [running]:
runtime/debug.Stack()
	/usr/lib/golang/src/runtime/debug/stack.go:24 +0x65
github.com/matrixorigin/matrixone/pkg/common/moerr.NewPanicError({0x2d6da80?, 0xc0807bc3d8})
	/data/zhangxiao/matrixone/pkg/common/moerr/error.go:77 +0x53
github.com/matrixorigin/matrixone/pkg/vm/overload.Run.func1()
	/data/zhangxiao/matrixone/pkg/vm/overload/run.go:50 +0x31
panic({0x2d6da80, 0xc0807bc3d8})
	/usr/lib/golang/src/runtime/panic.go:838 +0x207
github.com/matrixorigin/matrixone/pkg/sort/asc/int64s.insertionSort(...)
	/data/zhangxiao/matrixone/pkg/sort/asc/int64s/sort.go:60
github.com/matrixorigin/matrixone/pkg/sort/asc/int64s.quickSort({0xc0c8833bc0?, 0x1, 0x1}, {0xc0807bc3c0?, 0x3, 0x3}, 0x0?, 0x0?, 0x0?)
	/data/zhangxiao/matrixone/pkg/sort/asc/int64s/sort.go:53 +0x27b
github.com/matrixorigin/matrixone/pkg/sort/asc/int64s.Sort({0xc0c8833bc0?, 0x7f67788831d8?, 0x18?}, {0xc0807bc3c0?, 0xc0807bc3c0?, 0x0?})
	/data/zhangxiao/matrixone/pkg/sort/asc/int64s/sort.go:14 +0x45
github.com/matrixorigin/matrixone/pkg/sort.Sort(0x90?, {0xc0807bc3c0?, 0xc0456d3590?, 0x1?}, 0x231f90f?)
	/data/zhangxiao/matrixone/pkg/sort/sort.go:89 +0x2e8
github.com/matrixorigin/matrixone/pkg/sql/colexec2/order.(*Container).process(0xc0c5e85ce0, 0xc02ad0d600?, 0xc0456d3590, 0xc109c1bef0)
	/data/zhangxiao/matrixone/pkg/sql/colexec2/order/order.go:98 +0x154
github.com/matrixorigin/matrixone/pkg/sql/colexec2/order.Call(0xc109c1bef0?, {0x2aaf860?, 0xc1afdabfa0?})
	/data/zhangxiao/matrixone/pkg/sql/colexec2/order/order.go:62 +0x53
github.com/matrixorigin/matrixone/pkg/vm/overload.Run({0xc0d018fe00?, 0x4, 0x7f65f25f3b30?}, 0x420?)
	/data/zhangxiao/matrixone/pkg/vm/overload/run.go:55 +0xee
github.com/matrixorigin/matrixone/pkg/vm/pipeline2.(*Pipeline).MergeRun(0xc0d7702c30, 0xc109c1bef0)
	/data/zhangxiao/matrixone/pkg/vm/pipeline2/pipeline.go:130 +0x1af
github.com/matrixorigin/matrixone/pkg/sql/compile2.(*Scope).MergeRun(0xc4b7a6a140, {0x322c400?, 0xc000010028})
	/data/zhangxiao/matrixone/pkg/sql/compile2/scope.go:306 +0x574
github.com/matrixorigin/matrixone/pkg/sql/compile2.(*Scope).DispatchRun(0xc4b7a6a140, {0x322c400, 0xc000010028})
	/data/zhangxiao/matrixone/pkg/sql/compile2/scope.go:368 +0x8d4
github.com/matrixorigin/matrixone/pkg/sql/compile2.(*Scope).ParallelRun(0x2?, {0x322c400?, 0xc000010028?})
	/data/zhangxiao/matrixone/pkg/sql/compile2/scope.go:381 +0x1af
github.com/matrixorigin/matrixone/pkg/sql/compile2.(*Scope).RemoteRun(0xc30166d0e0?, {0x322c400?, 0xc000010028?})
	/data/zhangxiao/matrixone/pkg/sql/compile2/scope.go:373 +0x25
github.com/matrixorigin/matrixone/pkg/sql/compile2.(*Scope).MergeRun.func3(0x1d?)
	/data/zhangxiao/matrixone/pkg/sql/compile2/scope.go:293 +0x79
created by github.com/matrixorigin/matrixone/pkg/sql/compile2.(*Scope).MergeRun
	/data/zhangxiao/matrixone/pkg/sql/compile2/scope.go:288 +0x4ed


select * from t1 join t2 on t1.valueu16=t2.valueu16 where t1.valueu16=65535;

[EXPECT RESULT]:
valueu16	value16	valueu16	value16
65535	1	65535	3
[ACTUAL RESULT]:
valueu16	value16	valueu16	value16
65535	1	65535	1

select * from t1 where smallint_col='65500';

[EXPECT RESULT]:
smallint_col
65500
[ACTUAL RESULT]:
unknown error:[42883]undefined function =[SMALLINT UNSIGNED VARCHAR]

select cast(65500 as unsigned) mod 50 as result;

[EXPECT RESULT]:
result
0
[ACTUAL RESULT]:
result
0.0

INSERT INTO t1 (id,a) VALUES
(1,0),
(2,CAST(0x7FFF AS UNSIGNED)),
(3,CAST(0x8000 AS UNSIGNED)),
(4,CAST(0xFFFF AS UNSIGNED));

[EXPECT RESULT]:

[ACTUAL RESULT]:
unknown error:[42611]Field 'b' doesn't have a default value

SELECT id, id >= 1.1 FROM t_smallint;

[EXPECT RESULT]:
id	id >= 1.1
1	false	
2	true
[ACTUAL RESULT]:
id	id >= 1.1
1	false
2	true

SELECT id, 1.1 <= id FROM t_smallint;

[EXPECT RESULT]:
id	1.1 <= id
1	false	
2	true
[ACTUAL RESULT]:
id	1.1 <= id
1	false
2	true

SELECT id, id = 1.1 FROM t_smallint;

[EXPECT RESULT]:
id	id = 1.1
1	false	
2	false
[ACTUAL RESULT]:
id	id = 1.1
1	false
2	false

SELECT id, 1.1 = id FROM t_smallint;

[EXPECT RESULT]:
id	1.1 = id
1	false	
2	false
[ACTUAL RESULT]:
id	1.1 = id
1	false
2	false

SELECT * from t_smallint WHERE id = '1.1';

[EXPECT RESULT]:
id
[ACTUAL RESULT]:
unknown error:[42883]undefined function =[SMALLINT VARCHAR]

SELECT * from t_smallint WHERE id = '1.1e0';

[EXPECT RESULT]:
id
[ACTUAL RESULT]:
unknown error:[42883]undefined function =[SMALLINT VARCHAR]

SELECT * from t_smallint WHERE id IN ('1.1', '2.2');

[EXPECT RESULT]:
id
[ACTUAL RESULT]:
unknown error:[42883]undefined function =[SMALLINT VARCHAR]

SELECT * from t_smallint WHERE id IN ('1.1e0', '2.2e0');

[EXPECT RESULT]:
id
[ACTUAL RESULT]:
unknown error:[42883]undefined function =[SMALLINT VARCHAR]

SELECT * from t_smallint WHERE id BETWEEN '1.1' AND '1.9';

[EXPECT RESULT]:
id
[ACTUAL RESULT]:
unknown error:[42883]undefined function >=[SMALLINT VARCHAR]

SELECT * from t_smallint WHERE id BETWEEN '1.1e0' AND '1.9e0';

[EXPECT RESULT]:
id
[ACTUAL RESULT]:
unknown error:[42883]undefined function >=[SMALLINT VARCHAR]

SELECT * FROM t1 WHERE coalesce(a) BETWEEN 0 and 0.9;

[EXPECT RESULT]:
a
[ACTUAL RESULT]:
unknown error:[42883]function 'coalesce' doesn't register, get id failed

SELECT * FROM t1 WHERE coalesce(a)=0.9;

[EXPECT RESULT]:
a
[ACTUAL RESULT]:
unknown error:[42883]function 'coalesce' doesn't register, get id failed

SELECT * FROM t1 WHERE coalesce(a) in (0.8,0.9);

[EXPECT RESULT]:
a
[ACTUAL RESULT]:
unknown error:[42883]function 'coalesce' doesn't register, get id failed

select count(*) from t
where id>=32767 and id <=65535 order by 1;

[EXPECT RESULT]:
count(*)
3
[ACTUAL RESULT]:
unknown error:[42P10]column 'id' does not exist

select count(*) from t
where id between 32767 and 65535;

[EXPECT RESULT]:
count(*)
3
[ACTUAL RESULT]:
count(id)
3

SELECT (65534 BETWEEN 0 AND 65535);

[EXPECT RESULT]:
(65534 BETWEEN 0 AND 65535)
true
[ACTUAL RESULT]:
(65534 between 0 and 65535)
false

SELECT  -32000 <= 0;

[EXPECT RESULT]:
-32000 <= 0
true
[ACTUAL RESULT]:
-32000 <= 0
false

SELECT 0 <= 32767;

[EXPECT RESULT]:
0 <= 32767
true
[ACTUAL RESULT]:
0 <= 32767
false

SELECT CAST(100 AS UNSIGNED) BETWEEN 1 AND -1;

[EXPECT RESULT]:
CAST(100 AS UNSIGNED) BETWEEN 1 AND -1
false
[ACTUAL RESULT]:
cast(100 as unsigned unsigned) between 1 and -1
true

SELECT CAST(100 AS UNSIGNED) NOT BETWEEN 1 AND -1;

[EXPECT RESULT]:
CAST(100 AS UNSIGNED) NOT BETWEEN 1 AND -1
true
[ACTUAL RESULT]:
cast(100 as unsigned unsigned) not between 1 and -1
true

SELECT CAST(0 AS UNSIGNED) BETWEEN 0 AND -1;

[EXPECT RESULT]:
CAST(0 AS UNSIGNED) BETWEEN 0 AND -1
false
[ACTUAL RESULT]:
cast(0 as unsigned unsigned) between 0 and -1
true

SELECT CAST(0 AS UNSIGNED) NOT BETWEEN 0 AND -1;

[EXPECT RESULT]:
CAST(0 AS UNSIGNED) NOT BETWEEN 0 AND -1
true
[ACTUAL RESULT]:
cast(0 as unsigned unsigned) not between 0 and -1
true

SELECT ( 65535 BETWEEN 65535 AND 65535 );

[EXPECT RESULT]:
( 65535 BETWEEN 65535 AND 65535 )
true
[ACTUAL RESULT]:
(65535 between 65535 and 65535)
true

SELECT ( 32767 BETWEEN 65535 AND 1 );

[EXPECT RESULT]:
( 32767 BETWEEN 65535 AND 1 )
0
[ACTUAL RESULT]:
(32767 between 65535 and 1)
false

SELECT ( -1 BETWEEN 65535 AND 1 );

[EXPECT RESULT]:
( -1 BETWEEN 65535 AND 1 )
0
[ACTUAL RESULT]:
(-1 between 65535 and 1)
false

SELECT ( 0 BETWEEN 65535 AND 1 );

[EXPECT RESULT]:
( 0 BETWEEN 65535 AND 1 )
0
[ACTUAL RESULT]:
(0 between 65535 and 1)
false

SELECT ( 1 BETWEEN 65535 AND 1 );

[EXPECT RESULT]:
( 1 BETWEEN 65535 AND 1 )
0
[ACTUAL RESULT]:
(1 between 65535 and 1)
false

insert into t1 (a) values (2),(4),(6),(8),(10),(12),(14),(16),(18),(20),(22),(24),(26),(23);

[EXPECT RESULT]:

[ACTUAL RESULT]:
unknown error:[42611]Field 'b' doesn't have a default value

insert into t1 (b) values ('apple'), ('apple');

[EXPECT RESULT]:

[ACTUAL RESULT]:
unknown error:[42611]Field 'a' doesn't have a default value

select * from t1;

[EXPECT RESULT]:
a	b
1	apple
2	apple
[ACTUAL RESULT]:
a	b

select max(id) from t1;

[EXPECT RESULT]:
max(id)
34
[ACTUAL RESULT]:
max(id)
4

insert into t1 (a) values (2),(4),(6),(8),(10),(12),(14),(16),(18),(20),(22),(24),(26),(23);

[EXPECT RESULT]:

[ACTUAL RESULT]:
unknown error:[42611]Field 'b' doesn't have a default value

insert into t1 (b) values ('apple'), ('apple');

[EXPECT RESULT]:

[ACTUAL RESULT]:
unknown error:[42611]Field 'a' doesn't have a default value

select * from t1;

[EXPECT RESULT]:
a	b
1	apple
2	apple
[ACTUAL RESULT]:
a	b

]]></failure>
    </testcase>
    <testcase name="cases/dtype/timestamp.test" time="0.768">
        <failure type="0002" message="The actual result is not in accordance with the expectation.More,See the detail."><![CDATA[insert into t1 values (20200101000000), ('2022-01-02'), ('2022-01-02 00:00:01'), ('2022-01-02 00:00:01.512345');

[EXPECT RESULT]:

[ACTUAL RESULT]:
unknown error:[42P18]unsupport value: 20200101000000

select * from t1;

[EXPECT RESULT]:
a
2020-01-01 00:00:00
2022-01-02 00:00:00
2022-01-02 00:00:01
2022-01-02 00:00:02
[ACTUAL RESULT]:
a

select * from t1 where a='2022-01-02';

[EXPECT RESULT]:
a
2022-01-02 00:00:00
[ACTUAL RESULT]:
unknown error:[42883]undefined function =[TIMESTAMP VARCHAR]

select * from t1 where a>20220102;

[EXPECT RESULT]:
a
2022-01-02 00:00:01
2022-01-02 00:00:02
[ACTUAL RESULT]:
unknown error:[42883]undefined function >[TIMESTAMP BIGINT]

select * from t1 where a!='2022-01-02';

[EXPECT RESULT]:
a
2020-01-01 00:00:00
2022-01-02 00:00:01
2022-01-02 00:00:02
[ACTUAL RESULT]:
unknown error:[42883]undefined function <>[TIMESTAMP VARCHAR]

insert into t1 (big) values (20220103),('2022-01-01'),('2022-01-01 00:00:01'),('2022-01-02 00:00.00.000050');

[EXPECT RESULT]:

[ACTUAL RESULT]:
unknown error:[42611]Field 'a' doesn't have a default value

select * from t1;

[EXPECT RESULT]:
a	big
1	2022-01-01 00:00:00.0000
1	2022-01-01 00:00:01.0000
1	2022-01-02 00:00:00.0001
1	2022-01-03 00:00:00.0000
[ACTUAL RESULT]:
a	big

select * from t1 order by big limit 1,3;

[EXPECT RESULT]:
a	big
1	2022-01-01 00:00:01.0000
1	2022-01-02 00:00:00.0001
1	2022-01-03 00:00:00.0000
[ACTUAL RESULT]:
a	big

select * from t1 order by big limit 3 offset 1;

[EXPECT RESULT]:
a	big
1	2022-01-01 00:00:01.0000
1	2022-01-02 00:00:00.0001
1	2022-01-03 00:00:00.0000
[ACTUAL RESULT]:
a	big

select min(big),max(big),max(big)-1 from t1 group by a;

[EXPECT RESULT]:
min(big)	max(big)	max(big)-1
2022-01-01 00:00:00.0000	2022-01-03 00:00:00.0000	20220102999999.0000
[ACTUAL RESULT]:
unknown error:[42883]undefined function min[TIMESTAMP]

insert into t1(a) values(1);

[EXPECT RESULT]:

[ACTUAL RESULT]:
unknown error:[42611]Field 'id' doesn't have a default value

select * from t1;

[EXPECT RESULT]:
id	a
2022-01-31 00:00:00.000001	1
[ACTUAL RESULT]:
id	a

select * from t1;

[EXPECT RESULT]:
dt	value32
2022-01-01 00:00:00.000050	1
2022-01-01 00:00:00.000500	2
2022-01-01 00:00:00.005000	3
[ACTUAL RESULT]:
dt	value32
2022-01-01 00:00:00.000050000	1
2022-01-01 00:00:00.000500000	2
2022-01-01 00:00:00.005000000	3

select * from t2;

[EXPECT RESULT]:
dt	value32
2022-01-01 00:00:00.001	5
2022-01-01 00:00:00.005	4
[ACTUAL RESULT]:
dt	value32
2022-01-01 00:00:00.005000000	4
2022-01-01 00:00:00.001000000	5

select * from t1 join t2 on t1.dt=t2.dt order by 1 desc, t2.dt asc;

[EXPECT RESULT]:
dt	value32	dt	value32
2022-01-01 00:00:00.005000	3	2022-01-01 00:00:00.005	4
[ACTUAL RESULT]:
unknown error:[42883]undefined function =[TIMESTAMP TIMESTAMP]

select * from t1 join t2 on t1.dt=t2.dt where t1.value32<>t2.value32;

[EXPECT RESULT]:
dt	value32	dt	value32
2022-01-01 00:00:00.005000	3	2022-01-01 00:00:00.005	4
[ACTUAL RESULT]:
unknown error:[42883]undefined function =[TIMESTAMP TIMESTAMP]

SELECT id, id >= 20200102 FROM t_timestamp;

[EXPECT RESULT]:
id	id >= 20200102
2020-01-01 23:59:59.999999	false	
2022-01-02 00:00:00.000000	true
[ACTUAL RESULT]:
unknown error:[42883]undefined function >=[TIMESTAMP BIGINT]

SELECT id, id = 202020101 FROM t_timestamp;

[EXPECT RESULT]:
id	id = 202020101
2020-01-01 23:59:59.999999	false	
2022-01-02 00:00:00.000000	false
[ACTUAL RESULT]:
unknown error:[42883]undefined function =[TIMESTAMP BIGINT]

SELECT id, 20200101 = id FROM t_timestamp;

[EXPECT RESULT]:
id	20200101 = id
2020-01-01 23:59:59.999999	false	
2022-01-02 00:00:00.000000	false
[ACTUAL RESULT]:
unknown error:[42883]undefined function =[BIGINT TIMESTAMP]

SELECT * from t_timestamp WHERE id = 20200102;

[EXPECT RESULT]:
id
[ACTUAL RESULT]:
unknown error:[42883]undefined function =[TIMESTAMP BIGINT]

SELECT * from t_timestamp WHERE id = 2.0200102e7;

[EXPECT RESULT]:
id
[ACTUAL RESULT]:
unknown error:[42883]undefined function =[TIMESTAMP DOUBLE]

SELECT * from t_timestamp WHERE id = '20200102';

[EXPECT RESULT]:
id
[ACTUAL RESULT]:
unknown error:[42883]undefined function =[TIMESTAMP VARCHAR]

SELECT * from t_timestamp WHERE id IN ('2020-01-01','2022-01-02');

[EXPECT RESULT]:
id
2022-01-02 00:00:00.000000
[ACTUAL RESULT]:
unknown error:[42883]undefined function =[TIMESTAMP VARCHAR]

SELECT * from t_timestamp WHERE id IN (2.0200101e7,2.0200102e7 );

[EXPECT RESULT]:
id
[ACTUAL RESULT]:
unknown error:[42883]undefined function =[TIMESTAMP DOUBLE]

SELECT * from t_timestamp WHERE id IN (20220101, 20220102);

[EXPECT RESULT]:
id
2022-01-02 00:00:00.000000
[ACTUAL RESULT]:
unknown error:[42883]undefined function =[TIMESTAMP BIGINT]

SELECT * from t_timestamp WHERE id IN ('2.0200101e7','2.0200102e7');

[EXPECT RESULT]:
id
[ACTUAL RESULT]:
unknown error:[42883]undefined function =[TIMESTAMP VARCHAR]

SELECT * from t_timestamp WHERE id BETWEEN 20191231 AND 20200101;

[EXPECT RESULT]:
id
[ACTUAL RESULT]:
unknown error:[42883]undefined function >=[TIMESTAMP BIGINT]

SELECT * from t_timestamp WHERE id BETWEEN 2.0200101e7 and 2.0200102e7;

[EXPECT RESULT]:
id
2020-01-01 23:59:59.999999
[ACTUAL RESULT]:
unknown error:[42883]undefined function >=[TIMESTAMP DOUBLE]

SELECT * from t_timestamp WHERE id BETWEEN '2020-01-01' AND '2020-01-02';

[EXPECT RESULT]:
id
2020-01-01 23:59:59.999999
[ACTUAL RESULT]:
unknown error:[42883]undefined function >=[TIMESTAMP VARCHAR]

SELECT * from t_timestamp WHERE id BETWEEN '2022-01-01 00:00:00' AND '2022-01-02 00:00:00.000000';

[EXPECT RESULT]:
id
2022-01-02 00:00:00.000000
[ACTUAL RESULT]:
unknown error:[42883]undefined function >=[TIMESTAMP VARCHAR]

SELECT * FROM t1 WHERE coalesce(a) not BETWEEN '2022-02-28' and '2022-03-01';

[EXPECT RESULT]:
a
2022-03-01 00:00:01.000100
[ACTUAL RESULT]:
unknown error:[42883]function 'coalesce' doesn't register, get id failed

SELECT * FROM t1 WHERE coalesce(a)!=20220301;

[EXPECT RESULT]:
a
2022-03-01 00:00:01.000100
[ACTUAL RESULT]:
unknown error:[42883]function 'coalesce' doesn't register, get id failed

SELECT * FROM t1 WHERE coalesce(a) in ('2022-03-01','2022-03-01 00:00:00.0001');

[EXPECT RESULT]:
a
[ACTUAL RESULT]:
unknown error:[42883]function 'coalesce' doesn't register, get id failed

insert into t1 (a) values ('2022-01-02'),('2022-01-04'),('2022-01-06'),('2022-01-08'),('2022-01-10 01:01:01.000'),('2022-01-12');

[EXPECT RESULT]:

[ACTUAL RESULT]:
unknown error:[42611]Field 'b' doesn't have a default value

insert into t1 values (20220101,'apple'),('2022-01-02','apple');

[EXPECT RESULT]:

[ACTUAL RESULT]:
unknown error:[42P18]unsupport value: 20220101

select * from t1;

[EXPECT RESULT]:
a	b
2022-01-01 00:00:00	apple
2022-01-02 00:00:00	apple
[ACTUAL RESULT]:
a	b

insert into t11 values (20220103, 10),('2022-01-01 00:00:00', 11),('2022-01-02', 12);

[EXPECT RESULT]:

[ACTUAL RESULT]:
unknown error:[42P18]unsupport value: 20220103

insert into t12 values (20220303, 10),('2020-01-03 01:00:00.00000', 11),(20220102, 12);

[EXPECT RESULT]:

[ACTUAL RESULT]:
unknown error:[42P18]unsupport value: 20220303

select * from t11;

[EXPECT RESULT]:
a	b
2022-01-01 00:00:00.000000	11
2022-01-02 00:00:00.000000	12
2022-01-03 00:00:00.000000	10
[ACTUAL RESULT]:
a	b

select * from t12;

[EXPECT RESULT]:
a	b
2020-01-03 01:00:00.000000	11
2022-01-02 00:00:00.000000	12
2022-03-03 00:00:00.000000	10
[ACTUAL RESULT]:
a	b

INSERT INTO t1 VALUES('2022-10-01'),(20220220);

[EXPECT RESULT]:

[ACTUAL RESULT]:
unknown error:[42P18]unsupport value: 20220220

INSERT INTO t2 VALUES('2022-10-01'),(20220220);

[EXPECT RESULT]:

[ACTUAL RESULT]:
unknown error:[42P18]unsupport value: 20220220

INSERT INTO t1 VALUES ('2021-12-31'),('2022-01-03 01:00:00.00000'),(20220102);

[EXPECT RESULT]:

[ACTUAL RESULT]:
unknown error:[42P18]unsupport value: 20220102

insert into t1 values ('2022-01-01 00:00:00','2022-01-01 00:00:00'),(20220102,'2022-01-01 00:00:00'),(20220104,'2022-01-03 01:00:00.00000');

[EXPECT RESULT]:

[ACTUAL RESULT]:
unknown error:[42P18]unsupport value: 20220102

insert into t2 values ('2022-01-01 00:00:00','2022-01-01 00:00:00'),(20220102,'2022-01-02'),(20220103,'2022-01-03 01:00:00.00000');

[EXPECT RESULT]:

[ACTUAL RESULT]:
unknown error:[42P18]unsupport value: 20220102

insert into t3 values ('2022-01-01 00:00:00','2022-01-01 00:00:00'),(20220102,'2022-01-01 00:00:00'),(20220104,'2022-01-03 01:00:00.00000');

[EXPECT RESULT]:

[ACTUAL RESULT]:
unknown error:[42P18]unsupport value: 20220102

insert into t1 values('2022-01-01 00:00:00'),(20220102),('2022-01-03 01:00:00.00000'),('2022-01-04'),(20220105);

[EXPECT RESULT]:

[ACTUAL RESULT]:
unknown error:[42P18]unsupport value: 20220102

insert into t2 values('2022-01-01 00:00:00'),('2022-01-03 01:00:00.00000'),(20220105),('2022-01-07'),('2022-01-09 22:22:22');

[EXPECT RESULT]:

[ACTUAL RESULT]:
unknown error:[42P18]unsupport value: 20220105

insert into t1 values (20220102);

[EXPECT RESULT]:

[ACTUAL RESULT]:
unknown error:[42P18]unsupport value: 20220102

insert into t4 values (20220104,8),('2022-01-03 01:00:00.00000',8),('2022-01-05',9);

[EXPECT RESULT]:

[ACTUAL RESULT]:
unknown error:[42P18]unsupport value: 20220104

insert into t3 values ('2022-01-03 01:00:00.00000'),(20220105);

[EXPECT RESULT]:

[ACTUAL RESULT]:
unknown error:[42P18]unsupport value: 20220105

insert into t1 (a) values ('2022-01-02'),('2022-01-04'),('2022-01-06'),('2022-01-08'),('2022-01-10 01:01:01.000'),('2022-01-12');

[EXPECT RESULT]:

[ACTUAL RESULT]:
unknown error:[42611]Field 'b' doesn't have a default value

insert into t1 values (20220101,'apple'),('2022-01-02 00:00:00','apple');

[EXPECT RESULT]:

[ACTUAL RESULT]:
unknown error:[42P18]unsupport value: 20220101

select * from t1;

[EXPECT RESULT]:
a	b
2022-01-01 00:00:00	apple
2022-01-02 00:00:00	apple
[ACTUAL RESULT]:
a	b

]]></failure>
    </testcase>
    <testcase name="cases/dtype/tinyint.test" time="1.906">
        <failure type="0002" message="The actual result is not in accordance with the expectation.More,See the detail."><![CDATA[insert into t1 (tinyint8) values (-1),(127),(-128);

[EXPECT RESULT]:

[ACTUAL RESULT]:
unknown error:[42611]Field 'a' doesn't have a default value

select * from t1;

[EXPECT RESULT]:
a	tinyint8
1	-128
1	-1
1	127
[ACTUAL RESULT]:
a	tinyint8

select min(tinyint8),max(tinyint8),max(tinyint8)-1 from t1;

[EXPECT RESULT]:
min(tinyint8)	max(tinyint8)	max(tinyint8)-1
-128	127	126
[ACTUAL RESULT]:
min(tinyint8)	max(tinyint8)	max(tinyint8) - 1
null	null	null

select min(tinyint8),max(tinyint8),max(tinyint8)-1 from t1 group by a;

[EXPECT RESULT]:
min(tinyint8)	max(tinyint8)	max(tinyint8)-1
-128	127	126
[ACTUAL RESULT]:
min(tinyint8)	max(tinyint8)	max(tinyint8) - 1

insert into t1 (tinyint8) values (0),(255), (0xFE), (253);

[EXPECT RESULT]:

[ACTUAL RESULT]:
unknown error:[42611]Field 'a' doesn't have a default value

select * from t1;

[EXPECT RESULT]:
a	tinyint8
1	0
1	253
1	254
1	255
[ACTUAL RESULT]:
a	tinyint8

select * from t1 order by tinyint8 limit 1,3;

[EXPECT RESULT]:
a	tinyint8
1	253
1	254
1	255
[ACTUAL RESULT]:
a	tinyint8

select * from t1 order by tinyint8 limit 3 offset 1;

[EXPECT RESULT]:
a	tinyint8
1	253
1	254
1	255
[ACTUAL RESULT]:
a	tinyint8

select min(tinyint8),max(tinyint8),max(tinyint8)-1 from t1;

[EXPECT RESULT]:
min(tinyint8)	max(tinyint8)	max(tinyint8)-1
0	255	254
[ACTUAL RESULT]:
min(tinyint8)	max(tinyint8)	max(tinyint8) - 1
null	null	null

select min(tinyint8),max(tinyint8),max(tinyint8)-1 from t1 group by a;

[EXPECT RESULT]:
min(tinyint8)	max(tinyint8)	max(tinyint8)-1
0	255	254
[ACTUAL RESULT]:
min(tinyint8)	max(tinyint8)	max(tinyint8) - 1

select * from t2;

[EXPECT RESULT]:
valueu8	value8
5	-128
255	3
127	4
select * from t1 join t2 on t1.valueu8=t2.valueu8  order by 1 asc, t2.value8 desc;
valueu8	value8	valueu8	value8
5	-128	5	-128
127	2	127	4
255	1	255	3
select * from t1 join t2 on t1.valueu8=t2.valueu8 where t1.valueu8=255;
valueu8	value8	valueu8	value8
255	1	255	3
select * from t1 join t2 on t1.value8=t2.value8 order by 2;
valueu8	value8	valueu8	value8
5	-128	5	-128
drop table if exists t1;
drop table if exists t2;
create table t1 (tinyint8 tinyint not null);
insert into t1 values (-128);
select * from t1;
tinyint8
-128
drop table t1;
create table t1 (tinyint_col tinyint unsigned);
insert into t1 values (250);
select * from t1 where tinyint_col=250;
tinyint_col
250
select * from t1 where tinyint_col='250';
tinyint_col
250
drop table t1;
select cast(250 as unsigned) mod 50 as result;
result
0
select cast(127 as signed);
cast(127 as signed)
127
select cast(-128 as signed);
cast(-128 as signed)
-128
CREATE TABLE t1 (id TINYINT PRIMARY KEY,
a TINYINT(4) UNSIGNED,
b VARCHAR(4));
INSERT INTO t1 (id,a) VALUES
(1,0),
(2,CAST(0x7F AS UNSIGNED)),
(3,CAST(0x80 AS UNSIGNED)),
(4,CAST(0xFF AS UNSIGNED));
UPDATE t1 SET b = a;
select * from t1 where ((a = 255) and (b = '255')) order by 1 desc, 2 asc;
id	a	b
4	255	255
CREATE TABLE t_tinyint(id TINYINT);
INSERT INTO t_tinyint VALUES (1), (2);
SELECT id, id >= 1.1 FROM t_tinyint;
id	id >= 1.1
1	false	
2	true	
SELECT id, 1.1 <= id FROM t_tinyint;
id	1.1 <= id
1	false	
2	true	
SELECT id, id = 1.1 FROM t_tinyint;
id	id = 1.1
1	false	
2	false	
SELECT id, 1.1 = id FROM t_tinyint;
id	1.1 = id
1	false	
2	false	
SELECT * from t_tinyint WHERE id = 1.1;
id
SELECT * from t_tinyint WHERE id = 1.1e0;
id
SELECT * from t_tinyint WHERE id = '1.1';
id
SELECT * from t_tinyint WHERE id = '1.1e0';
id
SELECT * from t_tinyint WHERE id IN (1.1, 2.2);
id
SELECT * from t_tinyint WHERE id IN (1.1e0, 2.2e0);
id
SELECT * from t_tinyint WHERE id IN ('1.1', '2.2');
id
SELECT * from t_tinyint WHERE id IN ('1.1e0', '2.2e0');
id
SELECT * from t_tinyint WHERE id BETWEEN 1.1 AND 1.9;
id
SELECT * from t_tinyint WHERE id BETWEEN 1.1e0 AND 1.9e0;
id
SELECT * from t_tinyint WHERE id BETWEEN '1.1' AND '1.9';
id
SELECT * from t_tinyint WHERE id BETWEEN '1.1e0' AND '1.9e0';
id
drop table t1;
CREATE TABLE t1 (a TINYINT);
INSERT INTO t1 VALUES (1);
SELECT * FROM t1 WHERE coalesce(a) BETWEEN 0 and 0.9;
a
SELECT * FROM t1 WHERE coalesce(a)=0.9;
a
SELECT * FROM t1 WHERE coalesce(a) in (0.8,0.9);
a
SELECT * FROM t1 WHERE a BETWEEN 0 AND 0.9;
a
SELECT * FROM t1 WHERE a=0.9;
a
SELECT * FROM t1 WHERE a IN (0.8,0.9) order by 1;
a
drop table t1;
create table t (id tinyint unsigned, b tinyint);
insert into t values(127,1);
insert into t values(255,2);
insert into t values(128,3);
select count(*) from t
where id>=127 and id <=255 order by 1;
count(*)
3
select count(*) from t
where id between 127 and 255;
count(*)
3
drop table t;
SELECT (254 BETWEEN 0 AND 255);
(254 BETWEEN 0 AND 255)
true
SELECT  -32000 <= 0;
-32000 <= 0
true
SELECT 0 <= 127;
0 <= 127
ture
SELECT CAST(100 AS UNSIGNED) BETWEEN 1 AND -1;
CAST(100 AS UNSIGNED) BETWEEN 1 AND -1
false
SELECT CAST(100 AS UNSIGNED) NOT BETWEEN 1 AND -1;
CAST(100 AS UNSIGNED) NOT BETWEEN 1 AND -1
true
SELECT CAST(0 AS UNSIGNED) BETWEEN 0 AND -1;
CAST(0 AS UNSIGNED) BETWEEN 0 AND -1
false
SELECT CAST(0 AS UNSIGNED) NOT BETWEEN 0 AND -1;
CAST(0 AS UNSIGNED) NOT BETWEEN 0 AND -1
true
SELECT ( 255 BETWEEN 255 AND 255 );
( 255 BETWEEN 255 AND 255 )
true
SELECT ( 127 BETWEEN 255 AND 1 );
( 127 BETWEEN 255 AND 1 )
false
SELECT ( -1 BETWEEN 255 AND 1 );
( -1 BETWEEN 255 AND 1 )
false
SELECT ( 0 BETWEEN 255 AND 1 );
( 0 BETWEEN 255 AND 1 )
false
SELECT ( 1 BETWEEN 255 AND 1 );
( 1 BETWEEN 255 AND 1 )
false
drop table if exists t1;
drop table if exists t2;
drop table if exists t3;
drop table if exists t11;
drop table if exists t12;
CREATE TABLE t1 (a tinyint(3), b tinyint(5) primary key);
INSERT INTO t1 VALUES (1,1),(1,2);
update t1 set a=2 where a=1 limit 1;
select * from t1;
a	b
2	1
1	2
INSERT INTO t1 VALUES (1,3);
update t1 set a=2 where a=1;
select * from t1;
a	b
2	1
2	2
2	3
drop table t1;
create table t1 (
a tinyint not null,
b tinyint not null default 0,
c tinyint not null default 0,
d tinyint not null default 0,
e tinyint not null default 0,
f tinyint not null default 0,
g tinyint not null default 0,
h tinyint not null default 0,
i tinyint not null default 0,
j tinyint not null default 0,
primary key (a));
insert into t1 (a) values (2),(4),(6),(8),(10),(12),(14),(16),(18),(20),(22),(24),(26),(23);
update t1 set a=a+101;
select a,b from t1;
a	b
103	0
105	0
107	0
109	0
111	0
113	0
115	0
117	0
119	0
121	0
123	0
124	0
125	0
127	0
update t1 set a=127 where a=25;
select a,b from t1;
a	b
103	0
105	0
107	0
109	0
111	0
113	0
115	0
117	0
119	0
121	0
123	0
124	0
125	0
127	0
update t1 set a=a-1 where 1 > 2;
select a,b from t1;
a	b
103	0
105	0
107	0
109	0
111	0
113	0
115	0
117	0
119	0
121	0
123	0
124	0
125	0
127	0
update t1 set a=a-1 where 3 > 2;
select a,b from t1;
a	b
102	0
104	0
106	0
108	0
110	0
112	0
114	0
116	0
118	0
120	0
122	0
123	0
124	0
126	0
drop table t1;
create table t1 (a tinyint not null auto_increment primary key, b char(32));
insert into t1 (b) values ('apple'), ('apple');
select * from t1;
a	b
1	apple
2	apple
update t1, t1 as t2 set t1.a=t1.a*2 where t1.b = t2.b and t1.a > t2.a;
select * from t1;
a	b
1	apple
4	apple
drop table t1;
create table t11 (a tinyint NOT NULL, b int, primary key (a));
create table t12 (a tinyint NOT NULL, b int, primary key (a));
create table t2 (a tinyint NOT NULL, b int, primary key (a));
insert into t11 values (0, 10),(1, 11),(2, 12);
insert into t12 values (33, 10),(0, 11),(2, 12);
insert into t2 values (0, 21),(1, 12),(3, 23);
update t12 join t11 on t11.a = t12.a set t11.a=t12.a where t11.b <> (select b from t2 where t11.a = t2.a);
select * from t11;
a	b
0	10
1	11
2	12
select * from t12;
a	b
0	11
2	12
33	10
update t11,t12 set t11.a=t11.a+t11.b where t11.b <> (select b from t2 where t11.a = t2.a);
select * from t11;
a	b
2	12
10	10
12	11
drop table if exists t1;
drop table if exists t2;
CREATE TABLE t1(a tinyint PRIMARY KEY);
INSERT INTO t1 VALUES(10),(20);
CREATE TABLE t2(b tinyint);
INSERT INTO t2 VALUES(10),(20);
update t1 JOIN t2 on t1.a=t2.b set t1.a=5 WHERE t1.a = 10;
select * from t1;
a
5
20
select * from t2;
b
10
20
drop table t1;
CREATE TABLE t1 ( a tinyint PRIMARY KEY );
INSERT INTO t1 VALUES (0),(1),(2);
update t1 set a=a*10%3 WHERE t1.a > 0 ORDER BY t1.a LIMIT 1;
SELECT * FROM t1;
a
0
1
2
drop table if exists t1;
drop table if exists t2;
drop table if exists t3;
CREATE TABLE t1 (a tinyint not null,b tinyint not null, primary key (a));
CREATE TABLE t2 (a tinyint not null,b tinyint not null, primary key (a));
CREATE TABLE t3 (a tinyint not null,b tinyint not null, primary key (a));
insert into t1 values (1,1),(2,1),(4,3);
insert into t2 values (1,1),(2,2),(3,3);
insert into t3 values (1,1),(2,1),(4,3);
update t1 join t2 on t1.a=t2.a join t3 on t1.b=t3.b set t1.a=((t3.a*5) DIV 5) where t1.a=t2.a AND t2.b=t3.a and t1.b=t3.b;
select * from t1;
a	b
1	1
2	1
4	3
drop table t1;
create table t1(a tinyint not null);
insert into t1 values (0);
update t1 set a=a+(a MOD 2) where a is null;
select * from t1;
a
0
drop table if exists t1;
drop table if exists t2;
CREATE TABLE t1 (
a tinyint
);
CREATE TABLE t2 (
a tinyint
);
insert into t1 values(1),(2),(3),(4),(5);
insert into t2 values(1),(3),(5),(7),(9);
update t1 join t2 alias on t1.a=alias.a set alias.a=t1.a*3 WHERE t1.a = alias.a;
select * from t1;
a
1
2
3
4
5
drop table if exists t1;
drop table if exists t2;
create table t1 (id tinyint,ti tinyint unsigned,si tinyint,bi tinyint unsigned,fl float,dl double,de decimal,ch char(20),vch varchar(20),dd date,dt datetime);
insert into t1 values(1,1,4,3,1113.32,111332,1113.32,'hello','subquery','2022-04-28','2022-04-28 22:40:11');
insert into t1 values(2,2,5,2,2252.05,225205,2252.05,'bye','sub query','2022-04-28','2022-04-28 22:40:11');
insert into t1 values(3,6,6,3,3663.21,366321,3663.21,'hi','subquery','2022-04-28','2022-04-28 22:40:11');
insert into t1 values(4,7,1,5,4715.22,471522,4715.22,'good morning','my subquery','2022-04-28','2022-04-28 22:40:11');
insert into t1 values(5,1,2,6,51.26,5126,51.26,'byebye',' is subquery?','2022-04-28','2022-04-28 22:40:11');
insert into t1 values(6,3,2,1,632.1,6321,632.11,'good night','maybe subquery','2022-04-28','2022-04-28 22:40:11');
insert into t1 values(7,4,4,3,7443.11,744311,7443.11,'yes','subquery','2022-04-28','2022-04-28 22:40:11');
insert into t1 values(8,7,5,8,8758.00,875800,8758.11,'nice to meet','just subquery','2022-04-28','2022-04-28 22:40:11');
insert into t1 values(9,8,4,9,9849.312,9849312,9849.312,'see you','subquery','2022-04-28','2022-04-28 22:40:11');
update t1 sub set sub.id=id-99 where id > 4;
select count(*) from t1 where id>4;
count(*)
0
drop table if exists t1;
create table t1 (id tinyint,ti tinyint unsigned,si tinyint,bi tinyint unsigned,fl float,dl double,de decimal,ch char(20),vch varchar(20),dd date,dt datetime);
insert into t1 values(1,1,4,3,1113.32,111332,1113.32,'hello','subquery','2022-04-28','2022-04-28 22:40:11');
insert into t1 values(2,2,5,2,2252.05,225205,2252.05,'bye','sub query','2022-04-28','2022-04-28 22:40:11');
insert into t1 values(3,6,6,3,3663.21,366321,3663.21,'hi','subquery','2022-04-28','2022-04-28 22:40:11');
insert into t1 values(4,7,1,5,4715.22,471522,4715.22,'good morning','my subquery','2022-04-28','2022-04-28 22:40:11');
insert into t1 values(5,1,2,6,51.26,5126,51.26,'byebye',' is subquery?','2022-04-28','2022-04-28 22:40:11');
insert into t1 values(6,3,2,1,632.1,6321,632.11,'good night','maybe subquery','2022-04-28','2022-04-28 22:40:11');
insert into t1 values(7,4,4,3,7443.11,744311,7443.11,'yes','subquery','2022-04-28','2022-04-28 22:40:11');
insert into t1 values(8,7,5,8,8758.00,875800,8758.11,'nice to meet','just subquery','2022-04-28','2022-04-28 22:40:11');
insert into t1 values(9,8,4,9,9849.312,9849312,9849.312,'see you','subquery','2022-04-28','2022-04-28 22:40:11');
update t1 sub set sub.id=sub.id%4+sub.id where id < 4 || id > 5;
select * from t1 order by id+ti asc;
id	ti	si	bi	fl	dl	de	ch	vch	dd	dt
2	1	4	3	1113.32	111332	1113	hello	subquery	2022-04-28	2022-04-28 22:40:11
4	2	5	2	2252.05	225205	2252	bye	sub query	2022-04-28	2022-04-28 22:40:11
5	1	2	6	51.26	5126	51	byebye	 is subquery?	2022-04-28	2022-04-28 22:40:11
4	7	1	5	4715.22	471522	4715	good morning	my subquery	2022-04-28	2022-04-28 22:40:11
8	3	2	1	632.1	6321	632	good night	maybe subquery	2022-04-28	2022-04-28 22:40:11
6	6	6	3	3663.21	366321	3663	hi	subquery	2022-04-28	2022-04-28 22:40:11
10	4	4	3	7443.11	744311	7443	yes	subquery	2022-04-28	2022-04-28 22:40:11
8	7	5	8	8758	875800	8758	nice to meet	just subquery	2022-04-28	2022-04-28 22:40:11
10	8	4	9	9849.31	9849312	9849	see you	subquery	2022-04-28	2022-04-28 22:40:11
drop table if exists t1;
create table t1 (id tinyint,ti tinyint unsigned,si tinyint,bi tinyint unsigned,fl float,dl double,de decimal,ch char(20),vch varchar(20),dd date,dt datetime);
insert into t1 values(1,1,4,3,1113.32,111332,1113.32,'hello','subquery','2022-04-28','2022-04-28 22:40:11');
insert into t1 values(2,2,5,2,2252.05,225205,2252.05,'bye','sub query','2022-04-28','2022-04-28 22:40:11');
insert into t1 values(3,6,6,3,3663.21,366321,3663.21,'hi','subquery','2022-04-28','2022-04-28 22:40:11');
insert into t1 values(4,7,1,5,4715.22,471522,4715.22,'good morning','my subquery','2022-04-28','2022-04-28 22:40:11');
update t1,(select * from (select * from (select id,ti,si,de from (select * from t1 ) sub3 where fl <> 4.5 ) sub2 where ti > 1) sub1 where id >2 ) sub set t1.id=sub.id*10+t1.id where t1.id = 4;
select max(id) from t1;
max(id)
34
drop table if exists t1;
drop table if exists t2;
drop table if exists t3;
drop table if exists t4;
create table t1 (a tinyint);
create table t2 (a tinyint, b int);
create table t3 (a tinyint);
create table t4 (a tinyint not null, b int not null);
insert into t1 values (2);
insert into t2 values (1,7),(2,7);
insert into t4 values (4,8),(3,8),(5,9);
insert into t3 values (100),(8);
update t3,t2,t1 set t1.a=0 and t2.a=t2.a+t3.a where t3.a in (select b from t4 where b > 7);
select * from t1;
a
0
select * from t2;
a	b
1	7
2	7
drop table if exists t1;
drop table if exists t2;
drop table if exists t3;
drop table if exists t11;
drop table if exists t12;
CREATE TABLE t1 (a tinyint(3), b tinyint(5) primary key);
INSERT INTO t1 VALUES (1,1),(1,2);
delete from t1 where a=1 limit 1;
select * from t1;
a	b
1	2
INSERT INTO t1 VALUES (1,3);
delete from t1 where a=1;
select * from t1;
a	b
drop table t1;
create table t1 (
a tinyint not null,
b tinyint not null default 0,
c tinyint not null default 0,
d tinyint not null default 0,
e tinyint not null default 0,
f tinyint not null default 0,
g tinyint not null default 0,
h tinyint not null default 0,
i tinyint not null default 0,
j tinyint not null default 0,
primary key (a));
insert into t1 (a) values (2),(4),(6),(8),(10),(12),(14),(16),(18),(20),(22),(24),(26),(23);
delete from t1 where a=2+2;
select a,b from t1;
a	b
2	0
6	0
8	0
10	0
12	0
14	0
16	0
18	0
20	0
22	0
23	0
24	0
26	0
delete from t1 where  a=24;
select a,b from t1;
a	b
2	0
6	0
8	0
10	0
12	0
14	0
16	0
18	0
20	0
22	0
23	0
26	0
delete from t1 where  3 < 2;
select a,b from t1;
a	b
2	0
6	0
8	0
10	0
12	0
14	0
16	0
18	0
20	0
22	0
23	0
26	0
delete from t1 where  1 < 2;
select a,b from t1;
a	b
drop table t1;
create table t1 (a tinyint not null auto_increment primary key, b char(32));
insert into t1 (b) values ('apple'), ('apple');
select * from t1;
a	b
1	apple
2	apple
delete t1 from t1,t1 as t2 where t1.b = t2.b and t1.a > t2.a;
select * from t1;
a	b
1	apple
drop table t1;
create table t11 (a tinyint NOT NULL, b int, primary key (a));
create table t12 (a tinyint NOT NULL, b int, primary key (a));
create table t2 (a tinyint NOT NULL, b int, primary key (a));
insert into t11 values (0, 10),(1, 11),(2, 12);
insert into t12 values (33, 10),(0, 11),(2, 12);
insert into t2 values (0, 21),(1, 12),(3, 23);
delete from t11 where t11.b <> (select b from t2 where t11.a = t2.a);
select * from t11;
a	b
2	12
delete t11,t12 from t11,t12 where t11.b <> (select b from t2 where t11.a = t2.a) or t12.a>1;
select * from t11;
a	b
select * from t12;
a	b
0	11
drop table if exists t1;
drop table if exists t2;
CREATE TABLE t1(a tinyint PRIMARY KEY);
INSERT INTO t1 VALUES(10),(20);
CREATE TABLE t2(b tinyint);
INSERT INTO t2 VALUES(10),(20);
delete t1,t2 from t1 JOIN t2 on t1.a=t2.b WHERE t1.a = 10;
select * from t1;
a
20
select * from t2;
b
20
drop table if exists t1;
drop table if exists t2;
drop table if exists t3;
CREATE TABLE t1 (a tinyint not null,b tinyint not null, primary key (a));
CREATE TABLE t2 (a tinyint not null,b tinyint not null, primary key (a));
CREATE TABLE t3 (a tinyint not null,b tinyint not null, primary key (a));
insert into t1 values (1,1),(2,1),(4,3);
insert into t2 values (1,1),(2,2),(3,3);
insert into t3 values (1,1),(2,1),(4,3);
delete t1,t2,t3 from t1 join t2 on t1.a=t2.a join t3 on t1.b=t3.b where t1.a=t2.a AND t2.b=t3.a and t1.b=t3.b;
select * from t1;
a	b
4	3
drop table t1;
create table t1(a tinyint not null);
insert into t1 values (0);
delete t1 from t1 where a is null;
select * from t1;
a
0
drop table if exists t1;
drop table if exists t2;
CREATE TABLE t1 (
a tinyint
);
CREATE TABLE t2 (
a tinyint
);
insert into t1 values(1),(2),(3),(4),(5);
insert into t2 values(1),(3),(5),(7),(9);
delete alias from t1 join t2 alias on t1.a=alias.a+1 WHERE t1.a = alias.a;
select * from t2;
a
1
3
5
7
9
drop table if exists t1;
create table t1 (id tinyint,ti tinyint unsigned,si tinyint,bi tinyint unsigned,fl float,dl double,de decimal,ch char(20),vch varchar(20),dd date,dt datetime);
insert into t1 values(1,1,4,3,1113.32,111332,1113.32,'hello','subquery','2022-04-28','2022-04-28 22:40:11');
insert into t1 values(2,2,5,2,2252.05,225205,2252.05,'bye','sub query','2022-04-28','2022-04-28 22:40:11');
insert into t1 values(3,6,6,3,3663.21,366321,3663.21,'hi','subquery','2022-04-28','2022-04-28 22:40:11');
insert into t1 values(4,7,1,5,4715.22,471522,4715.22,'good morning','my subquery','2022-04-28','2022-04-28 22:40:11');
insert into t1 values(5,1,2,6,51.26,5126,51.26,'byebye',' is subquery?','2022-04-28','2022-04-28 22:40:11');
insert into t1 values(6,3,2,1,632.1,6321,632.11,'good night','maybe subquery','2022-04-28','2022-04-28 22:40:11');
insert into t1 values(7,4,4,3,7443.11,744311,7443.11,'yes','subquery','2022-04-28','2022-04-28 22:40:11');
insert into t1 values(8,7,5,8,8758.00,875800,8758.11,'nice to meet','just subquery','2022-04-28','2022-04-28 22:40:11');
insert into t1 values(9,8,4,9,9849.312,9849312,9849.312,'see you','subquery','2022-04-28','2022-04-28 22:40:11');
delete from t1 where id < 4 || id > 5;
select * from t1;
id	ti	si	bi	fl	dl	de	ch	vch	dd	dt
4	7	1	5	4715.22	471522	4715	good morning	my subquery	2022-04-28	2022-04-28 22:40:11
5	1	2	6	51.26	5126	51	byebye	 is subquery?	2022-04-28	2022-04-28 22:40:11
drop table if exists t1;
create table t1 (id tinyint,ti tinyint unsigned,si tinyint,bi tinyint unsigned,fl float,dl double,de decimal,ch char(20),vch varchar(20),dd date,dt datetime);
insert into t1 values(1,1,4,3,1113.32,111332,1113.32,'hello','subquery','2022-04-28','2022-04-28 22:40:11');
insert into t1 values(2,2,5,2,2252.05,225205,2252.05,'bye','sub query','2022-04-28','2022-04-28 22:40:11');
insert into t1 values(3,6,6,3,3663.21,366321,3663.21,'hi','subquery','2022-04-28','2022-04-28 22:40:11');
insert into t1 values(4,7,1,5,4715.22,471522,4715.22,'good morning','my subquery','2022-04-28','2022-04-28 22:40:11');
delete t1 from t1,((select * from (select * from (select id,ti,si,de from (select * from t1 ) sub3 where fl <> 4.5 ) sub2 where ti > 1) sub1 where id >2 )) sub2 where t1.id=sub2.id;
select id from t1;
id
1
2
drop table if exists t1;
drop table if exists t2;
drop table if exists t3;
drop table if exists t4;
create table t1 (a tinyint);
create table t2 (a tinyint, b int);
create table t3 (a tinyint);
create table t4 (a tinyint not null, b int not null);
insert into t1 values (2);
insert into t2 values (1,7),(2,7);
insert into t4 values (4,8),(3,8),(5,9);
insert into t3 values (100),(8);
delete t3 from t3,t4 where t3.a in (select b from t4 where b > 7);
select * from t3;
a
100
drop table if exists t1;
drop table if exists t2;
drop table if exists t3;
drop table if exists t11;
drop table if exists t12;
CREATE TABLE t1 (a tinyint(3), b tinyint(5) primary key);
INSERT INTO t1 VALUES (1,1),(1,2);
update t1 set a=2 where a=1 limit 1;
select * from t1;
a	b
2	1
1	2
INSERT INTO t1 VALUES (1,3);
update t1 set a=2 where a=1;
select * from t1;
a	b
2	1
2	2
2	3
drop table t1;
create table t1 (
a tinyint not null,
b tinyint not null default 0,
c tinyint not null default 0,
d tinyint not null default 0,
e tinyint not null default 0,
f tinyint not null default 0,
g tinyint not null default 0,
h tinyint not null default 0,
i tinyint not null default 0,
j tinyint not null default 0,
primary key (a));
insert into t1 (a) values (2),(4),(6),(8),(10),(12),(14),(16),(18),(20),(22),(24),(26),(23);
update t1 set a=a+101;
select a,b from t1;
a	b
103	0
105	0
107	0
109	0
111	0
113	0
115	0
117	0
119	0
121	0
123	0
124	0
125	0
127	0
update t1 set a=127 where a=25;
select a,b from t1;
a	b
103	0
105	0
107	0
109	0
111	0
113	0
115	0
117	0
119	0
121	0
123	0
124	0
125	0
127	0
update t1 set a=a-1 where 1 > 2;
select a,b from t1;
a	b
103	0
105	0
107	0
109	0
111	0
113	0
115	0
117	0
119	0
121	0
123	0
124	0
125	0
127	0
update t1 set a=a-1 where 3 > 2;
select a,b from t1;
a	b
102	0
104	0
106	0
108	0
110	0
112	0
114	0
116	0
118	0
120	0
122	0
123	0
124	0
126	0
drop table t1;
create table t1 (a tinyint not null auto_increment primary key, b char(32));
insert into t1 (b) values ('apple'), ('apple');
select * from t1;
a	b
1	apple
2	apple
update t1, t1 as t2 set t1.a=t1.a*2 where t1.b = t2.b and t1.a > t2.a;
select * from t1;
a	b
1	apple
4	apple
drop table t1;
create table t11 (a tinyint NOT NULL, b int, primary key (a));
create table t12 (a tinyint NOT NULL, b int, primary key (a));
create table t2 (a tinyint NOT NULL, b int, primary key (a));
insert into t11 values (0, 10),(1, 11),(2, 12);
insert into t12 values (33, 10),(0, 11),(2, 12);
insert into t2 values (0, 21),(1, 12),(3, 23);
update t12 join t11 on t11.a = t12.a set t11.a=t12.a where t11.b <> (select b from t2 where t11.a = t2.a);
select * from t11;
a	b
0	10
1	11
2	12
select * from t12;
a	b
0	11
2	12
33	10
update t11,t12 set t11.a=t11.a+t11.b where t11.b <> (select b from t2 where t11.a = t2.a);
select * from t11;
a	b
2	12
10	10
12	11
drop table if exists t1;
drop table if exists t2;
CREATE TABLE t1(a tinyint PRIMARY KEY);
INSERT INTO t1 VALUES(10),(20);
CREATE TABLE t2(b tinyint);
INSERT INTO t2 VALUES(10),(20);
update t1 JOIN t2 on t1.a=t2.b set t1.a=5 WHERE t1.a = 10;
select * from t1;
a
5
20
select * from t2;
b
10
20
drop table t1;
CREATE TABLE t1 ( a tinyint PRIMARY KEY );
INSERT INTO t1 VALUES (0),(1),(2);
update t1 set a=a*10%3 WHERE t1.a > 0 ORDER BY t1.a LIMIT 1;
SELECT * FROM t1;
a
0
1
2
drop table if exists t1;
drop table if exists t2;
drop table if exists t3;
CREATE TABLE t1 (a tinyint not null,b tinyint not null, primary key (a));
CREATE TABLE t2 (a tinyint not null,b tinyint not null, primary key (a));
CREATE TABLE t3 (a tinyint not null,b tinyint not null, primary key (a));
insert into t1 values (1,1),(2,1),(4,3);
insert into t2 values (1,1),(2,2),(3,3);
insert into t3 values (1,1),(2,1),(4,3);
update t1 join t2 on t1.a=t2.a join t3 on t1.b=t3.b set t1.a=((t3.a*5) DIV 5) where t1.a=t2.a AND t2.b=t3.a and t1.b=t3.b;
select * from t1;
a	b
1	1
2	1
4	3
drop table t1;
create table t1(a tinyint not null);
insert into t1 values (0);
update t1 set a=a+(a MOD 2) where a is null;
select * from t1;
a
0
drop table if exists t1;
drop table if exists t2;
CREATE TABLE t1 (
a tinyint
);
CREATE TABLE t2 (
a tinyint
);
insert into t1 values(1),(2),(3),(4),(5);
insert into t2 values(1),(3),(5),(7),(9);
update t1 join t2 alias on t1.a=alias.a set alias.a=t1.a*3 WHERE t1.a = alias.a;
drop table if exists t1;
drop table if exists t2;
create table t1 (id tinyint,ti tinyint unsigned,si tinyint,bi tinyint unsigned,fl float,dl double,de decimal,ch char(20),vch varchar(20),dd date,dt datetime);
insert into t1 values(1,1,4,3,1113.32,111332,1113.32,'hello','subquery','2022-04-28','2022-04-28 22:40:11');
insert into t1 values(2,2,5,2,2252.05,225205,2252.05,'bye','sub query','2022-04-28','2022-04-28 22:40:11');
insert into t1 values(3,6,6,3,3663.21,366321,3663.21,'hi','subquery','2022-04-28','2022-04-28 22:40:11');
insert into t1 values(4,7,1,5,4715.22,471522,4715.22,'good morning','my subquery','2022-04-28','2022-04-28 22:40:11');
insert into t1 values(5,1,2,6,51.26,5126,51.26,'byebye',' is subquery?','2022-04-28','2022-04-28 22:40:11');
insert into t1 values(6,3,2,1,632.1,6321,632.11,'good night','maybe subquery','2022-04-28','2022-04-28 22:40:11');
insert into t1 values(7,4,4,3,7443.11,744311,7443.11,'yes','subquery','2022-04-28','2022-04-28 22:40:11');
insert into t1 values(8,7,5,8,8758.00,875800,8758.11,'nice to meet','just subquery','2022-04-28','2022-04-28 22:40:11');
insert into t1 values(9,8,4,9,9849.312,9849312,9849.312,'see you','subquery','2022-04-28','2022-04-28 22:40:11');
update t1 sub set sub.id=id-99 where id > 4;
select count(*) from t1 where id>4;
count(*)
0
drop table if exists t1;
create table t1 (id tinyint,ti tinyint unsigned,si tinyint,bi tinyint unsigned,fl float,dl double,de decimal,ch char(20),vch varchar(20),dd date,dt datetime);
insert into t1 values(1,1,4,3,1113.32,111332,1113.32,'hello','subquery','2022-04-28','2022-04-28 22:40:11');
insert into t1 values(2,2,5,2,2252.05,225205,2252.05,'bye','sub query','2022-04-28','2022-04-28 22:40:11');
insert into t1 values(3,6,6,3,3663.21,366321,3663.21,'hi','subquery','2022-04-28','2022-04-28 22:40:11');
insert into t1 values(4,7,1,5,4715.22,471522,4715.22,'good morning','my subquery','2022-04-28','2022-04-28 22:40:11');
insert into t1 values(5,1,2,6,51.26,5126,51.26,'byebye',' is subquery?','2022-04-28','2022-04-28 22:40:11');
insert into t1 values(6,3,2,1,632.1,6321,632.11,'good night','maybe subquery','2022-04-28','2022-04-28 22:40:11');
insert into t1 values(7,4,4,3,7443.11,744311,7443.11,'yes','subquery','2022-04-28','2022-04-28 22:40:11');
insert into t1 values(8,7,5,8,8758.00,875800,8758.11,'nice to meet','just subquery','2022-04-28','2022-04-28 22:40:11');
insert into t1 values(9,8,4,9,9849.312,9849312,9849.312,'see you','subquery','2022-04-28','2022-04-28 22:40:11');
update t1 sub set sub.id=sub.id%4+sub.id where id < 4 || id > 5;
select * from t1;
id	ti	si	bi	fl	dl	de	ch	vch	dd	dt
2	1	4	3	1113.32	111332	1113	hello	subquery	2022-04-28	2022-04-28 22:40:11
4	2	5	2	2252.05	225205	2252	bye	sub query	2022-04-28	2022-04-28 22:40:11
6	6	6	3	3663.21	366321	3663	hi	subquery	2022-04-28	2022-04-28 22:40:11
4	7	1	5	4715.22	471522	4715	good morning	my subquery	2022-04-28	2022-04-28 22:40:11
5	1	2	6	51.26	5126	51	byebye	 is subquery?	2022-04-28	2022-04-28 22:40:11
8	3	2	1	632.1	6321	632	good night	maybe subquery	2022-04-28	2022-04-28 22:40:11
10	4	4	3	7443.11	744311	7443	yes	subquery	2022-04-28	2022-04-28 22:40:11
8	7	5	8	8758	875800	8758	nice to meet	just subquery	2022-04-28	2022-04-28 22:40:11
10	8	4	9	9849.31	9849312	9849	see you	subquery	2022-04-28	2022-04-28 22:40:11
drop table if exists t1;
create table t1 (id tinyint,ti tinyint unsigned,si tinyint,bi tinyint unsigned,fl float,dl double,de decimal,ch char(20),vch varchar(20),dd date,dt datetime);
insert into t1 values(1,1,4,3,1113.32,111332,1113.32,'hello','subquery','2022-04-28','2022-04-28 22:40:11');
insert into t1 values(2,2,5,2,2252.05,225205,2252.05,'bye','sub query','2022-04-28','2022-04-28 22:40:11');
insert into t1 values(3,6,6,3,3663.21,366321,3663.21,'hi','subquery','2022-04-28','2022-04-28 22:40:11');
insert into t1 values(4,7,1,5,4715.22,471522,4715.22,'good morning','my subquery','2022-04-28','2022-04-28 22:40:11');
update t1,(select * from (select * from (select id,ti,si,de from (select * from t1 ) sub3 where fl <> 4.5 ) sub2 where ti > 1) sub1 where id >2 ) sub set t1.id=sub.id*10+t1.id where t1.id = 4;
select max(id) from t1;
max(id)
34
drop table if exists t1;
drop table if exists t2;
drop table if exists t3;
drop table if exists t4;
create table t1 (a tinyint);
create table t2 (a tinyint, b int);
create table t3 (a tinyint);
create table t4 (a tinyint not null, b int not null);
insert into t1 values (2);
insert into t2 values (1,7),(2,7);
insert into t4 values (4,8),(3,8),(5,9);
insert into t3 values (100),(8);
update t3,t2,t1 set t1.a=0 and t2.a=t2.a+t3.a where t3.a in (select b from t4 where b > 7);
select * from t1;
a
0
select * from t2;
a	b
1	7
2	7
drop table if exists t1;
drop table if exists t2;
drop table if exists t3;
drop table if exists t11;
drop table if exists t12;
CREATE TABLE t1 (a tinyint(3), b tinyint(5) primary key);
INSERT INTO t1 VALUES (1,1),(1,2);
delete from t1 where a=1 limit 1;
select * from t1;
a	b
1	2
INSERT INTO t1 VALUES (1,3);
delete from t1 where a=1;
select * from t1;
a	b
drop table t1;
create table t1 (
a tinyint not null,
b tinyint not null default 0,
c tinyint not null default 0,
d tinyint not null default 0,
e tinyint not null default 0,
f tinyint not null default 0,
g tinyint not null default 0,
h tinyint not null default 0,
i tinyint not null default 0,
j tinyint not null default 0,
primary key (a));
insert into t1 (a) values (2),(4),(6),(8),(10),(12),(14),(16),(18),(20),(22),(24),(26),(23);
delete from t1 where a=2+2;
select a,b from t1;
a	b
2	0
6	0
8	0
10	0
12	0
14	0
16	0
18	0
20	0
22	0
23	0
24	0
26	0
delete from t1 where  a=24;
select a,b from t1;
a	b
2	0
6	0
8	0
10	0
12	0
14	0
16	0
18	0
20	0
22	0
23	0
26	0
delete from t1 where  3 < 2;
select a,b from t1;
a	b
2	0
6	0
8	0
10	0
12	0
14	0
16	0
18	0
20	0
22	0
23	0
26	0
delete from t1 where  1 < 2;
select a,b from t1;
a	b
drop table t1;
create table t1 (a tinyint not null auto_increment primary key, b char(32));
insert into t1 (b) values ('apple'), ('apple');
select * from t1;
a	b
1	apple
2	apple
delete t1 from t1,t1 as t2 where t1.b = t2.b and t1.a > t2.a;
select * from t1;
a	b
1	apple
drop table t1;
create table t11 (a tinyint NOT NULL, b int, primary key (a));
create table t12 (a tinyint NOT NULL, b int, primary key (a));
create table t2 (a tinyint NOT NULL, b int, primary key (a));
insert into t11 values (0, 10),(1, 11),(2, 12);
insert into t12 values (33, 10),(0, 11),(2, 12);
insert into t2 values (0, 21),(1, 12),(3, 23);
delete from t11 where t11.b <> (select b from t2 where t11.a = t2.a);
select * from t11;
a	b
2	12
delete t11,t12 from t11,t12 where t11.b <> (select b from t2 where t11.a = t2.a) or t12.a>1;
select * from t11;
a	b
select * from t12;
a	b
0	11
drop table if exists t1;
drop table if exists t2;
CREATE TABLE t1(a tinyint PRIMARY KEY);
INSERT INTO t1 VALUES(10),(20);
CREATE TABLE t2(b tinyint);
INSERT INTO t2 VALUES(10),(20);
delete t1,t2 from t1 JOIN t2 on t1.a=t2.b WHERE t1.a = 10;
select * from t1;
a
20
select * from t2;
b
20
drop table if exists t1;
drop table if exists t2;
drop table if exists t3;
CREATE TABLE t1 (a tinyint not null,b tinyint not null, primary key (a));
CREATE TABLE t2 (a tinyint not null,b tinyint not null, primary key (a));
CREATE TABLE t3 (a tinyint not null,b tinyint not null, primary key (a));
insert into t1 values (1,1),(2,1),(4,3);
insert into t2 values (1,1),(2,2),(3,3);
insert into t3 values (1,1),(2,1),(4,3);
delete t1,t2,t3 from t1 join t2 on t1.a=t2.a join t3 on t1.b=t3.b where t1.a=t2.a AND t2.b=t3.a and t1.b=t3.b;
select * from t1;
a	b
4	3
drop table t1;
create table t1(a tinyint not null);
insert into t1 values (0);
delete t1 from t1 where a is null;
select * from t1;
a
0
drop table if exists t1;
drop table if exists t2;
CREATE TABLE t1 (
a tinyint
);
CREATE TABLE t2 (
a tinyint
);
insert into t1 values(1),(2),(3),(4),(5);
insert into t2 values(1),(3),(5),(7),(9);
delete alias from t1 join t2 alias on t1.a=alias.a+1 WHERE t1.a = alias.a;
select * from t2;
a
1
3
5
7
9
drop table if exists t1;
create table t1 (id tinyint,ti tinyint unsigned,si tinyint,bi tinyint unsigned,fl float,dl double,de decimal,ch char(20),vch varchar(20),dd date,dt datetime);
insert into t1 values(1,1,4,3,1113.32,111332,1113.32,'hello','subquery','2022-04-28','2022-04-28 22:40:11');
insert into t1 values(2,2,5,2,2252.05,225205,2252.05,'bye','sub query','2022-04-28','2022-04-28 22:40:11');
insert into t1 values(3,6,6,3,3663.21,366321,3663.21,'hi','subquery','2022-04-28','2022-04-28 22:40:11');
insert into t1 values(4,7,1,5,4715.22,471522,4715.22,'good morning','my subquery','2022-04-28','2022-04-28 22:40:11');
insert into t1 values(5,1,2,6,51.26,5126,51.26,'byebye',' is subquery?','2022-04-28','2022-04-28 22:40:11');
insert into t1 values(6,3,2,1,632.1,6321,632.11,'good night','maybe subquery','2022-04-28','2022-04-28 22:40:11');
insert into t1 values(7,4,4,3,7443.11,744311,7443.11,'yes','subquery','2022-04-28','2022-04-28 22:40:11');
insert into t1 values(8,7,5,8,8758.00,875800,8758.11,'nice to meet','just subquery','2022-04-28','2022-04-28 22:40:11');
insert into t1 values(9,8,4,9,9849.312,9849312,9849.312,'see you','subquery','2022-04-28','2022-04-28 22:40:11');
delete from t1 where id < 4 || id > 5;
select * from t1;
id	ti	si	bi	fl	dl	de	ch	vch	dd	dt
4	7	1	5	4715.22	471522	4715	good morning	my subquery	2022-04-28	2022-04-28 22:40:11
5	1	2	6	51.26	5126	51	byebye	 is subquery?	2022-04-28	2022-04-28 22:40:11
drop table if exists t1;
create table t1 (id tinyint,ti tinyint unsigned,si tinyint,bi tinyint unsigned,fl float,dl double,de decimal,ch char(20),vch varchar(20),dd date,dt datetime);
insert into t1 values(1,1,4,3,1113.32,111332,1113.32,'hello','subquery','2022-04-28','2022-04-28 22:40:11');
insert into t1 values(2,2,5,2,2252.05,225205,2252.05,'bye','sub query','2022-04-28','2022-04-28 22:40:11');
insert into t1 values(3,6,6,3,3663.21,366321,3663.21,'hi','subquery','2022-04-28','2022-04-28 22:40:11');
insert into t1 values(4,7,1,5,4715.22,471522,4715.22,'good morning','my subquery','2022-04-28','2022-04-28 22:40:11');
delete t1 from t1,((select * from (select * from (select id,ti,si,de from (select * from t1 ) sub3 where fl <> 4.5 ) sub2 where ti > 1) sub1 where id >2 )) sub2 where t1.id=sub2.id;
select id from t1;
id
1
2
drop table if exists t1;
drop table if exists t2;
drop table if exists t3;
drop table if exists t4;
create table t1 (a tinyint);
create table t2 (a tinyint, b int);
create table t3 (a tinyint);
create table t4 (a tinyint not null, b int not null);
insert into t1 values (2);
insert into t2 values (1,7),(2,7);
insert into t4 values (4,8),(3,8),(5,9);
insert into t3 values (100),(8);
delete t3 from t3,t4 where t3.a in (select b from t4 where b > 7);
select * from t3;
a
100
[ACTUAL RESULT]:
valueu8	value8
255	3
127	4
5	-128

select * from t1 join t2 on t1.valueu8=t2.valueu8  order by 1 asc, t2.value8 desc;;

[EXPECT RESULT]:

[ACTUAL RESULT]:
unknown error:Internal error: panic runtime error: index out of range [1] with length 1: goroutine 503253 [running]:
runtime/debug.Stack()
	/usr/lib/golang/src/runtime/debug/stack.go:24 +0x65
github.com/matrixorigin/matrixone/pkg/common/moerr.NewPanicError({0x2d6da80?, 0xc10b81c618})
	/data/zhangxiao/matrixone/pkg/common/moerr/error.go:77 +0x53
github.com/matrixorigin/matrixone/pkg/vm/overload.Run.func1()
	/data/zhangxiao/matrixone/pkg/vm/overload/run.go:50 +0x31
panic({0x2d6da80, 0xc10b81c618})
	/usr/lib/golang/src/runtime/panic.go:838 +0x207
github.com/matrixorigin/matrixone/pkg/sort/asc/int64s.insertionSort(...)
	/data/zhangxiao/matrixone/pkg/sort/asc/int64s/sort.go:60
github.com/matrixorigin/matrixone/pkg/sort/asc/int64s.quickSort({0xc04c3d6b28?, 0x1, 0x1}, {0xc10b81c5e8?, 0x3, 0x3}, 0x7?, 0x0?, 0x0?)
	/data/zhangxiao/matrixone/pkg/sort/asc/int64s/sort.go:53 +0x27b
github.com/matrixorigin/matrixone/pkg/sort/asc/int64s.Sort({0xc04c3d6b28?, 0x7f6778881f18?, 0x18?}, {0xc10b81c5e8?, 0xc10b81c5e8?, 0x0?})
	/data/zhangxiao/matrixone/pkg/sort/asc/int64s/sort.go:14 +0x45
github.com/matrixorigin/matrixone/pkg/sort.Sort(0xc0?, {0xc10b81c5e8?, 0xc0dd1de3c0?, 0x1?}, 0x231f90f?)
	/data/zhangxiao/matrixone/pkg/sort/sort.go:89 +0x2e8
github.com/matrixorigin/matrixone/pkg/sql/colexec2/order.(*Container).process(0xc0c0446030, 0xc0e90ac460?, 0xc0dd1de3c0, 0xc21409b1e0)
	/data/zhangxiao/matrixone/pkg/sql/colexec2/order/order.go:98 +0x154
github.com/matrixorigin/matrixone/pkg/sql/colexec2/order.Call(0xc21409b1e0?, {0x2aaf860?, 0xc0c04420c0?})
	/data/zhangxiao/matrixone/pkg/sql/colexec2/order/order.go:62 +0x53
github.com/matrixorigin/matrixone/pkg/vm/overload.Run({0xc4b6db7f20?, 0x4, 0x7f65ec11ac40?}, 0x420?)
	/data/zhangxiao/matrixone/pkg/vm/overload/run.go:55 +0xee
github.com/matrixorigin/matrixone/pkg/vm/pipeline2.(*Pipeline).MergeRun(0xc0cd994c30, 0xc21409b1e0)
	/data/zhangxiao/matrixone/pkg/vm/pipeline2/pipeline.go:130 +0x1af
github.com/matrixorigin/matrixone/pkg/sql/compile2.(*Scope).MergeRun(0xc21a4dd860, {0x322c400?, 0xc000010028})
	/data/zhangxiao/matrixone/pkg/sql/compile2/scope.go:306 +0x574
github.com/matrixorigin/matrixone/pkg/sql/compile2.(*Scope).DispatchRun(0xc21a4dd860, {0x322c400, 0xc000010028})
	/data/zhangxiao/matrixone/pkg/sql/compile2/scope.go:368 +0x8d4
github.com/matrixorigin/matrixone/pkg/sql/compile2.(*Scope).ParallelRun(0x3?, {0x322c400?, 0xc000010028?})
	/data/zhangxiao/matrixone/pkg/sql/compile2/scope.go:381 +0x1af
github.com/matrixorigin/matrixone/pkg/sql/compile2.(*Scope).RemoteRun(0xc30166c460?, {0x322c400?, 0xc000010028?})
	/data/zhangxiao/matrixone/pkg/sql/compile2/scope.go:373 +0x25
github.com/matrixorigin/matrixone/pkg/sql/compile2.(*Scope).MergeRun.func3(0xc061b127a0?)
	/data/zhangxiao/matrixone/pkg/sql/compile2/scope.go:293 +0x79
created by github.com/matrixorigin/matrixone/pkg/sql/compile2.(*Scope).MergeRun
	/data/zhangxiao/matrixone/pkg/sql/compile2/scope.go:288 +0x4ed


select * from t1 join t2 on t1.valueu8=t2.valueu8 where t1.valueu8=255;

[EXPECT RESULT]:

[ACTUAL RESULT]:
valueu8	value8	valueu8	value8
255	1	255	1

select * from t1 join t2 on t1.value8=t2.value8 order by 2;

[EXPECT RESULT]:

[ACTUAL RESULT]:
valueu8	value8	valueu8	value8
5	-128	5	-128

select * from t1;

[EXPECT RESULT]:

[ACTUAL RESULT]:
tinyint8
-128

select * from t1 where tinyint_col=250;

[EXPECT RESULT]:

[ACTUAL RESULT]:
tinyint_col
250

select * from t1 where tinyint_col='250';

[EXPECT RESULT]:

[ACTUAL RESULT]:
unknown error:[42883]undefined function =[TINYINT UNSIGNED VARCHAR]

select cast(250 as unsigned) mod 50 as result;

[EXPECT RESULT]:

[ACTUAL RESULT]:
result
0.0

select cast(127 as signed);

[EXPECT RESULT]:

[ACTUAL RESULT]:
cast(127 as signed)
127

select cast(-128 as signed);

[EXPECT RESULT]:

[ACTUAL RESULT]:
cast(-128 as signed)
-128

INSERT INTO t1 (id,a) VALUES
(1,0),
(2,CAST(0x7F AS UNSIGNED)),
(3,CAST(0x80 AS UNSIGNED)),
(4,CAST(0xFF AS UNSIGNED));

[EXPECT RESULT]:

[ACTUAL RESULT]:
unknown error:[42611]Field 'b' doesn't have a default value

SELECT id, id >= 1.1 FROM t_tinyint;

[EXPECT RESULT]:

[ACTUAL RESULT]:
id	id >= 1.1
1	false
2	true

SELECT id, 1.1 <= id FROM t_tinyint;

[EXPECT RESULT]:

[ACTUAL RESULT]:
id	1.1 <= id
1	false
2	true

SELECT id, id = 1.1 FROM t_tinyint;

[EXPECT RESULT]:

[ACTUAL RESULT]:
id	id = 1.1
1	false
2	false

SELECT id, 1.1 = id FROM t_tinyint;

[EXPECT RESULT]:

[ACTUAL RESULT]:
id	1.1 = id
1	false
2	false

SELECT * from t_tinyint WHERE id = 1.1;

[EXPECT RESULT]:

[ACTUAL RESULT]:
id

SELECT * from t_tinyint WHERE id = 1.1e0;

[EXPECT RESULT]:

[ACTUAL RESULT]:
id

SELECT * from t_tinyint WHERE id = '1.1';

[EXPECT RESULT]:

[ACTUAL RESULT]:
unknown error:[42883]undefined function =[TINYINT VARCHAR]

SELECT * from t_tinyint WHERE id = '1.1e0';

[EXPECT RESULT]:

[ACTUAL RESULT]:
unknown error:[42883]undefined function =[TINYINT VARCHAR]

SELECT * from t_tinyint WHERE id IN (1.1, 2.2);

[EXPECT RESULT]:

[ACTUAL RESULT]:
id

SELECT * from t_tinyint WHERE id IN (1.1e0, 2.2e0);

[EXPECT RESULT]:

[ACTUAL RESULT]:
id

SELECT * from t_tinyint WHERE id IN ('1.1', '2.2');

[EXPECT RESULT]:

[ACTUAL RESULT]:
unknown error:[42883]undefined function =[TINYINT VARCHAR]

SELECT * from t_tinyint WHERE id IN ('1.1e0', '2.2e0');

[EXPECT RESULT]:

[ACTUAL RESULT]:
unknown error:[42883]undefined function =[TINYINT VARCHAR]

SELECT * from t_tinyint WHERE id BETWEEN 1.1 AND 1.9;

[EXPECT RESULT]:

[ACTUAL RESULT]:
id

SELECT * from t_tinyint WHERE id BETWEEN 1.1e0 AND 1.9e0;

[EXPECT RESULT]:

[ACTUAL RESULT]:
id

SELECT * from t_tinyint WHERE id BETWEEN '1.1' AND '1.9';

[EXPECT RESULT]:

[ACTUAL RESULT]:
unknown error:[42883]undefined function >=[TINYINT VARCHAR]

SELECT * from t_tinyint WHERE id BETWEEN '1.1e0' AND '1.9e0';

[EXPECT RESULT]:

[ACTUAL RESULT]:
unknown error:[42883]undefined function >=[TINYINT VARCHAR]

SELECT * FROM t1 WHERE coalesce(a) BETWEEN 0 and 0.9;

[EXPECT RESULT]:

[ACTUAL RESULT]:
unknown error:[42883]function 'coalesce' doesn't register, get id failed

SELECT * FROM t1 WHERE coalesce(a)=0.9;

[EXPECT RESULT]:

[ACTUAL RESULT]:
unknown error:[42883]function 'coalesce' doesn't register, get id failed

SELECT * FROM t1 WHERE coalesce(a) in (0.8,0.9);

[EXPECT RESULT]:

[ACTUAL RESULT]:
unknown error:[42883]function 'coalesce' doesn't register, get id failed

SELECT * FROM t1 WHERE a BETWEEN 0 AND 0.9;

[EXPECT RESULT]:

[ACTUAL RESULT]:
a

SELECT * FROM t1 WHERE a=0.9;

[EXPECT RESULT]:

[ACTUAL RESULT]:
a

SELECT * FROM t1 WHERE a IN (0.8,0.9) order by 1;

[EXPECT RESULT]:

[ACTUAL RESULT]:
a

select count(*) from t
where id>=127 and id <=255 order by 1;

[EXPECT RESULT]:

[ACTUAL RESULT]:
unknown error:[42P10]column 'id' does not exist

select count(*) from t
where id between 127 and 255;

[EXPECT RESULT]:

[ACTUAL RESULT]:
count(id)
3

SELECT (254 BETWEEN 0 AND 255);

[EXPECT RESULT]:

[ACTUAL RESULT]:
(254 between 0 and 255)
false

SELECT  -32000 <= 0;

[EXPECT RESULT]:

[ACTUAL RESULT]:
-32000 <= 0
false

SELECT 0 <= 127;

[EXPECT RESULT]:

[ACTUAL RESULT]:
0 <= 127
false

SELECT CAST(100 AS UNSIGNED) BETWEEN 1 AND -1;

[EXPECT RESULT]:

[ACTUAL RESULT]:
cast(100 as unsigned unsigned) between 1 and -1
true

SELECT CAST(100 AS UNSIGNED) NOT BETWEEN 1 AND -1;

[EXPECT RESULT]:

[ACTUAL RESULT]:
cast(100 as unsigned unsigned) not between 1 and -1
true

SELECT CAST(0 AS UNSIGNED) BETWEEN 0 AND -1;

[EXPECT RESULT]:

[ACTUAL RESULT]:
cast(0 as unsigned unsigned) between 0 and -1
true

SELECT CAST(0 AS UNSIGNED) NOT BETWEEN 0 AND -1;

[EXPECT RESULT]:

[ACTUAL RESULT]:
cast(0 as unsigned unsigned) not between 0 and -1
true

SELECT ( 255 BETWEEN 255 AND 255 );

[EXPECT RESULT]:

[ACTUAL RESULT]:
(255 between 255 and 255)
true

SELECT ( 127 BETWEEN 255 AND 1 );

[EXPECT RESULT]:

[ACTUAL RESULT]:
(127 between 255 and 1)
false

SELECT ( -1 BETWEEN 255 AND 1 );

[EXPECT RESULT]:

[ACTUAL RESULT]:
(-1 between 255 and 1)
false

SELECT ( 0 BETWEEN 255 AND 1 );

[EXPECT RESULT]:

[ACTUAL RESULT]:
(0 between 255 and 1)
false

SELECT ( 1 BETWEEN 255 AND 1 );

[EXPECT RESULT]:

[ACTUAL RESULT]:
(1 between 255 and 1)
false

insert into t1 (a) values (2),(4),(6),(8),(10),(12),(14),(16),(18),(20),(22),(24),(26),(23);

[EXPECT RESULT]:

[ACTUAL RESULT]:
unknown error:[42611]Field 'b' doesn't have a default value

insert into t1 (b) values ('apple'), ('apple');

[EXPECT RESULT]:

[ACTUAL RESULT]:
unknown error:[42611]Field 'a' doesn't have a default value

select * from t1;

[EXPECT RESULT]:

[ACTUAL RESULT]:
a	b

insert into t1 (a) values (2),(4),(6),(8),(10),(12),(14),(16),(18),(20),(22),(24),(26),(23);

[EXPECT RESULT]:

[ACTUAL RESULT]:
unknown error:[42611]Field 'b' doesn't have a default value

insert into t1 (b) values ('apple'), ('apple');

[EXPECT RESULT]:

[ACTUAL RESULT]:
unknown error:[42611]Field 'a' doesn't have a default value

select * from t1;

[EXPECT RESULT]:

[ACTUAL RESULT]:
a	b

]]></failure>
    </testcase>
    <testcase name="cases/dtype/varchar.test" time="2.468">
        <failure type="0002" message="The actual result is not in accordance with the expectation.More,See the detail."><![CDATA[select * from t1 where a like 'ab\_def';

[EXPECT RESULT]:
a
ab_def
[ACTUAL RESULT]:
a
abcdef
ab_def

select * from t1 where a like "\__cdef";

[EXPECT RESULT]:
a
_bcdef
[ACTUAL RESULT]:
a
abcdef
_bcdef
a_cdef

select * from t1 where a not like "%d_\_";

[EXPECT RESULT]:
a
abcdef
_bcdef
a_cdef
ab_def
abc_ef
abcd_f
[ACTUAL RESULT]:
a
abc_ef

SELECT * FROM Demovarchar;

[EXPECT RESULT]:
LastName	FirstName	Gender	DepartmentName	Age
Gilbert	Kevin	M	Tool Design	33
Johnson	David	M	Engineering	66
Martin	Kelly	F	Information Services	54
Poland	Carole	F	Production Control	29
Rapier	Abigail	F	Human Resources	38
Sharma	Bradley	M	Production	27
Tamburello	Andrea	F	Marketing	45
select concat_ws(LastName,FirstName) from Demovarchar where Age > 40 order by 1 asc;
concat_ws(LastName,FirstName)
JohnsonDavid
MartinKelly
TamburelloAndrea
select concat_ws(LastName,FirstName) as fullname from Demovarchar where Age > 40 order by fullname desc;
fullname
TamburelloAndrea
MartinKelly
JohnsonDavid
select concat_ws(LastName,FirstName),Gender,Age from Demovarchar where Gender='F' order by Age asc;
concat_ws(LastName,FirstName)	Gender	Age
PolandCarole	F	29
RapierAbigail	F	38
TamburelloAndrea	F	45
MartinKelly	F	54
select cast(Age as char) as cAge from Demovarchar where cast(Age as char) like '2_';
cAge
29
27
select cast(Age as char) and Age as cAge from Demovarchar where Age>=50 order by cAge desc;
cAge
1
1
CREATE TABLE employees (
employeeNumber int(11) NOT NULL,
lastName varchar(50) NOT NULL,
firstName varchar(50) NOT NULL,
extension varchar(10) NOT NULL,
email varchar(100) NOT NULL,
officeCode varchar(10) NOT NULL,
reportsTo int(11) DEFAULT NULL,
jobTitle varchar(50) NOT NULL,
PRIMARY KEY (employeeNumber)
);
insert  into employees(employeeNumber,lastName,firstName,extension,email,officeCode,reportsTo,jobTitle) values
(1002,'Murphy','Diane','x5800','dmurphy@classicmodelcars.com','1',NULL,'President'),
(1056,'Patterson','Mary','x4611','mpatterso@classicmodelcars.com','1',1002,'VP Sales'),
(1076,'Firrelli','Jeff','x9273','jfirrelli@classicmodelcars.com','1',1002,'VP Marketing'),
(1088,'Patterson','William','x4871','wpatterson@classicmodelcars.com','6',1056,'Sales Manager (APAC)'),
(1102,'Bondur','Gerard','x5408','gbondur@classicmodelcars.com','4',1056,'Sale Manager (EMEA)'),
(1143,'Bow','Anthony','x5428','abow@classicmodelcars.com','1',1056,'Sales Manager (NA)'),
(1165,'Jennings','Leslie','x3291','ljennings@classicmodelcars.com','1',1143,'Sales Rep'),
(1166,'Thompson','Leslie','x4065','lthompson@classicmodelcars.com','1',1143,'Sales Rep'),
(1188,'Firrelli','Julie','x2173','jfirrelli@classicmodelcars.com','2',1143,'Sales Rep'),
(1216,'Patterson','Steve','x4334','spatterson@classicmodelcars.com','2',1143,'Sales Rep'),
(1286,'Tseng','Foon Yue','x2248','ftseng@classicmodelcars.com','3',1143,'Sales Rep'),
(1323,'Vanauf','George','x4102','gvanauf@classicmodelcars.com','3',1143,'Sales Rep'),
(1337,'Bondur','Loui','x6493','lbondur@classicmodelcars.com','4',1102,'Sales Rep'),
(1370,'Hernandez','Gerard','x2028','ghernande@classicmodelcars.com','4',1102,'Sales Rep'),
(1401,'Castillo','Pamela','x2759','pcastillo@classicmodelcars.com','4',1102,'Sales Rep'),
(1501,'Bott','Larry','x2311','lbott@classicmodelcars.com','7',1102,'Sales Rep'),
(1504,'Jones','Barry','x102','bjones@classicmodelcars.com','7',1102,'Sales Rep'),
(1611,'Fixter','Andy','x101','afixter@classicmodelcars.com','6',1088,'Sales Rep');
select officeCode,count(officeCode) from employees group by officeCode having count(officeCode)>2;
officeCode	count(officeCode)
1	6
4	4
select lastName,firstName from employees where cast(officeCode as unsigned)>5 limit 2 offset 1;
lastName	firstName
Bott	Larry
Jones	Barry
select max(lastName),min(lastName) from employees;
max(lastName)	min(lastName)
Vanauf	Bondur
select max(lastName),min(lastName),JobTitle from employees group by JobTitle;
max(lastName)	min(lastName)	JobTitle
Murphy	Murphy	President
Patterson	Patterson	VP Sales
Firrelli	Firrelli	VP Marketing
Patterson	Patterson	Sales Manager (APAC)
Bondur	Bondur	Sale Manager (EMEA)
Bow	Bow	Sales Manager (NA)
Vanauf	Bondur	Sales Rep
select lastName,firstName from employees where lastName>=firstName;
lastName	firstName
Murphy	Diane
Patterson	Mary
Bow	Anthony
Thompson	Leslie
Tseng	Foon Yue
Vanauf	George
Hernandez	Gerard
Jones	Barry
Fixter	Andy
select lastName,firstName from employees where lastName between firstName and JobTitle;
lastName	firstName
Murphy	Diane
Patterson	Mary
Bow	Anthony
Hernandez	Gerard
Jones	Barry
Fixter	Andy
select * from employees where officeCode in ('2','3','4') order by 1 asc,3 desc limit 1,2;
employeeNumber	lastName	firstName	extension	email	officeCode	reportsTo	jobTitle
1188	Firrelli	Julie	x2173	jfirrelli@classicmodelcars.com	2	1143	Sales Rep
1216	Patterson	Steve	x4334	spatterson@classicmodelcars.com	2	1143	Sales Rep
select * from employees where officeCode not in ('5','7','1');
employeeNumber	lastName	firstName	extension	email	officeCode	reportsTo	jobTitle
1088	Patterson	William	x4871	wpatterson@classicmodelcars.com	6	1056	Sales Manager (APAC)
1102	Bondur	Gerard	x5408	gbondur@classicmodelcars.com	4	1056	Sale Manager (EMEA)
1188	Firrelli	Julie	x2173	jfirrelli@classicmodelcars.com	2	1143	Sales Rep
1216	Patterson	Steve	x4334	spatterson@classicmodelcars.com	2	1143	Sales Rep
1286	Tseng	Foon Yue	x2248	ftseng@classicmodelcars.com	3	1143	Sales Rep
1323	Vanauf	George	x4102	gvanauf@classicmodelcars.com	3	1143	Sales Rep
1337	Bondur	Loui	x6493	lbondur@classicmodelcars.com	4	1102	Sales Rep
1370	Hernandez	Gerard	x2028	ghernande@classicmodelcars.com	4	1102	Sales Rep
1401	Castillo	Pamela	x2759	pcastillo@classicmodelcars.com	4	1102	Sales Rep
1611	Fixter	Andy	x101	afixter@classicmodelcars.com	6	1088	Sales Rep
select avg(officeCode) from employees where jobTitle like 'Sales%' group by jobTitle;
avg(officeCode)
6
1
3.6666666666666665
select officeCode,sum(cast(officeCode as unsigned)) from employees group by officeCode;
officeCode	sum(cast(officeCode as unsigned))
1	6
6	12
4	16
2	4
3	6
7	14
select employeeNumber,officeCode,reportsTo from employees where employeeNumber>1400 and reportsTo is not null order by officeCode+1,employeeNumber;
employeeNumber	officeCode	reportsTo
1401	4	1102
1611	6	1088
1501	7	1102
1504	7	1102
create table job(
jobid int primary key,
jobTitle varchar(50)
);
insert into job values
(1,'President'),
(2,'VP Sales'),
(3,'VP Marketing'),
(4,'Sales Manager (APAC)'),
(5,'Sale Manager (EMEA)'),
(6,'Sales Manager (NA)'),
(7,'Sales Rep'),
(8,'Marketing');
select employeeNumber,e.jobTitle,j.jobid from employees e join job j on e.jobTitle=j.jobTitle;
employeeNumber	jobTitle	jobid
1002	President	1
1056	VP Sales	2
1076	VP Marketing	3
1088	Sales Manager (APAC)	4
1102	Sale Manager (EMEA)	5
1143	Sales Manager (NA)	6
1165	Sales Rep	7
1166	Sales Rep	7
1188	Sales Rep	7
1216	Sales Rep	7
1286	Sales Rep	7
1323	Sales Rep	7
1337	Sales Rep	7
1370	Sales Rep	7
1401	Sales Rep	7
1501	Sales Rep	7
1504	Sales Rep	7
1611	Sales Rep	7
select distinct e.jobTitle,j.jobid from employees e join job j on e.jobTitle=j.jobTitle;
jobTitle	jobid
President	1
VP Sales	2
VP Marketing	3
Sales Manager (APAC)	4
Sale Manager (EMEA)	5
Sales Manager (NA)	6
Sales Rep	7
select e.jobTitle,sum(jobid) from employees e join job j on e.jobTitle=j.jobTitle group by jobTitle having sum(jobid)>5;
jobTitle	sum(jobid)
Sales Manager (NA)	6
Sales Rep	84
select e.jobTitle,sum(jobid) from employees e join job j on e.jobTitle=j.jobTitle group by jobTitle having sum(jobid)>5 order by 2 desc;
jobTitle	sum(jobid)
Sales Rep	84
Sales Manager (NA)	6
drop table if exists t1;
drop table if exists t2;
drop table if exists t3;
drop table if exists t11;
drop table if exists t12;
CREATE TABLE t1 (a varchar(3), b int primary key);
INSERT INTO t1 VALUES ('1',1),('1',2);
update t1 set a=2 where a='1' limit 1;
select * from t1;
a	b
2	1
1	2
INSERT INTO t1 VALUES ('1',3);
update t1 set a='a' where a='1';
select * from t1;
a	b
2	1
a	2
a	3
drop table t1;
create table t1 (
a varchar(10) not null,
b varchar(10) not null default '0',
c varchar(10) not null default '0',
d varchar(10) not null default '0',
e varchar(10) not null default '0',
f varchar(10) not null default '0',
g varchar(10) not null default '0',
h varchar(10) not null default '0',
i varchar(10) not null default '0',
j varchar(10) not null default '0',
primary key (a));
insert into t1 (a) values ('2'),('4'),('6'),('8'),('10'),('12'),('14'),('16'),('18'),('20'),('22'),('24'),('26'),('23');
update t1 set a=a+'101';
select a,b from t1;
a	b
103	0
105	0
107	0
109	0
111	0
113	0
115	0
117	0
119	0
121	0
123	0
124	0
125	0
127	0
update t1 set a='127' where a='25';
select a,b from t1;
a	b
103	0
105	0
107	0
109	0
111	0
113	0
115	0
117	0
119	0
121	0
123	0
124	0
125	0
127	0
update t1 set a=a+'a' where 1 > 2;
select a,b from t1;
a	b
103	0
105	0
107	0
109	0
111	0
113	0
115	0
117	0
119	0
121	0
123	0
124	0
125	0
127	0
update t1 set a=a+a where 3 > 2;
select a,b from t1;
a	b
206	0
210	0
214	0
218	0
222	0
226	0
230	0
234	0
238	0
242	0
246	0
248	0
250	0
254	0
drop table t1;
create table t1 (a varchar(10) primary key, b varchar(32));
insert into t1 values ('abc','apple'), ('ab','apple');
select * from t1;
a	b
ab	apple
abc	apple
update t1, t1 as t2 set t1.a= COALESCE(t1.a,t2.b) where t1.b = t2.b;
select * from t1;
a	b
ab	apple
abc	apple
drop table t1;
create table t11 (a varchar(10) NOT NULL, b int, primary key (a));
create table t12 (a varchar(10) NOT NULL, b int, primary key (a));
create table t2 (a varchar(10) NOT NULL, b int, primary key (a));
insert into t11 values ('0', 10),('1', 11),('2', 12);
insert into t12 values ('33', 10),('0', 11),('2', 12);
insert into t2 values ('0', 21),('1', 12),('3', 23);
update t12 join t11 on t11.a = t12.a set t11.a=t12.a where t11.b <> (select b from t2 where t11.a = t2.a);
select * from t11;
a	b
0	10
1	11
2	12
select * from t12;
a	b
0	11
2	12
33	10
update t11,t12 set t11.a=t11.a+t11.b where t11.b <> (select b from t2 where t11.a = t2.a);
select * from t11;
a	b
10	10
12	11
2	12
drop table if exists t1;
drop table if exists t2;
CREATE TABLE t1(a varchar(10) PRIMARY KEY);
INSERT INTO t1 VALUES('10'),('20');
CREATE TABLE t2(b varchar(3));
INSERT INTO t2 VALUES('10'),('20');
update t1 JOIN t2 on t1.a=t2.b set t1.a='5' WHERE t1.a = '10';
select * from t1;
a
20
5
select * from t2;
b
10
20
drop table t1;
CREATE TABLE t1 ( a varchar(10) PRIMARY KEY );
INSERT INTO t1 VALUES ('0'),('1'),('2');
update t1 set a=a*10%3 WHERE t1.a > 0 ORDER BY t1.a LIMIT 1;
SELECT * FROM t1;
a
0
1
2
drop table if exists t1;
drop table if exists t2;
drop table if exists t3;
CREATE TABLE t1 (a varchar(10) not null,b varchar(10) not null, primary key (a));
CREATE TABLE t2 (a varchar(10) not null,b varchar(10) not null, primary key (a));
CREATE TABLE t3 (a varchar(10) not null,b varchar(10) not null, primary key (a));
insert into t1 values ('1','1'),('2','1'),('4','3');
insert into t2 values ('1','1'),('2','2'),('3','3');
insert into t3 values ('1','1'),('2','1'),('4','3');
update t1 join t2 on t1.a=t2.a join t3 on t1.b=t3.b set t1.a=((t3.a*5) DIV 5) where t1.a=t2.a AND t2.b=t3.a and t1.b=t3.b;
select * from t1;
a	b
1	1
2	1
4	3
drop table if exists t1;
drop table if exists t2;
CREATE TABLE t1 (
a varchar(3)
);
CREATE TABLE t2 (
a varchar(3)
);
insert into t1 values('1'),('2'),('3'),('4'),('5');
insert into t2 values('1'),('3'),('5'),('7'),('9');
update t1 join t2 alias on t1.a=alias.a set alias.a=t1.a*3 WHERE t1.a = alias.a;
drop table if exists t1;
drop table if exists t2;
create table t1 (id varchar(20),dd date,dt datetime);
insert into t1 values('subquery','2022-04-28','2022-04-28 22:40:11');
insert into t1 values('bye','2022-04-28','2022-04-28 22:40:11');
insert into t1 values('hi','2022-04-28','2022-04-28 22:40:11');
insert into t1 values('good morning','2022-04-28','2022-04-28 22:40:11');
insert into t1 values('byebye','2022-04-28','2022-04-28 22:40:11');
update t1 sub set sub.id=dd where id > 'bye';
select count(*) from t1 where id>4;
count(*)
4
drop table if exists t1;
drop table if exists t2;
create table t1 (id varchar(20),dd date,dt datetime);
insert into t1 values('subquery','2022-04-28','2022-04-28 22:40:11');
insert into t1 values('bye','2022-04-28','2022-04-28 22:40:11');
insert into t1 values('hi','2022-04-28','2022-04-28 22:40:11');
insert into t1 values('good morning','2022-04-28','2022-04-28 22:40:11');
insert into t1 values('byebye','2022-04-28','2022-04-28 22:40:11');
update t1 sub set sub.id=dt where id > 'bye' || id < 'hi' ;
select * from t1;
id	dd	dt
2022-04-28 22:40:11	2022-04-28	2022-04-28 22:40:11
2022-04-28 22:40:11	2022-04-28	2022-04-28 22:40:11
2022-04-28 22:40:11	2022-04-28	2022-04-28 22:40:11
2022-04-28 22:40:11	2022-04-28	2022-04-28 22:40:11
2022-04-28 22:40:11	2022-04-28	2022-04-28 22:40:11
drop table if exists t1;
drop table if exists t2;
drop table if exists t3;
drop table if exists t4;
create table t1 (a varchar(3));
create table t2 (a varchar(3), b int);
create table t3 (a varchar(3));
create table t4 (a varchar(10) not null, b int not null);
insert into t1 values ('2');
insert into t2 values ('1',7),('2',7);
insert into t4 values ('4',8),('3',8),('5',9);
insert into t3 values ('100'),('8');
update t3,t2,t1 set t1.a=0 and t2.a=t2.a+t3.a where t3.a in (select b from t4 where b > 7);
select * from t1;
a
0
select * from t2;
a	b
1	7
2	7
drop table if exists t1;
drop table if exists t2;
drop table if exists t3;
drop table if exists t11;
drop table if exists t12;
CREATE TABLE t1 (a varchar(3), b varchar(5) primary key);
INSERT INTO t1 VALUES ('1','1'),('1','2');
delete from t1 where a=1 limit 1;
select * from t1;
a	b
1	2
INSERT INTO t1 VALUES (1,3);
delete from t1 where a=1;
select * from t1;
a	b
drop table t1;
create table t1 (
a varchar(10) not null,
b varchar(10) not null default '0',
c varchar(10) not null default '0',
d varchar(10) not null default '0',
e varchar(10) not null default '0',
f varchar(10) not null default '0',
g varchar(10) not null default '0',
h varchar(10) not null default '0',
i varchar(10) not null default '0',
j varchar(10) not null default '0',
primary key (a));
insert into t1 (a) values ('2'),('4'),('6'),('8'),('10'),('12'),('14'),('16'),('18'),('20'),('22'),('24'),('26'),('23');
delete from t1 where a=2+2;
select a,b from t1;
a	b
10	0
12	0
14	0
16	0
18	0
2	0
20	0
22	0
23	0
24	0
26	0
6	0
8	0
delete from t1 where  a=24;
select a,b from t1;
a	b
10	0
12	0
14	0
16	0
18	0
2	0
20	0
22	0
23	0
26	0
6	0
8	0
delete from t1 where  3 < 2;
select a,b from t1;
a	b
10	0
12	0
14	0
16	0
18	0
2	0
20	0
22	0
23	0
26	0
6	0
8	0
delete from t1 where  1 < 2;
select a,b from t1;
a	b
drop table t1;
create table t1 (a varchar(10) primary key, b varchar(32));
insert into t1 values ('abc','apple'), ('ab','apple');
select * from t1;
a	b
ab	apple
abc	apple
delete t1 from t1,t1 as t2 where t1.b = t2.b and t1.a > t2.a;
select * from t1;
a	b
ab	apple
drop table t1;
create table t11 (a varchar(10) NOT NULL, b int, primary key (a));
create table t12 (a varchar(10) NOT NULL, b int, primary key (a));
create table t2 (a varchar(10) NOT NULL, b int, primary key (a));
insert into t11 values ('0', 10),('1', 11),('2', 12);
insert into t12 values ('33', 10),('0', 11),('2', 12);
insert into t2 values ('0', 21),('1', 12),('3', 23);
delete from t11 where t11.b <> (select b from t2 where t11.a = t2.a);
select * from t11;
a	b
2	12
delete t11,t12 from t11,t12 where t11.b <> (select b from t2 where t11.a = t2.a) or t12.a>1;
select * from t11;
a	b
select * from t12;
a	b
0	11
drop table if exists t1;
drop table if exists t2;
CREATE TABLE t1(a varchar(10) PRIMARY KEY);
INSERT INTO t1 VALUES('10'),('20');
CREATE TABLE t2(b varchar(3));
INSERT INTO t2 VALUES('10'),('20');
delete t1,t2 from t1 JOIN t2 on t1.a=t2.b WHERE t1.a = 10;
select * from t1;
a
20
select * from t2;
b
20
drop table if exists t1;
drop table if exists t2;
drop table if exists t3;
CREATE TABLE t1 (a varchar(10) not null,b varchar(10) not null, primary key (a));
CREATE TABLE t2 (a varchar(10) not null,b varchar(10) not null, primary key (a));
CREATE TABLE t3 (a varchar(10) not null,b varchar(10) not null, primary key (a));
insert into t1 values ('1','1'),('2','1'),('4','3');
insert into t2 values ('1','1'),('2','2'),('3','3');
insert into t3 values ('1','1'),('2','1'),('4','3');
delete t1,t2,t3 from t1 join t2 on t1.a=t2.a join t3 on t1.b=t3.b where t1.a=t2.a AND t2.b=t3.a and t1.b=t3.b;
select * from t1;
a	b
4	3
drop table t1;
create table t1(a varchar(10) not null);
insert into t1 values (0);
delete t1 from t1 where a is null;
select * from t1;
a
0
drop table if exists t1;
drop table if exists t2;
CREATE TABLE t1 (
a varchar(1)
);
CREATE TABLE t2 (
a varchar(1)
);
insert into t1 values('1'),('2'),('3'),('4'),('5');
insert into t2 values('1'),('3'),('5'),('7'),('9');
delete alias from t1 join t2 alias on t1.a=alias.a+1 WHERE t1.a = alias.a;
select * from t2;
a
1
3
5
7
9
drop table if exists t1;
drop table if exists t2;
create table t1 (id varchar(20),dd date,dt datetime);
insert into t1 values('subquery','2022-04-28','2022-04-28 22:40:11');
insert into t1 values('bye','2022-04-28','2022-04-28 22:40:11');
insert into t1 values('hi','2022-04-28','2022-04-28 22:40:11');
insert into t1 values('good morning','2022-04-28','2022-04-28 22:40:11');
insert into t1 values('byebye','2022-04-28','2022-04-28 22:40:11');
delete from t1 where length(id) < 3 || length(id) > 5;
select * from t1;
id	dd	dt
bye	2022-04-28	2022-04-28 22:40:11
[ACTUAL RESULT]:
lastname	firstname	gender	departmentname	age
Gilbert	Kevin	M	Tool Design	33
Tamburello	Andrea	F	Marketing	45
Johnson	David	M	Engineering	66
Sharma	Bradley	M	Production	27
Rapier	Abigail	F	Human Resources	38
Martin	Kelly	F	Information Services	54
Poland	Carole	F	Production Control	29

select concat(LastName,FirstName) from Demovarchar where Age > 40 order by 1 asc;

[EXPECT RESULT]:

[ACTUAL RESULT]:
unknown error:[42883]function 'concat' doesn't register, get id failed

select concat(LastName,FirstName) as fullname from Demovarchar where Age > 40 order by fullname desc;

[EXPECT RESULT]:

[ACTUAL RESULT]:
unknown error:[42883]function 'concat' doesn't register, get id failed

select concat(LastName,FirstName),Gender,Age from Demovarchar where Gender='F' order by Age asc;

[EXPECT RESULT]:

[ACTUAL RESULT]:
unknown error:[42883]function 'concat' doesn't register, get id failed

select cast(Age as char) as cAge from Demovarchar where cast(Age as char) like '2_';

[EXPECT RESULT]:

[ACTUAL RESULT]:
cage

select cast(Age as char) and Age as cAge from Demovarchar where Age>=50 order by cAge desc;

[EXPECT RESULT]:

[ACTUAL RESULT]:
unknown error:[42883]undefined function and[CHAR INT]

select officeCode,count(officeCode) from employees group by officeCode having count(officeCode)>2;

[EXPECT RESULT]:

[ACTUAL RESULT]:
officecode	count(officecode)
1	6
4	4

select lastName,firstName from employees where cast(officeCode as unsigned)>5 limit 2 offset 1;

[EXPECT RESULT]:

[ACTUAL RESULT]:
lastname	firstname
Bott	Larry
Jones	Barry

select max(lastName),min(lastName) from employees;

[EXPECT RESULT]:

[ACTUAL RESULT]:
max(lastname)	min(lastname)
Vanauf	Bondur

select max(lastName),min(lastName),JobTitle from employees group by JobTitle;

[EXPECT RESULT]:

[ACTUAL RESULT]:
max(lastname)	min(lastname)	jobtitle
Murphy	Murphy	President
Patterson	Patterson	VP Sales
Firrelli	Firrelli	VP Marketing
Patterson	Patterson	Sales Manager (APAC)
Bondur	Bondur	Sale Manager (EMEA)
Bow	Bow	Sales Manager (NA)
Vanauf	Bondur	Sales Rep

select lastName,firstName from employees where lastName>=firstName;

[EXPECT RESULT]:

[ACTUAL RESULT]:
lastname	firstname
Murphy	Diane
Patterson	Mary
Bow	Anthony
Thompson	Leslie
Tseng	Foon Yue
Vanauf	George
Hernandez	Gerard
Jones	Barry
Fixter	Andy

select lastName,firstName from employees where lastName between firstName and JobTitle;

[EXPECT RESULT]:

[ACTUAL RESULT]:
lastname	firstname
Murphy	Diane
Patterson	Mary
Bow	Anthony
Hernandez	Gerard
Jones	Barry
Fixter	Andy

select * from employees where officeCode in ('2','3','4') order by 1 asc,3 desc limit 1,2;

[EXPECT RESULT]:

[ACTUAL RESULT]:
unknown error:Internal error: panic runtime error: index out of range [6] with length 1: goroutine 506136 [running]:
runtime/debug.Stack()
	/usr/lib/golang/src/runtime/debug/stack.go:24 +0x65
github.com/matrixorigin/matrixone/pkg/common/moerr.NewPanicError({0x2d6da80?, 0xc13f0c26d8})
	/data/zhangxiao/matrixone/pkg/common/moerr/error.go:77 +0x53
github.com/matrixorigin/matrixone/pkg/vm/overload.Run.func1()
	/data/zhangxiao/matrixone/pkg/vm/overload/run.go:50 +0x31
panic({0x2d6da80, 0xc13f0c26d8})
	/usr/lib/golang/src/runtime/panic.go:838 +0x207
github.com/matrixorigin/matrixone/pkg/sort/asc/int64s.quickSort({0xc0a867aaf0?, 0x1, 0x1}, {0xc028966e40?, 0x8, 0x8}, 0x2c3f220?, 0x1?, 0xc02db8dbf0?)
	/data/zhangxiao/matrixone/pkg/sort/asc/int64s/sort.go:49 +0x2a7
github.com/matrixorigin/matrixone/pkg/sort/asc/int64s.Sort({0xc0a867aaf0?, 0x7f6778882878?, 0x40?}, {0xc028966e40?, 0xc028966e40?, 0x0?})
	/data/zhangxiao/matrixone/pkg/sort/asc/int64s/sort.go:14 +0x45
github.com/matrixorigin/matrixone/pkg/sort.Sort(0xe0?, {0xc028966e40?, 0xc0698ec1e0?, 0x8?}, 0x7?)
	/data/zhangxiao/matrixone/pkg/sort/sort.go:89 +0x2e8
github.com/matrixorigin/matrixone/pkg/sql/colexec2/order.(*Container).process(0xc4848ae4b0, 0xc274b107c0?, 0xc0698ec1e0, 0xc1612458c0)
	/data/zhangxiao/matrixone/pkg/sql/colexec2/order/order.go:98 +0x154
github.com/matrixorigin/matrixone/pkg/sql/colexec2/order.Call(0xc1612458c0?, {0x2aaf860?, 0xc134482260?})
	/data/zhangxiao/matrixone/pkg/sql/colexec2/order/order.go:62 +0x53
github.com/matrixorigin/matrixone/pkg/vm/overload.Run({0xc07e7770e0?, 0x4, 0x8?}, 0x8?)
	/data/zhangxiao/matrixone/pkg/vm/overload/run.go:55 +0xee
github.com/matrixorigin/matrixone/pkg/vm/pipeline2.(*Pipeline).Run(0xc02db8df20, {0x3210e40, 0xc2e241f730}, 0xc1612458c0)
	/data/zhangxiao/matrixone/pkg/vm/pipeline2/pipeline.go:75 +0x22d
github.com/matrixorigin/matrixone/pkg/sql/compile2.(*Scope).Run(0xc0d13e3ea0?, {0x322c400?, 0xc000010028?})
	/data/zhangxiao/matrixone/pkg/sql/compile2/scope.go:259 +0xc5
github.com/matrixorigin/matrixone/pkg/sql/compile2.(*Scope).MergeRun.func1(0xc061b11fb8?)
	/data/zhangxiao/matrixone/pkg/sql/compile2/scope.go:277 +0x79
created by github.com/matrixorigin/matrixone/pkg/sql/compile2.(*Scope).MergeRun
	/data/zhangxiao/matrixone/pkg/sql/compile2/scope.go:272 +0x1ad


select * from employees where officeCode not in ('5','7','1');

[EXPECT RESULT]:

[ACTUAL RESULT]:
employeenumber	lastname	firstname	extension	email	officecode	reportsto	jobtitle
1088	Patterson	William	x4871	wpatterson@classicmodelcars.com	6	1056	Sales Manager (APAC)
1102	Bondur	Gerard	x5408	gbondur@classicmodelcars.com	4	1056	Sale Manager (EMEA)
1188	Firrelli	Julie	x2173	jfirrelli@classicmodelcars.com	2	1143	Sales Rep
1216	Patterson	Steve	x4334	spatterson@classicmodelcars.com	2	1143	Sales Rep
1286	Tseng	Foon Yue	x2248	ftseng@classicmodelcars.com	3	1143	Sales Rep
1323	Vanauf	George	x4102	gvanauf@classicmodelcars.com	3	1143	Sales Rep
1337	Bondur	Loui	x6493	lbondur@classicmodelcars.com	4	1102	Sales Rep
1370	Hernandez	Gerard	x2028	ghernande@classicmodelcars.com	4	1102	Sales Rep
1401	Castillo	Pamela	x2759	pcastillo@classicmodelcars.com	4	1102	Sales Rep
1611	Fixter	Andy	x101	afixter@classicmodelcars.com	6	1088	Sales Rep

select avg(officeCode) from employees where jobTitle like 'Sales%' group by jobTitle;

[EXPECT RESULT]:

[ACTUAL RESULT]:
unknown error:[42883]undefined function avg[VARCHAR]

select officeCode,sum(cast(officeCode as unsigned)) from employees group by officeCode;

[EXPECT RESULT]:

[ACTUAL RESULT]:
officecode	sum(cast(officecode as unsigned unsigned))
1	6608
6	2699
4	5210
2	2404
3	2609
7	3005

select employeeNumber,officeCode,reportsTo from employees where employeeNumber>1400 and reportsTo is not null order by officeCode+1,employeeNumber;

[EXPECT RESULT]:

[ACTUAL RESULT]:
unknown error:[42883]function 'ifnull' doesn't register, get id failed

select employeeNumber,e.jobTitle,j.jobid from employees e join job j on e.jobTitle=j.jobTitle;

[EXPECT RESULT]:

[ACTUAL RESULT]:
employeenumber	e.jobtitle	j.jobid
1002	President	1
1056	VP Sales	2
1076	VP Marketing	3
1088	Sales Manager (APAC)	4
1102	Sale Manager (EMEA)	5
1143	Sales Manager (NA)	6
1165	Sales Rep	7
1166	Sales Rep	7
1188	Sales Rep	7
1216	Sales Rep	7
1286	Sales Rep	7
1323	Sales Rep	7
1337	Sales Rep	7
1370	Sales Rep	7
1401	Sales Rep	7
1501	Sales Rep	7
1504	Sales Rep	7
1611	Sales Rep	7

select distinct e.jobTitle,j.jobid from employees e join job j on e.jobTitle=j.jobTitle;

[EXPECT RESULT]:

[ACTUAL RESULT]:
unknown error:Internal error: panic runtime error: index out of range [7] with length 2: goroutine 505717 [running]:
runtime/debug.Stack()
	/usr/lib/golang/src/runtime/debug/stack.go:24 +0x65
github.com/matrixorigin/matrixone/pkg/common/moerr.NewPanicError({0x2d6da80?, 0xc232567bd8})
	/data/zhangxiao/matrixone/pkg/common/moerr/error.go:77 +0x53
github.com/matrixorigin/matrixone/pkg/vm/overload.Run.func1()
	/data/zhangxiao/matrixone/pkg/vm/overload/run.go:50 +0x31
panic({0x2d6da80, 0xc232567bd8})
	/usr/lib/golang/src/runtime/panic.go:838 +0x207
github.com/matrixorigin/matrixone/pkg/sql/colexec2.EvalExpr(0xc0033434a0, 0xc000d6fd70?, 0xf31845?)
	/data/zhangxiao/matrixone/pkg/sql/colexec2/expr_eval.go:80 +0xa50
github.com/matrixorigin/matrixone/pkg/sql/colexec2/projection.Call(0xc3fd9d8790, {0x2aaf9a0?, 0xc003d3c618})
	/data/zhangxiao/matrixone/pkg/sql/colexec2/projection/projection.go:52 +0x176
github.com/matrixorigin/matrixone/pkg/vm/overload.Run({0xc1fa622c00?, 0x3, 0x7f65fb3f7a00?}, 0x10?)
	/data/zhangxiao/matrixone/pkg/vm/overload/run.go:55 +0xee
github.com/matrixorigin/matrixone/pkg/vm/pipeline2.(*Pipeline).MergeRun(0xc000d6ff20, 0xc3fd9d8790)
	/data/zhangxiao/matrixone/pkg/vm/pipeline2/pipeline.go:130 +0x1af
github.com/matrixorigin/matrixone/pkg/sql/compile2.(*Scope).MergeRun(0xc4d1878780, {0x322c400?, 0xc000010028})
	/data/zhangxiao/matrixone/pkg/sql/compile2/scope.go:306 +0x574
github.com/matrixorigin/matrixone/pkg/sql/compile2.(*Scope).MergeRun.func2(0x13?)
	/data/zhangxiao/matrixone/pkg/sql/compile2/scope.go:285 +0x79
created by github.com/matrixorigin/matrixone/pkg/sql/compile2.(*Scope).MergeRun
	/data/zhangxiao/matrixone/pkg/sql/compile2/scope.go:280 +0x2b8


select e.jobTitle,sum(jobid) from employees e join job j on e.jobTitle=j.jobTitle group by jobTitle having sum(jobid)>5;

[EXPECT RESULT]:

[ACTUAL RESULT]:
unknown error:[42702]column reference 'jobtitle' is ambiguous

select e.jobTitle,sum(jobid) from employees e join job j on e.jobTitle=j.jobTitle group by jobTitle having sum(jobid)>5 order by 2 desc;

[EXPECT RESULT]:

[ACTUAL RESULT]:
unknown error:[42702]column reference 'jobtitle' is ambiguous

update t1 set a=2 where a='1' limit 1;

[EXPECT RESULT]:

[ACTUAL RESULT]:
unknown error:[42000]query 'node_type:UPDATE node_id:1 children:0 update_list:<columns:<typ:<id:VARCHAR width:3 > table_name:"t1" col_name:"a" col:<> > values:<typ:<id:VARCHAR width:3 > f:<func:<obj:94489280642 obj_name:"cast" > args:<typ:<id:INT64 size:8 > col_name:"2" c:<ival:2 > > args:<t:<typ:<id:VARCHAR width:3 > > > > > > table_def:<name:"t1" alias:"t1" cols:<name:"a" alias:"a" typ:<id:VARCHAR width:3 > > cols:<name:"b" alias:"b" typ:<id:INT32 width:32 > primary:true > cols:<name:"PADDR" alias:"PADDR" typ:<id:DECIMAL128 width:128 > > > obj_ref:<schema_name:"varchar" obj_name:"t1" > ' not support now

select * from t1;

[EXPECT RESULT]:

[ACTUAL RESULT]:
a	b
1	1
1	2

insert into t1 (a) values ('2'),('4'),('6'),('8'),('10'),('12'),('14'),('16'),('18'),('20'),('22'),('24'),('26'),('23');

[EXPECT RESULT]:

[ACTUAL RESULT]:
unknown error:[42611]Field 'b' doesn't have a default value

select * from t1;

[EXPECT RESULT]:

[ACTUAL RESULT]:
a	b
abc	apple
ab	apple

SELECT * FROM t1;

[EXPECT RESULT]:

[ACTUAL RESULT]:
a
0
1
2

select * from t1;

[EXPECT RESULT]:

[ACTUAL RESULT]:
a	b
1	1
2	1
4	3

insert into t1 (a) values ('2'),('4'),('6'),('8'),('10'),('12'),('14'),('16'),('18'),('20'),('22'),('24'),('26'),('23');

[EXPECT RESULT]:

[ACTUAL RESULT]:
unknown error:[42611]Field 'b' doesn't have a default value

]]></failure>
    </testcase>
</testsuite>
